
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>ceph · 工作笔记</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="wei liang">
        
        
    
    <link rel="stylesheet" href="../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-chapter-fold/chapter-fold.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-prism/prism-solarizedlight.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-emphasize/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-advanced-emoji/emoji-website.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-multipart/multipart.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-ancre-navigation/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-theme-comscore/test.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../raid/" />
    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../../">
            
                <a href="../../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    1.Linux基础
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" >
            
                <span>
            
                    
                    trouble shooting
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" >
            
                <span>
            
                    
                    cpu
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1.1" data-path="../../trouble shooting/cpu/cpu占用过高.html">
            
                <a href="../../trouble shooting/cpu/cpu占用过高.html">
            
                    
                    cpu占用过高
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../../包管理器/">
            
                <a href="../../包管理器/">
            
                    
                    包管理器
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="../../包管理器/apt/">
            
                <a href="../../包管理器/apt/">
            
                    
                    apt
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="../../包管理器/choco/">
            
                <a href="../../包管理器/choco/">
            
                    
                    choco
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.3" data-path="../../包管理器/gem/">
            
                <a href="../../包管理器/gem/">
            
                    
                    gem
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.4" data-path="../../包管理器/helm/">
            
                <a href="../../包管理器/helm/">
            
                    
                    helm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.5" data-path="../../包管理器/pip/">
            
                <a href="../../包管理器/pip/">
            
                    
                    pip
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.6" >
            
                <span>
            
                    
                    yum
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.6.1" data-path="../../包管理器/yum/A-配置本地源.html">
            
                <a href="../../包管理器/yum/A-配置本地源.html">
            
                    
                    A-配置本地源
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.6.2" data-path="../../包管理器/yum/B-阿里源.html">
            
                <a href="../../包管理器/yum/B-阿里源.html">
            
                    
                    B-阿里源
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.6.3" data-path="../../包管理器/yum/C-软件及依赖导出.html">
            
                <a href="../../包管理器/yum/C-软件及依赖导出.html">
            
                    
                    C-软件及依赖导出
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.6.4" data-path="../../包管理器/yum/D-构建rpm包.html">
            
                <a href="../../包管理器/yum/D-构建rpm包.html">
            
                    
                    D-构建rpm包
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" >
            
                <span>
            
                    
                    存储
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.2.3.1" data-path="./">
            
                <a href="./">
            
                    
                    ceph
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.2" data-path="../raid/">
            
                <a href="../raid/">
            
                    
                    raid
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.3" data-path="../fastdfs.html">
            
                <a href="../fastdfs.html">
            
                    
                    fastdfs
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../../安全/">
            
                <a href="../../安全/">
            
                    
                    安全
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../../常用shell/">
            
                <a href="../../常用shell/">
            
                    
                    常用shell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../../系统设置/">
            
                <a href="../../系统设置/">
            
                    
                    系统设置
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" >
            
                <span>
            
                    
                    网络
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.7.1" >
            
                <span>
            
                    
                    proxy
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.7.1.1" data-path="../../网络/proxy/windows.html">
            
                <a href="../../网络/proxy/windows.html">
            
                    
                    windows
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.7.2" data-path="../../网络/bridge.html">
            
                <a href="../../网络/bridge.html">
            
                    
                    bridge
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.3" data-path="../../网络/nat.html">
            
                <a href="../../网络/nat.html">
            
                    
                    nat
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.4" data-path="../../网络/route.html">
            
                <a href="../../网络/route.html">
            
                    
                    route
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.5" data-path="../../网络/wireshark.html">
            
                <a href="../../网络/wireshark.html">
            
                    
                    wireshark
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.8" >
            
                <span>
            
                    
                    虚拟化相关
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.8.1" data-path="../../虚拟化相关/iDRAC.html">
            
                <a href="../../虚拟化相关/iDRAC.html">
            
                    
                    iDRAC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.2" data-path="../../虚拟化相关/kvm.html">
            
                <a href="../../虚拟化相关/kvm.html">
            
                    
                    kvm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.3" data-path="../../虚拟化相关/migration.html">
            
                <a href="../../虚拟化相关/migration.html">
            
                    
                    migration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.4" data-path="../../虚拟化相关/openstack.html">
            
                <a href="../../虚拟化相关/openstack.html">
            
                    
                    openstack
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.5" data-path="../../虚拟化相关/Ovirt.html">
            
                <a href="../../虚拟化相关/Ovirt.html">
            
                    
                    Ovirt
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.6" data-path="../../虚拟化相关/vsphere.html">
            
                <a href="../../虚拟化相关/vsphere.html">
            
                    
                    vsphere
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="../../软件更新/">
            
                <a href="../../软件更新/">
            
                    
                    软件更新
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.9.1" data-path="../../软件更新/kernel/">
            
                <a href="../../软件更新/kernel/">
            
                    
                    kernel
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.10" data-path="../../驱动/">
            
                <a href="../../驱动/">
            
                    
                    驱动
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11" data-path="../../skill.html">
            
                <a href="../../skill.html">
            
                    
                    skill
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    2.容器
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" >
            
                <span>
            
                    
                    docker
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../../../2.容器/docker/cli/cli.html">
            
                <a href="../../../2.容器/docker/cli/cli.html">
            
                    
                    cli
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="../../../2.容器/docker/cmd/cmd.html">
            
                <a href="../../../2.容器/docker/cmd/cmd.html">
            
                    
                    cmd
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="../../../2.容器/docker/image/image.html">
            
                <a href="../../../2.容器/docker/image/image.html">
            
                    
                    image
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.4" data-path="../../../2.容器/docker/install/install.html">
            
                <a href="../../../2.容器/docker/install/install.html">
            
                    
                    install
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.5" data-path="../../../2.容器/docker/network/network.html">
            
                <a href="../../../2.容器/docker/network/network.html">
            
                    
                    network
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.6" data-path="../../../2.容器/docker/security/security.html">
            
                <a href="../../../2.容器/docker/security/security.html">
            
                    
                    security
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.7" data-path="../../../2.容器/docker/storage/storage.html">
            
                <a href="../../../2.容器/docker/storage/storage.html">
            
                    
                    storage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.8" data-path="../../../2.容器/docker/thin/thin.html">
            
                <a href="../../../2.容器/docker/thin/thin.html">
            
                    
                    thin
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" >
            
                <span>
            
                    
                    k8s
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../../../2.容器/k8s/addons/addons.html">
            
                <a href="../../../2.容器/k8s/addons/addons.html">
            
                    
                    addons
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" >
            
                <span>
            
                    
                    application
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.2.1" data-path="../../../2.容器/k8s/application/helm.html">
            
                <a href="../../../2.容器/k8s/application/helm.html">
            
                    
                    helm
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" >
            
                <span>
            
                    
                    base
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.3.1" data-path="../../../2.容器/k8s/base/intro.html">
            
                <a href="../../../2.容器/k8s/base/intro.html">
            
                    
                    intro
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.4" data-path="../../../2.容器/k8s/changelog/changelog.html">
            
                <a href="../../../2.容器/k8s/changelog/changelog.html">
            
                    
                    changelog
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.5" data-path="../../../2.容器/k8s/cmd/cmd.html">
            
                <a href="../../../2.容器/k8s/cmd/cmd.html">
            
                    
                    cmd
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.6" data-path="../../../2.容器/k8s/faq/faq.html">
            
                <a href="../../../2.容器/k8s/faq/faq.html">
            
                    
                    faq
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.7" data-path="../../../2.容器/k8s/ingress/ingress.html">
            
                <a href="../../../2.容器/k8s/ingress/ingress.html">
            
                    
                    ingress
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.8" data-path="../../../2.容器/k8s/install/">
            
                <a href="../../../2.容器/k8s/install/">
            
                    
                    install
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.8.1" data-path="../../../2.容器/k8s/install/binary.html">
            
                <a href="../../../2.容器/k8s/install/binary.html">
            
                    
                    binary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.8.2" data-path="../../../2.容器/k8s/install/k8s-kubeadm.html">
            
                <a href="../../../2.容器/k8s/install/k8s-kubeadm.html">
            
                    
                    k8s-kubeadm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.8.3" data-path="../../../2.容器/k8s/install/k8s-rke.html">
            
                <a href="../../../2.容器/k8s/install/k8s-rke.html">
            
                    
                    k8s-rke
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.8.4" data-path="../../../2.容器/k8s/install/kubeadm-offline.html">
            
                <a href="../../../2.容器/k8s/install/kubeadm-offline.html">
            
                    
                    kubeadm-offline
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.9" data-path="../../../2.容器/k8s/issue/issue.html">
            
                <a href="../../../2.容器/k8s/issue/issue.html">
            
                    
                    issue
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.10" data-path="../../../2.容器/k8s/monitor/">
            
                <a href="../../../2.容器/k8s/monitor/">
            
                    
                    monitor
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.10.1" data-path="../../../2.容器/k8s/monitor/weavescope.html">
            
                <a href="../../../2.容器/k8s/monitor/weavescope.html">
            
                    
                    weavescope
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.11" data-path="../../../2.容器/k8s/network/">
            
                <a href="../../../2.容器/k8s/network/">
            
                    
                    network
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.11.1" data-path="../../../2.容器/k8s/network/calico.html">
            
                <a href="../../../2.容器/k8s/network/calico.html">
            
                    
                    calico
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.11.2" data-path="../../../2.容器/k8s/network/dns.html">
            
                <a href="../../../2.容器/k8s/network/dns.html">
            
                    
                    dns
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.12" data-path="../../../2.容器/k8s/quota/quota.html">
            
                <a href="../../../2.容器/k8s/quota/quota.html">
            
                    
                    quota
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.13" data-path="../../../2.容器/k8s/security/security.html">
            
                <a href="../../../2.容器/k8s/security/security.html">
            
                    
                    security
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.14" data-path="../../../2.容器/k8s/sidecar/sidecar.html">
            
                <a href="../../../2.容器/k8s/sidecar/sidecar.html">
            
                    
                    sidecar
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.15" data-path="../../../2.容器/k8s/storage/">
            
                <a href="../../../2.容器/k8s/storage/">
            
                    
                    storage
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.15.1" data-path="../../../2.容器/k8s/storage/OpenEBS.html">
            
                <a href="../../../2.容器/k8s/storage/OpenEBS.html">
            
                    
                    OpenEBS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.15.2" data-path="../../../2.容器/k8s/storage/rook.html">
            
                <a href="../../../2.容器/k8s/storage/rook.html">
            
                    
                    rook
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.15.3" data-path="../../../2.容器/k8s/storage/Velero.html">
            
                <a href="../../../2.容器/k8s/storage/Velero.html">
            
                    
                    Velero
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.16" >
            
                <span>
            
                    
                    workload
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.16.1" data-path="../../../2.容器/k8s/workload/endpoint.html">
            
                <a href="../../../2.容器/k8s/workload/endpoint.html">
            
                    
                    endpoint
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.16.2" data-path="../../../2.容器/k8s/workload/job.html">
            
                <a href="../../../2.容器/k8s/workload/job.html">
            
                    
                    job
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.16.3" data-path="../../../2.容器/k8s/workload/pod.html">
            
                <a href="../../../2.容器/k8s/workload/pod.html">
            
                    
                    pod
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../../../2.容器/kubesphere/">
            
                <a href="../../../2.容器/kubesphere/">
            
                    
                    kubesphere
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" >
            
                <span>
            
                    
                    容器原理
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="../../../2.容器/容器原理/cgroup.html">
            
                <a href="../../../2.容器/容器原理/cgroup.html">
            
                    
                    cgroup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.2" data-path="../../../2.容器/容器原理/foundation.html">
            
                <a href="../../../2.容器/容器原理/foundation.html">
            
                    
                    foundation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.3" data-path="../../../2.容器/容器原理/ns-ipc.html">
            
                <a href="../../../2.容器/容器原理/ns-ipc.html">
            
                    
                    ns-ipc
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.4" data-path="../../../2.容器/容器原理/ns-mnt.html">
            
                <a href="../../../2.容器/容器原理/ns-mnt.html">
            
                    
                    ns-mnt
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.5" data-path="../../../2.容器/容器原理/ns-net.html">
            
                <a href="../../../2.容器/容器原理/ns-net.html">
            
                    
                    ns-net
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.6" data-path="../../../2.容器/容器原理/ns-user.html">
            
                <a href="../../../2.容器/容器原理/ns-user.html">
            
                    
                    ns-user
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.7" data-path="../../../2.容器/容器原理/ns-uts.html">
            
                <a href="../../../2.容器/容器原理/ns-uts.html">
            
                    
                    ns-uts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.8" data-path="../../../2.容器/容器原理/ns.html">
            
                <a href="../../../2.容器/容器原理/ns.html">
            
                    
                    ns
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.5" >
            
                <span>
            
                    
                    镜像构建
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.5.1" data-path="../../../2.容器/镜像构建/buildah.html">
            
                <a href="../../../2.容器/镜像构建/buildah.html">
            
                    
                    buildah
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5.2" data-path="../../../2.容器/镜像构建/podman.html">
            
                <a href="../../../2.容器/镜像构建/podman.html">
            
                    
                    podman
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5.3" data-path="../../../2.容器/镜像构建/skopeo.html">
            
                <a href="../../../2.容器/镜像构建/skopeo.html">
            
                    
                    skopeo
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../../3.集成部署/">
            
                <a href="../../../3.集成部署/">
            
                    
                    3.集成部署
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../../../3.集成部署/ftp/">
            
                <a href="../../../3.集成部署/ftp/">
            
                    
                    ftp
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../../../3.集成部署/git/">
            
                <a href="../../../3.集成部署/git/">
            
                    
                    git
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../../../3.集成部署/hadoop/">
            
                <a href="../../../3.集成部署/hadoop/">
            
                    
                    hadoop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../../../3.集成部署/mysql/">
            
                <a href="../../../3.集成部署/mysql/">
            
                    
                    mysql
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../../../3.集成部署/nginx/">
            
                <a href="../../../3.集成部署/nginx/">
            
                    
                    nginx
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../../../3.集成部署/nodejs/">
            
                <a href="../../../3.集成部署/nodejs/">
            
                    
                    nodejs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../../../3.集成部署/ntp/">
            
                <a href="../../../3.集成部署/ntp/">
            
                    
                    ntp
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="../../../3.集成部署/openjdk/">
            
                <a href="../../../3.集成部署/openjdk/">
            
                    
                    openjdk
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="../../../3.集成部署/oracle/">
            
                <a href="../../../3.集成部署/oracle/">
            
                    
                    oracle
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.10" data-path="../../../3.集成部署/pdns/">
            
                <a href="../../../3.集成部署/pdns/">
            
                    
                    pdns
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.11" data-path="../../../3.集成部署/poweradmin/">
            
                <a href="../../../3.集成部署/poweradmin/">
            
                    
                    poweradmin
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.12" data-path="../../../3.集成部署/python/">
            
                <a href="../../../3.集成部署/python/">
            
                    
                    python
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.13" data-path="../../../3.集成部署/tomcat/">
            
                <a href="../../../3.集成部署/tomcat/">
            
                    
                    tomcat
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.14" data-path="../../../3.集成部署/trafodion/">
            
                <a href="../../../3.集成部署/trafodion/">
            
                    
                    trafodion
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    4.持续集成&交付
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../../../4.持续集成&交付/argo/">
            
                <a href="../../../4.持续集成&交付/argo/">
            
                    
                    argo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../../../4.持续集成&交付/jenkins/">
            
                <a href="../../../4.持续集成&交付/jenkins/">
            
                    
                    jenkins
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    5.cncf
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../../../5.cncf/cncf.html">
            
                <a href="../../../5.cncf/cncf.html">
            
                    
                    cncf
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../../../5.cncf/kubevirt.html">
            
                <a href="../../../5.cncf/kubevirt.html">
            
                    
                    kubevirt
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                    6.编程
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../../../6.编程/golang/">
            
                <a href="../../../6.编程/golang/">
            
                    
                    golang
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../../../6.编程/letcode/letcode.html">
            
                <a href="../../../6.编程/letcode/letcode.html">
            
                    
                    letcode
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../../../7.FAQ/">
            
                <a href="../../../7.FAQ/">
            
                    
                    7.FAQ
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../../../7.FAQ/sre.html">
            
                <a href="../../../7.FAQ/sre.html">
            
                    
                    sre
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../../../vocabulary.html">
            
                <a href="../../../vocabulary.html">
            
                    
                    vocabulary
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../.." >ceph</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-anchor"></i><ul><li><span class="title-icon "></span><a href="#&#x5BFC;&#x8BFB;"><b></b>&#x5BFC;&#x8BFB;</a></li><ul><li><span class="title-icon "></span><a href="#&#x8BF4;&#x660E;"><b></b>&#x8BF4;&#x660E;</a></li><li><span class="title-icon "></span><a href="#&#x7D22;&#x5F15;"><b></b>&#x7D22;&#x5F15;</a></li></ul><li><span class="title-icon "></span><a href="#ceph&#x89E3;&#x6790;"><b></b>Ceph&#x89E3;&#x6790;</a></li><ul><li><span class="title-icon "></span><a href="#ceph&#x672F;&#x8BED;"><b></b>Ceph&#x672F;&#x8BED;</a></li><li><span class="title-icon "></span><a href="#ceph&#x5B58;&#x50A8;&#x96C6;&#x7FA4;"><b></b>Ceph&#x5B58;&#x50A8;&#x96C6;&#x7FA4;</a></li><ul><li><span class="title-icon "></span><a href="#ceph&#x6570;&#x636E;&#x5B58;&#x50A8;&#x6D41;&#x7A0B;"><b></b>Ceph&#x6570;&#x636E;&#x5B58;&#x50A8;&#x6D41;&#x7A0B;</a></li><li><span class="title-icon "></span><a href="#ceph&#x7684;&#x53EF;&#x4F38;&#x7F29;&#x6027;&#x548C;&#x9AD8;&#x53EF;&#x7528;&#x6027;"><b></b>Ceph&#x7684;&#x53EF;&#x4F38;&#x7F29;&#x6027;&#x548C;&#x9AD8;&#x53EF;&#x7528;&#x6027;</a></li></ul><li><span class="title-icon "></span><a href="#crush&#x7B97;&#x6CD5;&#x4ECB;&#x7ECD;"><b></b>CRUSH&#x7B97;&#x6CD5;&#x4ECB;&#x7ECD;</a></li><ul><li><span class="title-icon "></span><a href="#mon&#x9AD8;&#x53EF;&#x7528;"><b></b>mon&#x9AD8;&#x53EF;&#x7528;</a></li></ul><li><span class="title-icon "></span><a href="#&#x8EAB;&#x4EFD;&#x8BA4;&#x8BC1;&#x9AD8;&#x53EF;&#x7528;&#x6027;"><b></b>&#x8EAB;&#x4EFD;&#x8BA4;&#x8BC1;&#x9AD8;&#x53EF;&#x7528;&#x6027;</a></li><li><span class="title-icon "></span><a href="#&#x52A8;&#x6001;&#x96C6;&#x7FA4;&#x7BA1;&#x7406;"><b></b>&#x52A8;&#x6001;&#x96C6;&#x7FA4;&#x7BA1;&#x7406;</a></li><li><span class="title-icon "></span><a href="#&#x5206;&#x7EA7;&#x7F13;&#x5B58;"><b></b>&#x5206;&#x7EA7;&#x7F13;&#x5B58;</a></li><li><span class="title-icon "></span><a href="#ceph&#x534F;&#x8BAE;"><b></b>Ceph&#x534F;&#x8BAE;</a></li><ul><li><span class="title-icon "></span><a href="#ceph&#x534F;&#x8BAE;&#x4E0E;librados"><b></b>Ceph&#x534F;&#x8BAE;&#x4E0E;librados</a></li><li><span class="title-icon "></span><a href="#&#x5BF9;&#x8C61;&#x89C2;&#x6D4B;&#x901A;&#x77E5;"><b></b>&#x5BF9;&#x8C61;&#x89C2;&#x6D4B;&#x901A;&#x77E5;</a></li></ul><li><span class="title-icon "></span><a href="#&#x6570;&#x636E;&#x5206;&#x6BB5;"><b></b>&#x6570;&#x636E;&#x5206;&#x6BB5;</a></li></ul><li><span class="title-icon "></span><a href="#ceph&#x5B58;&#x50A8;&#x7C7B;&#x578B;"><b></b>Ceph&#x5B58;&#x50A8;&#x7C7B;&#x578B;</a></li><ul><li><span class="title-icon "></span><a href="#ceph&#x5757;&#x5B58;&#x50A8;"><b></b>Ceph&#x5757;&#x5B58;&#x50A8;</a></li><li><span class="title-icon "></span><a href="#ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;"><b></b>Ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</a></li><ul><li><span class="title-icon "></span><a href="#&#x90E8;&#x7F72;&#x5143;&#x6570;&#x636E;&#x670D;&#x52A1;&#x5668;"><b></b>&#x90E8;&#x7F72;&#x5143;&#x6570;&#x636E;&#x670D;&#x52A1;&#x5668;</a></li></ul><li><span class="title-icon "></span><a href="#ceph-&#x5BF9;&#x8C61;&#x5B58;&#x50A8;"><b></b>Ceph &#x5BF9;&#x8C61;&#x5B58;&#x50A8;</a></li><li><span class="title-icon "></span><a href="#&#x7ADE;&#x54C1;&#x5BF9;&#x6BD4;"><b></b>&#x7ADE;&#x54C1;&#x5BF9;&#x6BD4;</a></li><ul><li><span class="title-icon "></span><a href="#&#x5BF9;&#x6BD4;raid"><b></b>&#x5BF9;&#x6BD4;raid</a></li><li><span class="title-icon "></span><a href="#&#x5BF9;&#x6BD4;san&#x3001;nas&#x3001;das"><b></b>&#x5BF9;&#x6BD4;SAN&#x3001;NAS&#x3001;DAS</a></li><li><span class="title-icon "></span><a href="#&#x5BF9;&#x6BD4;&#x5176;&#x4ED6;&#x5206;&#x5E03;&#x5F0F;&#x5B58;&#x50A8;"><b></b>&#x5BF9;&#x6BD4;&#x5176;&#x4ED6;&#x5206;&#x5E03;&#x5F0F;&#x5B58;&#x50A8;</a></li></ul></ul><li><span class="title-icon "></span><a href="#&#x96C6;&#x6210;&#x90E8;&#x7F72;"><b></b>&#x96C6;&#x6210;&#x90E8;&#x7F72;</a></li><ul><li><span class="title-icon "></span><a href="#&#x786C;&#x4EF6;&#x9700;&#x6C42;"><b></b>&#x786C;&#x4EF6;&#x9700;&#x6C42;</a></li><ul><li><span class="title-icon "></span><a href="#cpu"><b></b>CPU</a></li><li><span class="title-icon "></span><a href="#&#x5185;&#x5B58;"><b></b>&#x5185;&#x5B58;</a></li><li><span class="title-icon "></span><a href="#&#x5B58;&#x50A8;"><b></b>&#x5B58;&#x50A8;</a></li><li><span class="title-icon "></span><a href="#&#x7F51;&#x7EDC;"><b></b>&#x7F51;&#x7EDC;</a></li><li><span class="title-icon "></span><a href="#&#x6545;&#x969C;&#x57DF;"><b></b>&#x6545;&#x969C;&#x57DF;</a></li><li><span class="title-icon "></span><a href="#&#x786C;&#x4EF6;&#x914D;&#x7F6E;&#x5EFA;&#x8BAE;"><b></b>&#x786C;&#x4EF6;&#x914D;&#x7F6E;&#x5EFA;&#x8BAE;</a></li></ul><li><span class="title-icon "></span><a href="#&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5EFA;&#x8BAE;"><b></b>&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5EFA;&#x8BAE;</a></li><ul><li><span class="title-icon "></span><a href="#&#x5185;&#x6838;"><b></b>&#x5185;&#x6838;</a></li><li><span class="title-icon "></span><a href="#&#x5E73;&#x53F0;"><b></b>&#x5E73;&#x53F0;</a></li></ul><li><span class="title-icon "></span><a href="#&#x73AF;&#x5883;&#x8BF4;&#x660E;"><b></b>&#x73AF;&#x5883;&#x8BF4;&#x660E;</a></li><li><span class="title-icon "></span><a href="#&#x73AF;&#x5883;&#x521D;&#x59CB;&#x5316;"><b></b>&#x73AF;&#x5883;&#x521D;&#x59CB;&#x5316;</a></li><ul><li><span class="title-icon "></span><a href="#&#x914D;&#x7F6E;yum"><b></b>&#x914D;&#x7F6E;yum</a></li><li><span class="title-icon "></span><a href="#yum&#x4F9D;&#x8D56;&#x5BFC;&#x51FA;"><b></b>yum&#x4F9D;&#x8D56;&#x5BFC;&#x51FA;</a></li><li><span class="title-icon "></span><a href="#&#x914D;&#x7F6E;&#x65F6;&#x949F;&#x540C;&#x6B65;"><b></b>&#x914D;&#x7F6E;&#x65F6;&#x949F;&#x540C;&#x6B65;</a></li><li><span class="title-icon "></span><a href="#&#x5347;&#x7EA7;&#x5185;&#x6838;"><b></b>&#x5347;&#x7EA7;&#x5185;&#x6838;</a></li><li><span class="title-icon "></span><a href="#raid&#x5361;"><b></b>raid&#x5361;</a></li></ul><li><span class="title-icon "></span><a href="#&#x5B89;&#x88C5;ceph"><b></b>&#x5B89;&#x88C5;ceph</a></li><li><span class="title-icon "></span><a href="#&#x914D;&#x7F6E;ceph"><b></b>&#x914D;&#x7F6E;ceph</a></li><ul><li><span class="title-icon "></span><a href="#&#x6DFB;&#x52A0;osd"><b></b>&#x6DFB;&#x52A0;OSD</a></li><li><span class="title-icon "></span><a href="#crush-class"><b></b>crush class</a></li><li><span class="title-icon "></span><a href="#crush-pool"><b></b>crush pool</a></li><li><span class="title-icon "></span><a href="#&#x5B89;&#x88C5;dashboard"><b></b>&#x5B89;&#x88C5;dashboard</a></li></ul></ul><li><span class="title-icon "></span><a href="#ceph&#x5B58;&#x50A8;&#x5B9E;&#x8DF5;"><b></b>ceph&#x5B58;&#x50A8;&#x5B9E;&#x8DF5;</a></li><ul><li><span class="title-icon "></span><a href="#&#x5757;&#x8BBE;&#x5907;&#x4F7F;&#x7528;"><b></b>&#x5757;&#x8BBE;&#x5907;&#x4F7F;&#x7528;</a></li><ul><li><span class="title-icon "></span><a href="#ceph&#x7BA1;&#x7406;&#x8282;&#x70B9;"><b></b>ceph&#x7BA1;&#x7406;&#x8282;&#x70B9;</a></li><li><span class="title-icon "></span><a href="#&#x5BA2;&#x6237;&#x7AEF;"><b></b>&#x5BA2;&#x6237;&#x7AEF;</a></li><li><span class="title-icon "></span><a href="#&#x9002;&#x7528;&#x573A;&#x666F;"><b></b>&#x9002;&#x7528;&#x573A;&#x666F;</a></li></ul><li><span class="title-icon "></span><a href="#ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4F7F;&#x7528;"><b></b>ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4F7F;&#x7528;</a></li><ul><li><span class="title-icon "></span><a href="#&#x670D;&#x52A1;&#x7AEF;"><b></b>&#x670D;&#x52A1;&#x7AEF;</a></li><li><span class="title-icon "></span><a href="#&#x5BA2;&#x6237;&#x7AEF;_1"><b></b>&#x5BA2;&#x6237;&#x7AEF;</a></li><li><span class="title-icon "></span><a href="#&#x9002;&#x7528;&#x573A;&#x666F;_1"><b></b>&#x9002;&#x7528;&#x573A;&#x666F;</a></li></ul></ul><li><span class="title-icon "></span><a href="#k8s&#x5BF9;&#x63A5;ceph"><b></b>k8s&#x5BF9;&#x63A5;ceph</a></li><ul><li><span class="title-icon "></span><a href="#k8s-csi"><b></b>k8s-csi</a></li><ul><li><span class="title-icon "></span><a href="#csi&#x7B80;&#x4ECB;"><b></b>csi&#x7B80;&#x4ECB;</a></li><li><span class="title-icon "></span><a href="#csi&#x8BBE;&#x8BA1;&#x80CC;&#x666F;"><b></b>csi&#x8BBE;&#x8BA1;&#x80CC;&#x666F;</a></li><li><span class="title-icon "></span><a href="#csi&#x67B6;&#x6784;"><b></b>csi&#x67B6;&#x6784;</a></li></ul><li><span class="title-icon "></span><a href="#k8s&#x63A5;&#x5165;ceph&#x5757;&#x5B58;&#x50A8;"><b></b>k8s&#x63A5;&#x5165;ceph&#x5757;&#x5B58;&#x50A8;</a></li><ul><li><span class="title-icon "></span><a href="#ceph&#x670D;&#x52A1;&#x7AEF;"><b></b>ceph&#x670D;&#x52A1;&#x7AEF;</a></li><li><span class="title-icon "></span><a href="#k8s&#x8282;&#x70B9;"><b></b>k8s&#x8282;&#x70B9;</a></li></ul><li><span class="title-icon "></span><a href="#k8s&#x63A5;&#x5165;ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;"><b></b>k8s&#x63A5;&#x5165;ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</a></li><ul><li><span class="title-icon "></span><a href="#ceph&#x670D;&#x52A1;&#x7AEF;_1"><b></b>ceph&#x670D;&#x52A1;&#x7AEF;</a></li><li><span class="title-icon "></span><a href="#k8s&#x8282;&#x70B9;_1"><b></b>k8s&#x8282;&#x70B9;</a></li></ul></ul><li><span class="title-icon "></span><a href="#ceph&#x8FD0;&#x7EF4;&#x7BA1;&#x7406;"><b></b>ceph&#x8FD0;&#x7EF4;&#x7BA1;&#x7406;</a></li><ul><li><span class="title-icon "></span><a href="#&#x670D;&#x52A1;&#x542F;&#x505C;"><b></b>&#x670D;&#x52A1;&#x542F;&#x505C;</a></li><ul><li><span class="title-icon "></span><a href="#&#x6309;&#x8282;&#x70B9;&#x542F;&#x52A8;&#x6240;&#x6709;ceph&#x670D;&#x52A1;"><b></b>&#x6309;&#x8282;&#x70B9;&#x542F;&#x52A8;&#x6240;&#x6709;ceph&#x670D;&#x52A1;</a></li><li><span class="title-icon "></span><a href="#&#x6309;&#x8282;&#x70B9;&#x505C;&#x6B62;&#x6240;&#x6709;ceph&#x670D;&#x52A1;"><b></b>&#x6309;&#x8282;&#x70B9;&#x505C;&#x6B62;&#x6240;&#x6709;ceph&#x670D;&#x52A1;</a></li><li><span class="title-icon "></span><a href="#&#x63A7;&#x5236;&#x8282;&#x70B9;&#x7BA1;&#x7406;&#x96C6;&#x7FA4;&#x6240;&#x6709;&#x670D;&#x52A1;"><b></b>&#x63A7;&#x5236;&#x8282;&#x70B9;&#x7BA1;&#x7406;&#x96C6;&#x7FA4;&#x6240;&#x6709;&#x670D;&#x52A1;</a></li></ul><li><span class="title-icon "></span><a href="#pool&#x7BA1;&#x7406;"><b></b>pool&#x7BA1;&#x7406;</a></li><ul><li><span class="title-icon "></span><a href="#&#x67E5;&#x770B;pool"><b></b>&#x67E5;&#x770B;pool</a></li><li><span class="title-icon "></span><a href="#&#x521B;&#x5EFA;&#x4E00;&#x4E2A;pool"><b></b>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;pool</a></li><li><span class="title-icon "></span><a href="#&#x8BBE;&#x7F6E;&#x6C60;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x6570;"><b></b>&#x8BBE;&#x7F6E;&#x6C60;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x6570;</a></li><li><span class="title-icon "></span><a href="#&#x83B7;&#x53D6;&#x6C60;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x6570;"><b></b>&#x83B7;&#x53D6;&#x6C60;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x6570;</a></li><li><span class="title-icon "></span><a href="#&#x83B7;&#x53D6;&#x96C6;&#x7FA4;&#x7684;pg&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;"><b></b>&#x83B7;&#x53D6;&#x96C6;&#x7FA4;&#x7684;PG&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;</a></li><li><span class="title-icon "></span><a href="#&#x5C06;&#x6C60;&#x4E0E;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5173;&#x8054;"><b></b>&#x5C06;&#x6C60;&#x4E0E;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5173;&#x8054;</a></li><li><span class="title-icon "></span><a href="#&#x6C60;&#x914D;&#x989D;"><b></b>&#x6C60;&#x914D;&#x989D;</a></li><li><span class="title-icon "></span><a href="#&#x5220;&#x9664;&#x6C60;"><b></b>&#x5220;&#x9664;&#x6C60;</a></li><li><span class="title-icon "></span><a href="#&#x6C60;&#x91CD;&#x547D;&#x540D;"><b></b>&#x6C60;&#x91CD;&#x547D;&#x540D;</a></li><li><span class="title-icon "></span><a href="#&#x663E;&#x793A;&#x6C60;&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;"><b></b>&#x663E;&#x793A;&#x6C60;&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;</a></li><li><span class="title-icon "></span><a href="#&#x521B;&#x5EFA;&#x6C60;&#x5FEB;&#x7167;"><b></b>&#x521B;&#x5EFA;&#x6C60;&#x5FEB;&#x7167;</a></li><li><span class="title-icon "></span><a href="#&#x5220;&#x9664;&#x6C60;&#x5FEB;&#x7167;"><b></b>&#x5220;&#x9664;&#x6C60;&#x5FEB;&#x7167;</a></li><li><span class="title-icon "></span><a href="#&#x6C60;&#x5176;&#x4ED6;&#x914D;&#x7F6E;"><b></b>&#x6C60;&#x5176;&#x4ED6;&#x914D;&#x7F6E;</a></li><li><span class="title-icon "></span><a href="#&#x8BBE;&#x7F6E;&#x5BF9;&#x8C61;&#x526F;&#x672C;&#x6570;"><b></b>&#x8BBE;&#x7F6E;&#x5BF9;&#x8C61;&#x526F;&#x672C;&#x6570;</a></li><li><span class="title-icon "></span><a href="#pgautoscalemode"><b></b>pg_autoscale_mode</a></li><li><span class="title-icon "></span><a href="#&#x6307;&#x5B9A;&#x6C60;&#x7684;&#x671F;&#x671B;&#x5927;&#x5C0F;"><b></b>&#x6307;&#x5B9A;&#x6C60;&#x7684;&#x671F;&#x671B;&#x5927;&#x5C0F;</a></li><li><span class="title-icon "></span><a href="#&#x653E;&#x7F6E;&#x7EC4;&#x6570;&#x914D;&#x7F6E;"><b></b>&#x653E;&#x7F6E;&#x7EC4;&#x6570;&#x914D;&#x7F6E;</a></li><li><span class="title-icon "></span><a href="#&#x653E;&#x7F6E;&#x7EC4;&#x89E3;&#x6790;"><b></b>&#x653E;&#x7F6E;&#x7EC4;&#x89E3;&#x6790;</a></li><li><span class="title-icon "></span><a href="#&#x653E;&#x7F6E;&#x7EC4;&#x6743;&#x8861;"><b></b>&#x653E;&#x7F6E;&#x7EC4;&#x6743;&#x8861;</a></li></ul><li><span class="title-icon "></span><a href="#rbd&#x7BA1;&#x7406;"><b></b>rbd&#x7BA1;&#x7406;</a></li><ul><li><span class="title-icon "></span><a href="#&#x521B;&#x5EFA;"><b></b>&#x521B;&#x5EFA;</a></li><li><span class="title-icon "></span><a href="#&#x67E5;&#x770B;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;"><b></b>&#x67E5;&#x770B;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;</a></li><li><span class="title-icon "></span><a href="#&#x8C03;&#x6574;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;&#x7684;&#x5927;&#x5C0F;"><b></b>&#x8C03;&#x6574;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;&#x7684;&#x5927;&#x5C0F;</a></li><li><span class="title-icon "></span><a href="#&#x5220;&#x9664;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;"><b></b>&#x5220;&#x9664;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;</a></li><li><span class="title-icon "></span><a href="#&#x6302;&#x8F7D;&#x5757;&#x8BBE;&#x5907;"><b></b>&#x6302;&#x8F7D;&#x5757;&#x8BBE;&#x5907;</a></li></ul><li><span class="title-icon "></span><a href="#&#x5378;&#x8F7D;"><b></b>&#x5378;&#x8F7D;</a></li><ul><li><span class="title-icon "></span><a href="#&#x5220;&#x9664;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;"><b></b>&#x5220;&#x9664;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</a></li><li><span class="title-icon "></span><a href="#&#x5220;&#x9664;&#x6C60;_1"><b></b>&#x5220;&#x9664;&#x6C60;</a></li><li><span class="title-icon "></span><a href="#&#x5220;&#x9664;osd"><b></b>&#x5220;&#x9664;OSD</a></li><li><span class="title-icon "></span><a href="#&#x5378;&#x8F7D;&#x7EC4;&#x4EF6;&#x5E76;&#x6E05;&#x7A7A;&#x76EE;&#x5F55;"><b></b>&#x5378;&#x8F7D;&#x7EC4;&#x4EF6;&#x5E76;&#x6E05;&#x7A7A;&#x76EE;&#x5F55;</a></li></ul><li><span class="title-icon "></span><a href="#&#x53C2;&#x8003;&#x6587;&#x732E;"><b></b>&#x53C2;&#x8003;&#x6587;&#x732E;</a></li></ul></ul></div><a href="#&#x5BFC;&#x8BFB;" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
<p><strong>Table of Contents</strong>  <em>generated with <a href="https://github.com/thlorenz/doctoc" target="_blank">DocToc</a></em></p>
<ul>
<li><a href="#%E5%AF%BC%E8%AF%BB">&#x5BFC;&#x8BFB;</a><ul>
<li><a href="#%E8%AF%B4%E6%98%8E">&#x8BF4;&#x660E;</a></li>
<li><a href="#%E7%B4%A2%E5%BC%95">&#x7D22;&#x5F15;</a></li>
</ul>
</li>
<li><a href="#ceph%E8%A7%A3%E6%9E%90">Ceph&#x89E3;&#x6790;</a><ul>
<li><a href="#ceph%E6%9C%AF%E8%AF%AD">Ceph&#x672F;&#x8BED;</a></li>
<li><a href="#ceph%E5%AD%98%E5%82%A8%E9%9B%86%E7%BE%A4">Ceph&#x5B58;&#x50A8;&#x96C6;&#x7FA4;</a><ul>
<li><a href="#ceph%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%B5%81%E7%A8%8B"><code>Ceph</code>&#x6570;&#x636E;&#x5B58;&#x50A8;&#x6D41;&#x7A0B;</a></li>
<li><a href="#ceph%E7%9A%84%E5%8F%AF%E4%BC%B8%E7%BC%A9%E6%80%A7%E5%92%8C%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7"><code>Ceph</code>&#x7684;&#x53EF;&#x4F38;&#x7F29;&#x6027;&#x548C;&#x9AD8;&#x53EF;&#x7528;&#x6027;</a></li>
</ul>
</li>
<li><a href="#crush%E7%AE%97%E6%B3%95%E4%BB%8B%E7%BB%8D"><code>CRUSH</code>&#x7B97;&#x6CD5;&#x4ECB;&#x7ECD;</a><ul>
<li><a href="#mon%E9%AB%98%E5%8F%AF%E7%94%A8"><code>mon</code>&#x9AD8;&#x53EF;&#x7528;</a></li>
</ul>
</li>
<li><a href="#%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7">&#x8EAB;&#x4EFD;&#x8BA4;&#x8BC1;&#x9AD8;&#x53EF;&#x7528;&#x6027;</a></li>
<li><a href="#%E5%8A%A8%E6%80%81%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86">&#x52A8;&#x6001;&#x96C6;&#x7FA4;&#x7BA1;&#x7406;</a></li>
<li><a href="#%E5%88%86%E7%BA%A7%E7%BC%93%E5%AD%98">&#x5206;&#x7EA7;&#x7F13;&#x5B58;</a></li>
<li><a href="#ceph%E5%8D%8F%E8%AE%AE">Ceph&#x534F;&#x8BAE;</a><ul>
<li><a href="#ceph%E5%8D%8F%E8%AE%AE%E4%B8%8Elibrados"><code>Ceph</code>&#x534F;&#x8BAE;&#x4E0E;<code>librados</code></a></li>
<li><a href="#%E5%AF%B9%E8%B1%A1%E8%A7%82%E6%B5%8B%E9%80%9A%E7%9F%A5">&#x5BF9;&#x8C61;&#x89C2;&#x6D4B;&#x901A;&#x77E5;</a></li>
</ul>
</li>
<li><a href="#%E6%95%B0%E6%8D%AE%E5%88%86%E6%AE%B5">&#x6570;&#x636E;&#x5206;&#x6BB5;</a></li>
</ul>
</li>
<li><a href="#ceph%E5%AD%98%E5%82%A8%E7%B1%BB%E5%9E%8B">Ceph&#x5B58;&#x50A8;&#x7C7B;&#x578B;</a><ul>
<li><a href="#ceph%E5%9D%97%E5%AD%98%E5%82%A8">Ceph&#x5757;&#x5B58;&#x50A8;</a></li>
<li><a href="#ceph%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F">Ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</a><ul>
<li><a href="#%E9%83%A8%E7%BD%B2%E5%85%83%E6%95%B0%E6%8D%AE%E6%9C%8D%E5%8A%A1%E5%99%A8">&#x90E8;&#x7F72;&#x5143;&#x6570;&#x636E;&#x670D;&#x52A1;&#x5668;</a><ul>
<li><a href="#mds%E5%AE%BF%E4%B8%BB%E6%9C%BA%E9%85%8D%E7%BD%AE%E9%9C%80%E6%B1%82">MDS&#x5BBF;&#x4E3B;&#x673A;&#x914D;&#x7F6E;&#x9700;&#x6C42;</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#ceph-%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8">Ceph &#x5BF9;&#x8C61;&#x5B58;&#x50A8;</a></li>
<li><a href="#%E7%AB%9E%E5%93%81%E5%AF%B9%E6%AF%94">&#x7ADE;&#x54C1;&#x5BF9;&#x6BD4;</a><ul>
<li><a href="#%E5%AF%B9%E6%AF%94raid">&#x5BF9;&#x6BD4;raid</a></li>
<li><a href="#%E5%AF%B9%E6%AF%94sannasdas">&#x5BF9;&#x6BD4;SAN&#x3001;NAS&#x3001;DAS</a></li>
<li><a href="#%E5%AF%B9%E6%AF%94%E5%85%B6%E4%BB%96%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8">&#x5BF9;&#x6BD4;&#x5176;&#x4ED6;&#x5206;&#x5E03;&#x5F0F;&#x5B58;&#x50A8;</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E9%9B%86%E6%88%90%E9%83%A8%E7%BD%B2">&#x96C6;&#x6210;&#x90E8;&#x7F72;</a><ul>
<li><a href="#%E7%A1%AC%E4%BB%B6%E9%9C%80%E6%B1%82">&#x786C;&#x4EF6;&#x9700;&#x6C42;</a><ul>
<li><a href="#cpu">CPU</a></li>
<li><a href="#%E5%86%85%E5%AD%98">&#x5185;&#x5B58;</a></li>
<li><a href="#%E5%AD%98%E5%82%A8">&#x5B58;&#x50A8;</a></li>
<li><a href="#%E7%BD%91%E7%BB%9C">&#x7F51;&#x7EDC;</a></li>
<li><a href="#%E6%95%85%E9%9A%9C%E5%9F%9F">&#x6545;&#x969C;&#x57DF;</a></li>
<li><a href="#%E7%A1%AC%E4%BB%B6%E9%85%8D%E7%BD%AE%E5%BB%BA%E8%AE%AE">&#x786C;&#x4EF6;&#x914D;&#x7F6E;&#x5EFA;&#x8BAE;</a></li>
</ul>
</li>
<li><a href="#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%BB%BA%E8%AE%AE">&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5EFA;&#x8BAE;</a><ul>
<li><a href="#%E5%86%85%E6%A0%B8">&#x5185;&#x6838;</a></li>
<li><a href="#%E5%B9%B3%E5%8F%B0">&#x5E73;&#x53F0;</a></li>
</ul>
</li>
<li><a href="#%E7%8E%AF%E5%A2%83%E8%AF%B4%E6%98%8E">&#x73AF;&#x5883;&#x8BF4;&#x660E;</a></li>
<li><a href="#%E7%8E%AF%E5%A2%83%E5%88%9D%E5%A7%8B%E5%8C%96">&#x73AF;&#x5883;&#x521D;&#x59CB;&#x5316;</a><ul>
<li><a href="#%E9%85%8D%E7%BD%AEyum">&#x914D;&#x7F6E;yum</a></li>
<li><a href="#yum%E4%BE%9D%E8%B5%96%E5%AF%BC%E5%87%BA">yum&#x4F9D;&#x8D56;&#x5BFC;&#x51FA;</a></li>
<li><a href="#%E9%85%8D%E7%BD%AE%E6%97%B6%E9%92%9F%E5%90%8C%E6%AD%A5">&#x914D;&#x7F6E;&#x65F6;&#x949F;&#x540C;&#x6B65;</a></li>
<li><a href="#%E5%8D%87%E7%BA%A7%E5%86%85%E6%A0%B8">&#x5347;&#x7EA7;&#x5185;&#x6838;</a></li>
<li><a href="#raid%E5%8D%A1">raid&#x5361;</a></li>
</ul>
</li>
<li><a href="#%E5%AE%89%E8%A3%85ceph">&#x5B89;&#x88C5;ceph</a></li>
<li><a href="#%E9%85%8D%E7%BD%AEceph">&#x914D;&#x7F6E;ceph</a><ul>
<li><a href="#%E6%B7%BB%E5%8A%A0osd">&#x6DFB;&#x52A0;OSD</a><ul>
<li><a href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3">&#x5E38;&#x89C1;&#x95EE;&#x9898;&#x89E3;&#x51B3;</a></li>
</ul>
</li>
<li><a href="#crush-class">crush class</a></li>
<li><a href="#crush-pool">crush pool</a><ul>
<li><a href="#ssd-crush-rule">ssd crush rule</a></li>
<li><a href="#nvme-crush-rule">nvme crush rule</a></li>
<li><a href="#%E6%B5%8B%E8%AF%95crush-rule">&#x6D4B;&#x8BD5;crush rule</a></li>
</ul>
</li>
<li><a href="#%E5%AE%89%E8%A3%85dashboard">&#x5B89;&#x88C5;dashboard</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#ceph%E5%AD%98%E5%82%A8%E5%AE%9E%E8%B7%B5">ceph&#x5B58;&#x50A8;&#x5B9E;&#x8DF5;</a><ul>
<li><a href="#%E5%9D%97%E8%AE%BE%E5%A4%87%E4%BD%BF%E7%94%A8">&#x5757;&#x8BBE;&#x5907;&#x4F7F;&#x7528;</a><ul>
<li><a href="#ceph%E7%AE%A1%E7%90%86%E8%8A%82%E7%82%B9">ceph&#x7BA1;&#x7406;&#x8282;&#x70B9;</a></li>
<li><a href="#%E5%AE%A2%E6%88%B7%E7%AB%AF">&#x5BA2;&#x6237;&#x7AEF;</a></li>
<li><a href="#%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF">&#x9002;&#x7528;&#x573A;&#x666F;</a></li>
</ul>
</li>
<li><a href="#ceph%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%BD%BF%E7%94%A8">ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4F7F;&#x7528;</a><ul>
<li><a href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF">&#x670D;&#x52A1;&#x7AEF;</a></li>
<li><a href="#%E5%AE%A2%E6%88%B7%E7%AB%AF-1">&#x5BA2;&#x6237;&#x7AEF;</a></li>
<li><a href="#%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF-1">&#x9002;&#x7528;&#x573A;&#x666F;</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#k8s%E5%AF%B9%E6%8E%A5ceph">k8s&#x5BF9;&#x63A5;ceph</a><ul>
<li><a href="#k8s-csi">k8s-csi</a><ul>
<li><a href="#csi%E7%AE%80%E4%BB%8B">csi&#x7B80;&#x4ECB;</a></li>
<li><a href="#csi%E8%AE%BE%E8%AE%A1%E8%83%8C%E6%99%AF">csi&#x8BBE;&#x8BA1;&#x80CC;&#x666F;</a></li>
<li><a href="#csi%E6%9E%B6%E6%9E%84">csi&#x67B6;&#x6784;</a><ul>
<li><a href="#csi-controller">CSI Controller</a></li>
<li><a href="#csi-node">CSI Node</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#k8s%E6%8E%A5%E5%85%A5ceph%E5%9D%97%E5%AD%98%E5%82%A8">k8s&#x63A5;&#x5165;ceph&#x5757;&#x5B58;&#x50A8;</a><ul>
<li><a href="#ceph%E6%9C%8D%E5%8A%A1%E7%AB%AF">ceph&#x670D;&#x52A1;&#x7AEF;</a></li>
<li><a href="#k8s%E8%8A%82%E7%82%B9">k8s&#x8282;&#x70B9;</a></li>
</ul>
</li>
<li><a href="#k8s%E6%8E%A5%E5%85%A5ceph%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F">k8s&#x63A5;&#x5165;ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</a><ul>
<li><a href="#ceph%E6%9C%8D%E5%8A%A1%E7%AB%AF-1">ceph&#x670D;&#x52A1;&#x7AEF;</a></li>
<li><a href="#k8s%E8%8A%82%E7%82%B9-1">k8s&#x8282;&#x70B9;</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#ceph%E8%BF%90%E7%BB%B4%E7%AE%A1%E7%90%86">ceph&#x8FD0;&#x7EF4;&#x7BA1;&#x7406;</a><ul>
<li><a href="#%E6%9C%8D%E5%8A%A1%E5%90%AF%E5%81%9C">&#x670D;&#x52A1;&#x542F;&#x505C;</a><ul>
<li><a href="#%E6%8C%89%E8%8A%82%E7%82%B9%E5%90%AF%E5%8A%A8%E6%89%80%E6%9C%89ceph%E6%9C%8D%E5%8A%A1">&#x6309;&#x8282;&#x70B9;&#x542F;&#x52A8;&#x6240;&#x6709;ceph&#x670D;&#x52A1;</a></li>
<li><a href="#%E6%8C%89%E8%8A%82%E7%82%B9%E5%81%9C%E6%AD%A2%E6%89%80%E6%9C%89ceph%E6%9C%8D%E5%8A%A1">&#x6309;&#x8282;&#x70B9;&#x505C;&#x6B62;&#x6240;&#x6709;ceph&#x670D;&#x52A1;</a></li>
<li><a href="#%E6%8E%A7%E5%88%B6%E8%8A%82%E7%82%B9%E7%AE%A1%E7%90%86%E9%9B%86%E7%BE%A4%E6%89%80%E6%9C%89%E6%9C%8D%E5%8A%A1">&#x63A7;&#x5236;&#x8282;&#x70B9;&#x7BA1;&#x7406;&#x96C6;&#x7FA4;&#x6240;&#x6709;&#x670D;&#x52A1;</a></li>
</ul>
</li>
<li><a href="#pool%E7%AE%A1%E7%90%86">pool&#x7BA1;&#x7406;</a><ul>
<li><a href="#%E6%9F%A5%E7%9C%8Bpool">&#x67E5;&#x770B;<code>pool</code></a></li>
<li><a href="#%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AApool">&#x521B;&#x5EFA;&#x4E00;&#x4E2A;pool</a></li>
<li><a href="#%E8%AE%BE%E7%BD%AE%E6%B1%A0%E7%9A%84%E6%94%BE%E7%BD%AE%E7%BB%84%E6%95%B0">&#x8BBE;&#x7F6E;&#x6C60;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x6570;</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96%E6%B1%A0%E7%9A%84%E6%94%BE%E7%BD%AE%E7%BB%84%E6%95%B0">&#x83B7;&#x53D6;&#x6C60;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x6570;</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96%E9%9B%86%E7%BE%A4%E7%9A%84pg%E7%BB%9F%E8%AE%A1%E4%BF%A1%E6%81%AF">&#x83B7;&#x53D6;&#x96C6;&#x7FA4;&#x7684;PG&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;</a></li>
<li><a href="#%E5%B0%86%E6%B1%A0%E4%B8%8E%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%85%B3%E8%81%94">&#x5C06;&#x6C60;&#x4E0E;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5173;&#x8054;</a></li>
<li><a href="#%E6%B1%A0%E9%85%8D%E9%A2%9D">&#x6C60;&#x914D;&#x989D;</a></li>
<li><a href="#%E5%88%A0%E9%99%A4%E6%B1%A0">&#x5220;&#x9664;&#x6C60;</a></li>
<li><a href="#%E6%B1%A0%E9%87%8D%E5%91%BD%E5%90%8D">&#x6C60;&#x91CD;&#x547D;&#x540D;</a></li>
<li><a href="#%E6%98%BE%E7%A4%BA%E6%B1%A0%E7%BB%9F%E8%AE%A1%E4%BF%A1%E6%81%AF">&#x663E;&#x793A;&#x6C60;&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;</a></li>
<li><a href="#%E5%88%9B%E5%BB%BA%E6%B1%A0%E5%BF%AB%E7%85%A7">&#x521B;&#x5EFA;&#x6C60;&#x5FEB;&#x7167;</a></li>
<li><a href="#%E5%88%A0%E9%99%A4%E6%B1%A0%E5%BF%AB%E7%85%A7">&#x5220;&#x9664;&#x6C60;&#x5FEB;&#x7167;</a></li>
<li><a href="#%E6%B1%A0%E5%85%B6%E4%BB%96%E9%85%8D%E7%BD%AE">&#x6C60;&#x5176;&#x4ED6;&#x914D;&#x7F6E;</a></li>
<li><a href="#%E8%AE%BE%E7%BD%AE%E5%AF%B9%E8%B1%A1%E5%89%AF%E6%9C%AC%E6%95%B0">&#x8BBE;&#x7F6E;&#x5BF9;&#x8C61;&#x526F;&#x672C;&#x6570;</a></li>
<li><a href="#pg_autoscale_mode">pg_autoscale_mode</a></li>
<li><a href="#%E6%8C%87%E5%AE%9A%E6%B1%A0%E7%9A%84%E6%9C%9F%E6%9C%9B%E5%A4%A7%E5%B0%8F">&#x6307;&#x5B9A;&#x6C60;&#x7684;&#x671F;&#x671B;&#x5927;&#x5C0F;</a></li>
<li><a href="#%E6%94%BE%E7%BD%AE%E7%BB%84%E6%95%B0%E9%85%8D%E7%BD%AE">&#x653E;&#x7F6E;&#x7EC4;&#x6570;&#x914D;&#x7F6E;</a></li>
<li><a href="#%E6%94%BE%E7%BD%AE%E7%BB%84%E8%A7%A3%E6%9E%90">&#x653E;&#x7F6E;&#x7EC4;&#x89E3;&#x6790;</a></li>
<li><a href="#%E6%94%BE%E7%BD%AE%E7%BB%84%E6%9D%83%E8%A1%A1">&#x653E;&#x7F6E;&#x7EC4;&#x6743;&#x8861;</a></li>
</ul>
</li>
<li><a href="#rbd%E7%AE%A1%E7%90%86">rbd&#x7BA1;&#x7406;</a><ul>
<li><a href="#%E5%88%9B%E5%BB%BA">&#x521B;&#x5EFA;</a></li>
<li><a href="#%E6%9F%A5%E7%9C%8B%E5%9D%97%E8%AE%BE%E5%A4%87%E6%98%A0%E5%83%8F">&#x67E5;&#x770B;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;</a></li>
<li><a href="#%E8%B0%83%E6%95%B4%E5%9D%97%E8%AE%BE%E5%A4%87%E6%98%A0%E5%83%8F%E7%9A%84%E5%A4%A7%E5%B0%8F">&#x8C03;&#x6574;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;&#x7684;&#x5927;&#x5C0F;</a><ul>
<li><a href="#%E7%BC%A9%E5%AE%B9">&#x7F29;&#x5BB9;</a></li>
<li><a href="#%E6%89%A9%E5%AE%B9">&#x6269;&#x5BB9;</a></li>
</ul>
</li>
<li><a href="#%E5%88%A0%E9%99%A4%E5%9D%97%E8%AE%BE%E5%A4%87%E6%98%A0%E5%83%8F">&#x5220;&#x9664;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;</a></li>
<li><a href="#%E6%8C%82%E8%BD%BD%E5%9D%97%E8%AE%BE%E5%A4%87">&#x6302;&#x8F7D;&#x5757;&#x8BBE;&#x5907;</a></li>
</ul>
</li>
<li><a href="#%E5%8D%B8%E8%BD%BD">&#x5378;&#x8F7D;</a><ul>
<li><a href="#%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F">&#x5220;&#x9664;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</a></li>
<li><a href="#%E5%88%A0%E9%99%A4%E6%B1%A0-1">&#x5220;&#x9664;&#x6C60;</a></li>
<li><a href="#%E5%88%A0%E9%99%A4osd">&#x5220;&#x9664;OSD</a></li>
<li><a href="#%E5%8D%B8%E8%BD%BD%E7%BB%84%E4%BB%B6%E5%B9%B6%E6%B8%85%E7%A9%BA%E7%9B%AE%E5%BD%95">&#x5378;&#x8F7D;&#x7EC4;&#x4EF6;&#x5E76;&#x6E05;&#x7A7A;&#x76EE;&#x5F55;</a></li>
</ul>
</li>
<li><a href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE">&#x53C2;&#x8003;&#x6587;&#x732E;</a></li>
</ul>
</li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->
<h1 id="&#x5BFC;&#x8BFB;"><a name="&#x5BFC;&#x8BFB;" class="anchor-navigation-ex-anchor" href="#&#x5BFC;&#x8BFB;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5BFC;&#x8BFB;</h1>
<h2 id="&#x8BF4;&#x660E;"><a name="&#x8BF4;&#x660E;" class="anchor-navigation-ex-anchor" href="#&#x8BF4;&#x660E;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x8BF4;&#x660E;</h2>
<ul>
<li><p><code>ceph</code>&#x76F8;&#x5173;&#x4E8E;<code>nfs</code>&#x6027;&#x80FD;&#x8F83;&#x9AD8;&#xFF0C;&#x4E14;&#x80FD;&#x63D0;&#x4F9B;&#x5757;&#x5B58;&#x50A8;&#x3001;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3001;&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x7F51;&#x5173;&#x4E09;&#x79CD;&#x7C7B;&#x578B;&#x5B58;&#x50A8;&#x3002;</p>
</li>
<li><p><code>ceph</code>&#x96C6;&#x6210;&#x90E8;&#x7F72;&#x8F83;&#x4E3A;&#x7B80;&#x5355;&#x3001;&#x4E14;&#x6210;&#x672C;&#x8F83;&#x4F4E;(&#x76F8;&#x5BF9;&#x4E8E;<code>nas</code>&#x3001;<code>SAN</code>)</p>
</li>
<li><p><code>ceph</code>&#x53EF;&#x5229;&#x7528;&#x73B0;&#x6709;&#x670D;&#x52A1;&#x5668;&#x8D44;&#x6E90;&#xFF08;&#x88F8;&#x91D1;&#x5C5E;&#x670D;&#x52A1;&#x5668;&#xFF09;&#xFF0C;&#x800C;&#x4E0D;&#x7528;&#x989D;&#x5916;&#x8D2D;&#x4E70;&#x5B58;&#x50A8;&#x8BBE;&#x5907;&#x3002;&#x6784;&#x5EFA;&#x9AD8;&#x6027;&#x80FD;&#x3001;&#x9AD8;&#x53EF;&#x7528;&#x7684;&#x7EDF;&#x4E00;&#x5B58;&#x50A8;&#x7CFB;&#x7EDF;&#xFF0C;&#x4F9B;&#x516C;&#x53F8;&#x5185;&#x90E8;&#x9002;&#x7528;</p>
</li>
<li><p>&#x4E3B;&#x6D41;&#x4E91;&#x8BA1;&#x7B97;&#x7CFB;&#x7EDF;&#xFF08;Openstack&#x7B49;&#xFF09;&#x4E00;&#x822C;&#x9009;&#x53D6;<code>ceph</code>&#x4F5C;&#x4E3A;&#x540E;&#x7AEF;&#x5B58;&#x50A8;&#xFF0C;&#x8BF4;&#x660E;&#x5176;&#x4F18;&#x5F02;&#x6027;</p>
</li>
<li><p><code>ceph</code>&#x5F00;&#x6E90;&#xFF0C;&#x76F8;&#x6BD4;&#x5546;&#x7528;&#x8F6F;&#x4EF6;&#x6709;&#x5929;&#x7136;&#x4F18;&#x52BF;</p>
</li>
</ul>
<h2 id="&#x7D22;&#x5F15;"><a name="&#x7D22;&#x5F15;" class="anchor-navigation-ex-anchor" href="#&#x7D22;&#x5F15;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x7D22;&#x5F15;</h2>
<p>&#x672C;&#x6587;&#x7AE0;&#x7BC7;&#x5E45;&#x8F83;&#x957F;&#xFF0C;&#x5177;&#x4F53;&#x53EF;&#x5206;&#x4EE5;&#x4E0B;&#x90E8;&#x5206;&#xFF1A;</p>
<ul>
<li><p><a href="#Ceph&#x67B6;&#x6784;&#x89E3;&#x6790;">ceph&#x67B6;&#x6784;</a>&#xFF1A;&#x89E3;&#x6790;<code>ceph</code>&#x67B6;&#x6784;&#xFF0C;&#x4ECB;&#x7ECD;<code>ceph</code>&#x5404;&#x7EC4;&#x4EF6;&#x529F;&#x80FD;&#xFF0C;&#x53CA;&#x96C6;&#x7FA4;&#x7BA1;&#x7406;&#x7B49;&#x5185;&#x5BB9;</p>
</li>
<li><p><a href="#Ceph&#x5B58;&#x50A8;&#x7C7B;&#x578B;">ceph&#x5B58;&#x50A8;&#x7C7B;&#x578B;</a>&#xFF1A;&#x89E3;&#x6790;<code>ceph</code>&#x5757;&#x5B58;&#x50A8;&#x3001;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3001;&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x7F51;&#x5173;</p>
</li>
<li><p><a href="#&#x96C6;&#x6210;&#x90E8;&#x7F72;">&#x96C6;&#x6210;&#x90E8;&#x7F72;</a>&#xFF1A;&#x57FA;&#x4E8E;<code>CentOS7</code>&#x642D;&#x5EFA;<code>ceph HA</code>&#x96C6;&#x7FA4;</p>
</li>
<li><p><a href="#ceph&#x6700;&#x4F73;&#x5B9E;&#x8DF5;]">ceph&#x6700;&#x4F73;&#x5B9E;&#x8DF5;</a>&#xFF1A;<code>ceph</code>&#x5E94;&#x7528;&#x573A;&#x666F;&#xFF0C;&#x5305;&#x62EC;&#x4E0E;<code>k8s</code>&#x96C6;&#x6210;</p>
</li>
</ul>
<h1 id="ceph&#x89E3;&#x6790;"><a name="ceph&#x89E3;&#x6790;" class="anchor-navigation-ex-anchor" href="#ceph&#x89E3;&#x6790;"><i class="fa fa-link" aria-hidden="true"></i></a>Ceph&#x89E3;&#x6790;</h1>
<p><code>Ceph</code>&#x662F;&#x4E00;&#x4E2A;&#x63D0;&#x4F9B;&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x3001;&#x5757;&#x5B58;&#x50A8;&#x548C;&#x6587;&#x4EF6;&#x5B58;&#x50A8;&#x7684;&#x7EDF;&#x4E00;&#x5B58;&#x50A8;&#x7CFB;&#x7EDF;&#x3002;
<code>Ceph</code>&#x662F;&#x9AD8;&#x5EA6;&#x53EF;&#x9760;&#x3001;&#x6613;&#x4E8E;&#x7BA1;&#x7406;&#x548C;&#x514D;&#x8D39;&#x7684;&#x3002;<code>Ceph</code>&#x7684;&#x5F3A;&#x5927;&#x529F;&#x80FD;&#x53EF;&#x4EE5;&#x6539;&#x53D8;&#x4F01;&#x4E1A;<code>IT</code>&#x57FA;&#x7840;&#x8BBE;&#x65BD;&#x548C;&#x7BA1;&#x7406;&#x5927;&#x91CF;&#x6570;&#x636E;&#x7684;&#x80FD;&#x529B;&#x3002;
<code>Ceph</code>&#x63D0;&#x4F9B;&#x4E86;&#x8D85;&#x5F3A;&#x7684;&#x53EF;&#x4F38;&#x7F29;&#x6027;--&#x6570;&#x4EE5;&#x5343;&#x8BA1;&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x8BBF;&#x95EE;<code>pb</code>&#x5230;<code>eb</code>&#x7684;&#x6570;&#x636E;.</p>
<p><img src="images/stack.png" alt=""></p>
<h2 id="ceph&#x672F;&#x8BED;"><a name="ceph&#x672F;&#x8BED;" class="anchor-navigation-ex-anchor" href="#ceph&#x672F;&#x8BED;"><i class="fa fa-link" aria-hidden="true"></i></a>Ceph&#x672F;&#x8BED;</h2>
<p>&#x672C;&#x672F;&#x8BED;&#x8868;&#x4E2D;&#x7684;&#x672F;&#x8BED;&#x65E8;&#x5728;&#x89E3;&#x91CA;&#x8BF4;&#x660E;<code>Ceph</code>&#x73B0;&#x6709;&#x7684;&#x6280;&#x672F;&#x672F;&#x8BED;&#x3002;</p>
<ul>
<li><code>cephx</code>&#xFF1A;<code>Ceph</code>&#x8BA4;&#x8BC1;&#x534F;&#x8BAE;&#xFF0C;&#x64CD;&#x4F5C;&#x7C7B;&#x4F3C;<code>Kerberos</code>&#xFF0C;&#x4F46;&#x4E0D;&#x5B58;&#x5728;&#x5355;&#x70B9;&#x6545;&#x969C;&#x60C5;&#x51B5;</li>
<li><code>Ceph</code>&#x5E73;&#x53F0;&#xFF1A;&#x6240;&#x6709;<code>Ceph</code>&#x8F6F;&#x4EF6;</li>
<li><code>Ceph</code>&#x5806;&#x6808;&#xFF1A;<code>Ceph</code>&#x7684;&#x4E24;&#x79CD;&#x6216;&#x591A;&#x79CD;&#x7EC4;&#x4EF6;&#x7684;&#x96C6;&#x5408;</li>
<li>&#x96C6;&#x7FA4;&#x6620;&#x5C04;&#xFF1A;&#x5305;&#x62EC;<code>MON</code>&#x6620;&#x5C04;&#x3001;<code>OSD</code>&#x6620;&#x5C04;&#x3001;<code>PG</code>&#x6620;&#x5C04;&#x3001;<code>MDS</code>&#x6620;&#x5C04;&#x548C;<code>CRUSH</code>&#x6620;&#x5C04;</li>
<li><code>Ceph&#x5BF9;&#x8C61;&#x5B58;&#x50A8;</code>&#xFF1A;&#x7531;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x548C;<code>Ceph</code>&#x5BF9;&#x8C61;&#x7F51;&#x5173;&#x7EC4;&#x6210;</li>
<li><code>RGW</code>&#xFF1A;<code>Ceph</code>&#x7684;<code>S3/Swift</code>&#x7F51;&#x5173;&#x7EC4;&#x4EF6;</li>
<li><code>RBD</code>&#xFF1A;<code>Ceph</code>&#x5757;&#x5B58;&#x50A8;&#x7EC4;&#x4EF6;</li>
<li><code>Ceph&#x5757;&#x5B58;&#x50A8;</code>&#xFF1A;&#x7528;&#x4E8E;&#x4E0E;<code>librbd</code>&#x3001;&#x7BA1;&#x7406;&#x7A0B;&#x5E8F;&#xFF08;&#x5982;<code>QEMU</code>&#x6216;<code>Xen</code>&#xFF09;&#x548C;&#x7BA1;&#x7406;&#x7A0B;&#x5E8F;&#x62BD;&#x8C61;&#x5C42;&#xFF08;&#x5982;<code>libvirt</code>&#xFF09;&#x7ED3;&#x5408;&#x4F7F;&#x7528;</li>
<li><code>Ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</code>&#xFF1A;<code>Ceph</code>&#x7684;<code>POSIX</code>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x7EC4;&#x4EF6;</li>
<li><code>OSD</code>&#xFF1A;&#x7269;&#x7406;&#x6216;&#x903B;&#x8F91;&#x5B58;&#x50A8;&#x5355;&#x5143;(&#x5982;LUN)&#x3002;&#x6709;&#x65F6;&#xFF0C;<code>Ceph</code>&#x7528;&#x6237;&#x4F7F;&#x7528;&#x672F;&#x8BED;<code>OSD</code>&#x6765;&#x6307;&#x4EE3;<code>Ceph OSD</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#xFF0C;&#x5C3D;&#x7BA1;&#x6B63;&#x786E;&#x7684;&#x672F;&#x8BED;&#x662F;<code>Ceph OSD</code></li>
<li><code>Ceph OSD</code>&#xFF1A;<code>Ceph OSD</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#xFF0C;&#x4E0E;&#x903B;&#x8F91;&#x76D8;(<code>OSD</code>)&#x4EA4;&#x4E92;&#x3002;</li>
<li><code>OSD id</code>&#xFF1A;&#x5B9A;&#x4E49;<code>OSD</code>&#x7684;&#x6574;&#x6570;&#x3002;&#x5B83;&#x7531;&#x76D1;&#x89C6;&#x5668;&#x751F;&#x6210;&#xFF0C;&#x4F5C;&#x4E3A;&#x521B;&#x5EFA;&#x65B0;<code>OSD</code>&#x7684;&#x4E00;&#x90E8;&#x5206;         </li>
<li><code>OSD fsid</code>&#xFF1A;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x552F;&#x4E00;&#x6807;&#x8BC6;&#x7B26;&#xFF0C;&#x7528;&#x4E8E;&#x8FDB;&#x4E00;&#x6B65;&#x63D0;&#x9AD8;<code>OSD</code>&#x7684;&#x552F;&#x4E00;&#x6027;&#xFF0C;&#x5B83;&#x53EF;&#x4EE5;&#x5728;<code>OSD</code>&#x8DEF;&#x5F84;&#x4E2D;&#x7684;<code>osd_fsid</code>&#x6587;&#x4EF6;&#x4E2D;&#x627E;&#x5230;&#x3002;&#x8FD9;&#x4E2A;<code>fsid</code>&#x672F;&#x8BED;&#x53EF;&#x4EE5;&#x4E0E;<code>uuid</code>&#x4E92;&#x6362;&#x4F7F;&#x7528;</li>
<li><code>OSD uuid</code>&#xFF1A;&#x4E0E;<code>OSD fsid</code>&#x4E00;&#x6837;&#xFF0C;&#x8FD9;&#x662F;<code>OSD</code>&#x552F;&#x4E00;&#x6807;&#x8BC6;&#x7B26;&#xFF0C;&#x53EF;&#x4EE5;&#x4E0E;<code>OSD fsid</code>&#x4E92;&#x6362;&#x4F7F;&#x7528;</li>
<li><code>bluestore</code>&#xFF1A;<code>OSD BlueStore</code>&#x662F;<code>OSD</code>&#x5B88;&#x62A4;&#x7A0B;&#x5E8F;&#xFF08;kraken&#x548C;&#x66F4;&#x65B0;&#x7248;&#x672C;&#xFF09;&#x7684;&#x65B0;&#x540E;&#x7AEF;&#x3002;&#x4E0E;<code>filestore</code>&#x4E0D;&#x540C;&#xFF0C;&#x5B83;&#x76F4;&#x63A5;&#x5C06;&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x5728;<code>Ceph</code>&#x5757;&#x8BBE;&#x5907;&#x4E0A;&#xFF0C;&#x800C;&#x4E0D;&#x9700;&#x8981;&#x4EFB;&#x4F55;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x63A5;&#x53E3;</li>
<li><code>filestore</code>&#xFF1A;<code>OSD</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x7684;&#x540E;&#x7AEF;&#xFF0C;&#x9700;&#x8981;&#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x3001;&#x5C06;&#x6587;&#x4EF6;&#x5199;&#x5165;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</li>
<li><code>MON</code>&#xFF1A;<code>Ceph</code>&#x76D1;&#x63A7;&#x8F6F;&#x4EF6;</li>
<li><code>MGR</code>&#xFF1A;<code>Ceph</code>&#x7BA1;&#x7406;&#x5668;&#x8F6F;&#x4EF6;&#xFF0C;&#x6536;&#x96C6;&#x96C6;&#x7FA4;&#x6240;&#x6709;&#x72B6;&#x6001;   </li>
<li><code>MDS</code>&#xFF1A;<code>Ceph</code>&#x5143;&#x6570;&#x636E;&#x670D;&#x52A1;</li>
<li><code>Ceph Client</code>&#xFF1A;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x7684;<code>Ceph</code>&#x7EC4;&#x4EF6;&#x7684;&#x96C6;&#x5408;&#x3002;&#x7EC4;&#x4EF6;&#x5305;&#x62EC;<code>Ceph</code>&#x5BF9;&#x8C61;&#x7F51;&#x5173;&#x3001;<code>Ceph</code>&#x5757;&#x8BBE;&#x5907;&#x3001;<code>Ceph</code>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4EE5;&#x53CA;&#x5B83;&#x4EEC;&#x76F8;&#x5E94;&#x7684;&#x5E93;&#x3001;&#x5185;&#x6838;&#x6A21;&#x5757;&#x3001;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</li>
<li><code>Ceph Kernel Modules</code>&#xFF1A;&#x5185;&#x6838;&#x6A21;&#x5757;&#x7684;&#x96C6;&#x5408;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x4E0E;<code>Ceph</code>&#x7CFB;&#x7EDF;&#x4EA4;&#x4E92;(&#x4F8B;&#x5982;&#xFF0C;<code>Ceph.ko</code>, <code>rbd.ko</code>)&#x3002;</li>
<li><code>Ceph Client Libraries</code>&#xFF1A;&#x53EF;&#x7528;&#x4E8E;&#x4E0E;<code>Ceph</code>&#x7CFB;&#x7EDF;&#x7EC4;&#x4EF6;&#x4EA4;&#x4E92;&#x7684;&#x5E93;&#x96C6;&#x5408;</li>
<li><code>Ceph Release</code>&#xFF1A;&#x4EFB;&#x4F55;&#x660E;&#x663E;&#x7F16;&#x53F7;&#x7684;<code>Ceph</code>&#x7248;&#x672C;</li>
<li><code>Ceph Point Release</code>&#xFF1A;&#x4EFB;&#x4F55;&#x53EA;&#x5305;&#x542B;&#x9519;&#x8BEF;&#x6216;&#x5B89;&#x5168;&#x4FEE;&#x6B63;&#x7684;&#x7279;&#x522B;&#x53D1;&#x884C;&#x7248;</li>
<li><code>Ceph Interim Release</code>&#xFF1A;<code>Ceph</code>&#x7684;&#x7248;&#x672C;&#x5C1A;&#x672A;&#x901A;&#x8FC7;&#x8D28;&#x91CF;&#x4FDD;&#x8BC1;&#x6D4B;&#x8BD5;&#xFF0C;&#x4F46;&#x53EF;&#x80FD;&#x5305;&#x542B;&#x65B0;&#x7279;&#x6027;</li>
<li><code>Ceph Release Candidate</code>&#xFF1A;<code>Ceph</code>&#x7684;&#x4E00;&#x4E2A;&#x4E3B;&#x8981;&#x7248;&#x672C;&#xFF0C;&#x5DF2;&#x7ECF;&#x7ECF;&#x5386;&#x4E86;&#x6700;&#x521D;&#x7684;&#x8D28;&#x91CF;&#x4FDD;&#x8BC1;&#x6D4B;&#x8BD5;&#xFF0C;&#x5E76;&#x4E14;&#x5DF2;&#x7ECF;&#x4E3A;<code>beta</code>&#x6D4B;&#x8BD5;&#x505A;&#x597D;&#x4E86;&#x51C6;&#x5907;</li>
<li><code>Ceph Stable Release</code>&#xFF1A;<code>Ceph</code>&#x7684;&#x4E3B;&#x8981;&#x7248;&#x672C;&#xFF0C;&#x5176;&#x4E2D;&#x6240;&#x6709;&#x6765;&#x81EA;&#x524D;&#x4E00;&#x4E2A;&#x4E34;&#x65F6;&#x7248;&#x672C;&#x7684;&#x7279;&#x6027;&#x90FD;&#x6210;&#x529F;&#x5730;&#x901A;&#x8FC7;&#x4E86;&#x8D28;&#x91CF;&#x4FDD;&#x8BC1;&#x6D4B;&#x8BD5;</li>
<li><code>Teuthology</code>&#xFF1A;&#x5728;<code>Ceph</code>&#x4E0A;&#x6267;&#x884C;&#x811A;&#x672C;&#x6D4B;&#x8BD5;&#x7684;&#x8F6F;&#x4EF6;&#x96C6;&#x5408;</li>
<li><code>CRUSH</code>&#xFF1A;&#x53EF;&#x4F38;&#x7F29;&#x6563;&#x5217;&#x4E0B;&#x7684;&#x53D7;&#x63A7;&#x590D;&#x5236;(Controlled Replication Under Scalable Hashing)&#x3002;&#x8FD9;&#x662F;<code>Ceph</code>&#x7528;&#x6765;&#x8BA1;&#x7B97;&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x4F4D;&#x7F6E;&#x7684;&#x7B97;&#x6CD5;</li>
<li><code>CRUSH rule</code>&#xFF1A;&#x9002;&#x7528;&#x4E8E;&#x7279;&#x5B9A;&#x6C60;&#x7684;&#x538B;&#x7F29;&#x6570;&#x636E;&#x653E;&#x7F6E;&#x89C4;&#x5219;</li>
<li><code>Pools</code>&#xFF1A;&#x6C60;&#x662F;&#x7528;&#x4E8E;&#x5B58;&#x50A8;&#x5BF9;&#x8C61;&#x7684;&#x903B;&#x8F91;&#x5206;&#x533A;</li>
<li><code>systemd oneshot</code>&#xFF1A;&#x4E00;&#x79CD;<code>systemd</code>&#x7C7B;&#x578B;&#xFF0C;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#x5B9A;&#x4E49;&#x5728;<code>ExecStart</code>&#x4E2D;&#xFF0C;&#x5B83;&#x5C06;&#x5728;&#x5B8C;&#x6210;&#x65F6;&#x9000;&#x51FA;(&#x5B83;&#x4E0D;&#x6253;&#x7B97;&#x540E;&#x53F0;&#x5316;)</li>
<li><code>LVM tags</code>&#xFF1A;&#x7528;&#x4E8E;<code>LVM</code>&#x5377;&#x548C;&#x7EC4;&#x7684;&#x53EF;&#x6269;&#x5C55;&#x5143;&#x6570;&#x636E;&#x3002;&#x5B83;&#x7528;&#x4E8E;&#x5B58;&#x50A8;&#x5173;&#x4E8E;&#x8BBE;&#x5907;&#x53CA;&#x5176;&#x4E0E;<code>osd</code>&#x7684;&#x5173;&#x7CFB;&#x7684;&#x7279;&#x5B9A;&#x4E8E;<code>ceph</code>&#x7684;&#x4FE1;&#x606F;</li>
</ul>
<h2 id="ceph&#x5B58;&#x50A8;&#x96C6;&#x7FA4;"><a name="ceph&#x5B58;&#x50A8;&#x96C6;&#x7FA4;" class="anchor-navigation-ex-anchor" href="#ceph&#x5B58;&#x50A8;&#x96C6;&#x7FA4;"><i class="fa fa-link" aria-hidden="true"></i></a>Ceph&#x5B58;&#x50A8;&#x96C6;&#x7FA4;</h2>
<p><code>Ceph</code>&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x57FA;&#x4E8E;<code>RADOS</code>(&#x4E00;&#x79CD;&#x53EF;&#x6269;&#x5C55;&#x7684;&#x3001;&#x53EF;&#x9760;&#x7684;pb&#x7EA7;&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x5B58;&#x50A8;&#x670D;&#x52A1;)&#x7684;&#x65E0;&#x9650;&#x53EF;&#x6269;&#x5C55;&#x7684;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;.</p>
<p><code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x7531;&#x4E24;&#x79CD;&#x7C7B;&#x578B;&#x7684;&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x7EC4;&#x6210;:</p>
<ul>
<li><code>Ceph Monitor</code>&#xFF08;mon&#xFF09;</li>
<li><code>Ceph OSD Daemon</code>&#xFF08;OSD&#xFF09;</li>
</ul>
<p><img src="images/OSDmonitor.png" alt=""></p>
<p>&#x5176;&#x4E2D;<code>Ceph Monitor</code>&#x7EF4;&#x62A4;&#x96C6;&#x7FA4;&#x6620;&#x5C04;&#x7684;&#x4E3B;&#x526F;&#x672C;&#x3002;&#x591A;&#x8282;&#x70B9;<code>Ceph Monitor</code>&#x786E;&#x4FDD;&#x4E86;<code>Ceph Monitor</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x5931;&#x8D25;&#x65F6;&#x7684;&#x9AD8;&#x53EF;&#x7528;&#x6027;&#x3002;
<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x4ECE;<code>Ceph Monitor</code>&#x83B7;&#x53D6;&#x96C6;&#x7FA4;&#x4FE1;&#x606F;</p>
<p><code>ceph osd</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x68C0;&#x67E5;&#x81EA;&#x5DF1;&#x7684;&#x72B6;&#x6001;&#x548C;&#x5176;&#x4ED6;<code>OSD</code>&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x5E76;&#x5411;<code>Ceph Monitor</code>&#x4E0A;&#x62A5;&#x3002;</p>
<p><code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x548C;&#x6BCF;&#x4E2A;<code>ceph osd</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x4F7F;&#x7528;<code>CRUSH</code>&#x7B97;&#x6CD5;&#x9AD8;&#x6548;&#x5730;&#x8BA1;&#x7B97;&#x6570;&#x636E;&#x4F4D;&#x7F6E;&#x4FE1;&#x606F;&#xFF0C;&#x800C;&#x4E0D;&#x5FC5;&#x4F9D;&#x8D56;&#x4E8E;&#x4E2D;&#x592E;&#x67E5;&#x627E;&#x8868;&#x3002;
<code>Ceph</code>&#x7684;&#x9AD8;&#x7EA7;&#x7279;&#x6027;&#x5305;&#x62EC;&#x901A;&#x8FC7;<code>librados</code>&#x63D0;&#x4F9B;&#x5230;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x7684;&#x672C;&#x5730;&#x63A5;&#x53E3;&#xFF0C;&#x4EE5;&#x53CA;&#x5EFA;&#x7ACB;&#x5728;<code>librados</code>&#x4E4B;&#x4E0A;&#x7684;&#x8BB8;&#x591A;&#x670D;&#x52A1;&#x63A5;&#x53E3;&#x3002;</p>
<h3 id="ceph&#x6570;&#x636E;&#x5B58;&#x50A8;&#x6D41;&#x7A0B;"><a name="ceph&#x6570;&#x636E;&#x5B58;&#x50A8;&#x6D41;&#x7A0B;" class="anchor-navigation-ex-anchor" href="#ceph&#x6570;&#x636E;&#x5B58;&#x50A8;&#x6D41;&#x7A0B;"><i class="fa fa-link" aria-hidden="true"></i></a><code>Ceph</code>&#x6570;&#x636E;&#x5B58;&#x50A8;&#x6D41;&#x7A0B;</h3>
<p><code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x4ECE;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x63A5;&#x6536;&#x6570;&#x636E;&#x2014;&#x2014;&#x65E0;&#x8BBA;&#x662F;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;<code>Ceph</code>&#x5757;&#x8BBE;&#x5907;&#x3001;<code>Ceph</code>&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x3001;<code>Ceph</code>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x8FD8;&#x662F;&#x4F7F;&#x7528;<code>librados</code>&#x521B;&#x5EFA;&#x7684;&#x81EA;&#x5B9A;&#x4E49;&#x5B9E;&#x73B0;&#x2014;&#x2014;&#x5B83;&#x5C06;&#x6570;&#x636E;&#x4F5C;&#x4E3A;&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x3002;
&#x6BCF;&#x4E2A;&#x5BF9;&#x8C61;&#x90FD;&#x5BF9;&#x5E94;&#x4E8E;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x5B58;&#x50A8;&#x5728;&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x8BBE;&#x5907;&#x4E0A;&#x3002;<code>ceph osd</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x5904;&#x7406;&#x5B58;&#x50A8;&#x78C1;&#x76D8;&#x7684;&#x8BFB;&#x5199;&#x64CD;&#x4F5C;&#x3002;</p>
<p><img src="images/storagedata.png" alt=""></p>
<p><code>ceph osd</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x5C06;&#x6240;&#x6709;&#x6570;&#x636E;&#x4F5C;&#x4E3A;&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x5728;&#x4E00;&#x4E2A;&#x5E73;&#x9762;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x4E2D;(&#x6CA1;&#x6709;&#x76EE;&#x5F55;&#x5C42;&#x6B21;&#x7ED3;&#x6784;)&#x3002;
&#x5BF9;&#x8C61;&#x5177;&#x6709;&#x6807;&#x8BC6;&#x7B26;&#x3001;&#x4E8C;&#x8FDB;&#x5236;&#x6570;&#x636E;&#x548C;&#x7531;&#x4E00;&#x7EC4;&#x540D;&#x79F0;/&#x503C;&#x5BF9;&#x7EC4;&#x6210;&#x7684;&#x5143;&#x6570;&#x636E;&#x3002;&#x8BED;&#x4E49;&#x5B8C;&#x5168;&#x7531;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x51B3;&#x5B9A;&#x3002;
&#x4F8B;&#x5982;&#xFF0C;<code>CephFS</code>&#x4F7F;&#x7528;&#x5143;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x6587;&#x4EF6;&#x5C5E;&#x6027;&#xFF0C;&#x5982;&#x6587;&#x4EF6;&#x6240;&#x6709;&#x8005;&#x3001;&#x521B;&#x5EFA;&#x65E5;&#x671F;&#x3001;&#x6700;&#x540E;&#x4FEE;&#x6539;&#x65E5;&#x671F;&#x7B49;&#x3002;&#x5176;&#x4E2D;&#xFF0C;&#x5BF9;&#x8C61;ID&#x5168;&#x5C40;&#x552F;&#x4E00;&#x3002;</p>
<p><img src="images/dataforfat.png" alt=""></p>
<h3 id="ceph&#x7684;&#x53EF;&#x4F38;&#x7F29;&#x6027;&#x548C;&#x9AD8;&#x53EF;&#x7528;&#x6027;"><a name="ceph&#x7684;&#x53EF;&#x4F38;&#x7F29;&#x6027;&#x548C;&#x9AD8;&#x53EF;&#x7528;&#x6027;" class="anchor-navigation-ex-anchor" href="#ceph&#x7684;&#x53EF;&#x4F38;&#x7F29;&#x6027;&#x548C;&#x9AD8;&#x53EF;&#x7528;&#x6027;"><i class="fa fa-link" aria-hidden="true"></i></a><code>Ceph</code>&#x7684;&#x53EF;&#x4F38;&#x7F29;&#x6027;&#x548C;&#x9AD8;&#x53EF;&#x7528;&#x6027;</h3>
<p>&#x5728;&#x4F20;&#x7EDF;&#x7684;&#x67B6;&#x6784;&#x4E2D;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x4E0E;&#x4E00;&#x4E2A;&#x96C6;&#x4E2D;&#x7684;&#x7EC4;&#x4EF6;(&#x4F8B;&#x5982;&#xFF0C;&#x7F51;&#x5173;&#x3001;&#x4EE3;&#x7406;&#x3001;API&#x3001;facade&#x7B49;)&#x901A;&#x4FE1;&#xFF0C;&#x8BE5;&#x7EC4;&#x4EF6;&#x5145;&#x5F53;&#x4E00;&#x4E2A;&#x8FDB;&#x5165;&#x590D;&#x6742;&#x5B50;&#x7CFB;&#x7EDF;&#x7684;&#x5355;&#x4E00;&#x5165;&#x53E3;&#x70B9;&#x3002;
&#x8FD9;&#x5BF9;&#x6027;&#x80FD;&#x548C;&#x53EF;&#x4F38;&#x7F29;&#x6027;&#x90FD;&#x65BD;&#x52A0;&#x4E86;&#x9650;&#x5236;&#xFF0C;&#x540C;&#x65F6;&#x5F15;&#x5165;&#x4E86;&#x5355;&#x70B9;&#x6545;&#x969C;(&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x96C6;&#x4E2D;&#x5F0F;&#x7EC4;&#x4EF6;&#x5B95;&#x673A;&#xFF0C;&#x6574;&#x4E2A;&#x7CFB;&#x7EDF;&#x4E5F;&#x5B95;&#x673A;&#xFF09;</p>
<p><code>Ceph</code>&#x6D88;&#x9664;&#x4E86;&#x96C6;&#x4E2D;&#x5F0F;&#x7F51;&#x5173;&#xFF0C;&#x4F7F;&#x5BA2;&#x6237;&#x7AEF;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4E0E;<code>ceph osd</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x4EA4;&#x4E92;&#x3002;<code>ceph osd</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x5728;&#x5176;&#x4ED6;<code>Ceph</code>&#x8282;&#x70B9;&#x4E0A;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x526F;&#x672C;&#xFF0C;&#x4EE5;&#x786E;&#x4FDD;&#x6570;&#x636E;&#x7684;&#x5B89;&#x5168;&#x6027;&#x548C;&#x9AD8;&#x53EF;&#x7528;&#x6027;&#x3002;
<code>Ceph</code>&#x8FD8;&#x4F7F;&#x7528;&#x4E00;&#x7EC4;<code>mon</code>&#x6765;&#x786E;&#x4FDD;&#x9AD8;&#x53EF;&#x7528;&#x6027;&#x3002;&#x4E3A;&#x4E86;&#x6D88;&#x9664;&#x96C6;&#x4E2D;&#x5316;&#xFF0C;<code>Ceph</code>&#x4F7F;&#x7528;&#x4E86;&#x4E00;&#x79CD;&#x79F0;&#x4E3A;<code>CRUSH</code>&#x7684;&#x7B97;&#x6CD5;</p>
<h2 id="crush&#x7B97;&#x6CD5;&#x4ECB;&#x7ECD;"><a name="crush&#x7B97;&#x6CD5;&#x4ECB;&#x7ECD;" class="anchor-navigation-ex-anchor" href="#crush&#x7B97;&#x6CD5;&#x4ECB;&#x7ECD;"><i class="fa fa-link" aria-hidden="true"></i></a><code>CRUSH</code>&#x7B97;&#x6CD5;&#x4ECB;&#x7ECD;</h2>
<p><code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x548C;<code>ceph osd</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x90FD;&#x4F7F;&#x7528;<code>CRUSH</code>&#x7B97;&#x6CD5;&#x6765;&#x6709;&#x6548;&#x5730;&#x8BA1;&#x7B97;&#x5BF9;&#x8C61;&#x7684;&#x4F4D;&#x7F6E;&#x4FE1;&#x606F;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x4F9D;&#x8D56;&#x4E8E;&#x4E00;&#x4E2A;&#x4E2D;&#x5FC3;&#x67E5;&#x627E;&#x8868;&#x3002;
&#x4E0E;&#x4EE5;&#x524D;&#x7684;&#x65B9;&#x6CD5;&#x76F8;&#x6BD4;&#xFF0C;<code>CRUSH</code>&#x63D0;&#x4F9B;&#x4E86;&#x66F4;&#x597D;&#x7684;&#x6570;&#x636E;&#x7BA1;&#x7406;&#x673A;&#x5236;&#xFF0C;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x5927;&#x89C4;&#x6A21;&#x7684;&#x6570;&#x636E;&#x7BA1;&#x7406;&#x3002;
<code>CRUSH</code>&#x4F7F;&#x7528;&#x667A;&#x80FD;&#x6570;&#x636E;&#x590D;&#x5236;&#x6765;&#x786E;&#x4FDD;&#x5F39;&#x6027;&#xFF0C;&#x8FD9;&#x66F4;&#x9002;&#x5408;&#x4E8E;&#x8D85;&#x5927;&#x89C4;&#x6A21;&#x5B58;&#x50A8;&#x3002;</p>
<p> &#x96C6;&#x7FA4;&#x6620;&#x5C04;</p>
<p><code>Ceph</code>&#x4F9D;&#x8D56;&#x4E8E;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x548C;<code>ceph osd</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x4E86;&#x89E3;&#x96C6;&#x7FA4;&#x62D3;&#x6251;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x62EC;5&#x4E2A;&#x6620;&#x5C04;&#xFF0C;&#x7EDF;&#x79F0;&#x4E3A;&#x201C;&#x96C6;&#x7FA4;&#x6620;&#x5C04;&#x201D;&#xFF1A;</p>
<ul>
<li><code>Monitor</code>&#x6620;&#x5C04;: &#x5305;&#x542B;&#x96C6;&#x7FA4;<code>fsid</code>&#x3001;&#x6BCF;&#x4E2A;&#x76D1;&#x89C6;&#x5668;&#x7684;&#x4F4D;&#x7F6E;&#x3001;&#x540D;&#x79F0;&#x3001;&#x5730;&#x5740;&#x548C;&#x7AEF;&#x53E3;&#x3001;&#x6620;&#x5C04;&#x521B;&#x5EFA;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x4EE5;&#x53CA;&#x5B83;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#x3002;
&#x8981;&#x67E5;&#x770B;&#x76D1;&#x89C6;&#x5668;&#x6620;&#x5C04;&#xFF0C;&#x6267;&#x884C;<code>ceph mon dump</code>&#x3002;</li>
</ul>
<pre class="language-"><code>[root@ceph01 ~]# ceph mon dump
dumped monmap epoch 2
epoch 2
fsid b1c2511e-a1a5-4d6d-a4be-0e7f0d6d4294
last_changed 2021-02-22 14:36:08.199609
created 2021-02-22 14:27:26.357269
min_mon_release 14 (nautilus)
0: [v2:192.168.1.69:3300/0,v1:192.168.1.69:6789/0] mon.ceph01
1: [v2:192.168.1.70:3300/0,v1:192.168.1.70:6789/0] mon.ceph02
2: [v2:192.168.1.71:3300/0,v1:192.168.1.71:6789/0] mon.ceph03
</code></pre><ul>
<li><code>OSD&#x6620;&#x5C04;</code>:&#x5305;&#x542B;&#x96C6;&#x7FA4;&#x7684;<code>fsid</code>&#xFF0C;&#x6620;&#x5C04;&#x521B;&#x5EFA;&#x548C;&#x6700;&#x540E;&#x4FEE;&#x6539;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x6C60;&#x7684;&#x5217;&#x8868;&#xFF0C;&#x526F;&#x672C;&#x5927;&#x5C0F;&#xFF0C;<code>PG</code>&#x53F7;&#xFF0C;<code>OSD</code>&#x7684;&#x5217;&#x8868;&#x548C;&#x72B6;&#x6001;(&#x5982;up, in)&#x3002;
&#x6267;&#x884C;<code>ceph osd dump</code>&#x547D;&#x4EE4;&#xFF0C;&#x67E5;&#x770B;<code>OSD</code>&#x6620;&#x5C04;</li>
</ul>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd dump
epoch 1
fsid b1c2511e-a1a5-4d6d-a4be-0e7f0d6d4294
created 2021-02-22 14:27:48.482130
modified 2021-02-22 14:27:48.482130
flags sortbitwise,recovery_deletes,purged_snapdirs,pglog_hardlimit
crush_version 1
full_ratio 0.95
backfillfull_ratio 0.9
nearfull_ratio 0.85
require_min_compat_client jewel
min_compat_client jewel
require_OSD_release nautilus
max_OSD 0
</code></pre><ul>
<li><p><code>PG Map</code>&#xFF1A;&#x5305;&#x542B;<code>PG</code>&#x7248;&#x672C;&#x3001;&#x5B83;&#x7684;&#x65F6;&#x95F4;&#x6233;&#x3001;&#x6700;&#x540E;&#x4E00;&#x4E2A;<code>OSD Map epoch</code>&#x3001;&#x5B8C;&#x6574;&#x6BD4;&#x7387;&#xFF0C;&#x4EE5;&#x53CA;&#x6BCF;&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#x7684;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;&#xFF0C;&#x4F8B;&#x5982;<code>PG ID</code>&#x3001;<code>Up Set</code>&#x3001;<code>Acting Set</code>&#x3001;<code>PG</code>&#x7684;&#x72B6;&#x6001;&#xFF08;&#x4F8B;&#x5982;active+clean&#xFF09;&#xFF0C;&#x4EE5;&#x53CA;&#x6BCF;&#x4E2A;&#x6C60;&#x7684;&#x6570;&#x636E;&#x4F7F;&#x7528;&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;</p>
</li>
<li><p><code>CRUSH Map</code>:&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x5B58;&#x50A8;&#x8BBE;&#x5907;&#x5217;&#x8868;&#xFF0C;&#x6545;&#x969C;&#x57DF;&#x5C42;&#x6B21;&#x7ED3;&#x6784;(&#x4F8B;&#x5982;&#xFF0C;&#x8BBE;&#x5907;&#x3001;&#x4E3B;&#x673A;&#x3001;&#x673A;&#x67B6;&#x3001;&#x884C;&#x3001;&#x623F;&#x95F4;&#x7B49;)&#xFF0C;&#x4EE5;&#x53CA;&#x5B58;&#x50A8;&#x6570;&#x636E;&#x65F6;&#x904D;&#x5386;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#x7684;&#x89C4;&#x5219;&#x3002;&#x6267;&#x884C;<code>ceph osd getcrushmap -o {filename}</code>;&#x7136;&#x540E;&#xFF0C;&#x901A;&#x8FC7;&#x6267;&#x884C;<code>crushtool -d {comp-crushmap-filename} -o {decomp-crushmap-filename}</code>&#x6765;&#x53CD;&#x7F16;&#x8BD1;&#x5B83;&#x3002;
&#x4F7F;&#x7528;cat&#x67E5;&#x770B;&#x53CD;&#x7F16;&#x8BD1;&#x540E;&#x7684;&#x6620;&#x5C04;&#x3002;</p>
</li>
<li><p><code>MDS Map</code>:&#x5305;&#x542B;&#x5F53;&#x524D;<code>MDS Map</code>&#x7684;<code>epoch</code>&#x3001;<code>Map</code>&#x521B;&#x5EFA;&#x7684;&#x65F6;&#x95F4;&#x548C;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x4FEE;&#x6539;&#x7684;&#x65F6;&#x95F4;&#x3002;&#x5B83;&#x8FD8;&#x5305;&#x542B;&#x5B58;&#x50A8;&#x5143;&#x6570;&#x636E;&#x7684;&#x6C60;&#x3001;&#x5143;&#x6570;&#x636E;&#x670D;&#x52A1;&#x5668;&#x7684;&#x5217;&#x8868;&#xFF0C;&#x4EE5;&#x53CA;&#x54EA;&#x4E9B;&#x5143;&#x6570;&#x636E;&#x670D;&#x52A1;&#x5668;&#x5DF2;&#x7ECF;&#x542F;&#x52A8;&#x548C;&#x8FD0;&#x884C;.</p>
</li>
</ul>
<p>&#x6BCF;&#x4E2A;&#x6620;&#x5C04;&#x7EF4;&#x62A4;&#x5176;&#x64CD;&#x4F5C;&#x72B6;&#x6001;&#x66F4;&#x6539;&#x7684;&#x8FED;&#x4EE3;&#x5386;&#x53F2;&#x3002;<code>Ceph</code>&#x76D1;&#x89C6;&#x5668;&#x7EF4;&#x62A4;&#x96C6;&#x7FA4;&#x6620;&#x5C04;&#x7684;&#x4E3B;&#x526F;&#x672C;&#xFF0C;&#x5305;&#x62EC;&#x96C6;&#x7FA4;&#x6210;&#x5458;&#x3001;&#x72B6;&#x6001;&#x3001;&#x53D8;&#x66F4;&#x548C;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x7684;&#x603B;&#x4F53;&#x8FD0;&#x884C;&#x72B6;&#x51B5;</p>
<h3 id="mon&#x9AD8;&#x53EF;&#x7528;"><a name="mon&#x9AD8;&#x53EF;&#x7528;" class="anchor-navigation-ex-anchor" href="#mon&#x9AD8;&#x53EF;&#x7528;"><i class="fa fa-link" aria-hidden="true"></i></a><code>mon</code>&#x9AD8;&#x53EF;&#x7528;</h3>
<p>&#x5728;<code>Ceph</code>&#x5BA2;&#x6237;&#x673A;&#x80FD;&#x591F;&#x8BFB;&#x5199;&#x6570;&#x636E;&#x4E4B;&#x524D;&#xFF0C;&#x5B83;&#x4EEC;&#x5FC5;&#x987B;&#x8BBF;&#x95EE;<code>Ceph mon</code>&#x4EE5;&#x83B7;&#x53D6;&#x96C6;&#x7FA4;&#x6620;&#x5C04;&#x7684;&#x6700;&#x65B0;&#x526F;&#x672C;&#x3002;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5355;&#x4E2A;<code>mon</code>&#x8FDB;&#x884C;&#x64CD;&#x4F5C;;&#x7136;&#x800C;&#xFF0C;&#x8FD9;&#x5F15;&#x5165;&#x4E86;&#x5355;&#x70B9;&#x6545;&#x969C;(&#x5373;&#xFF0C;&#x5982;&#x679C;&#x76D1;&#x89C6;&#x5668;&#x51FA;&#x73B0;&#x6545;&#x969C;&#xFF0C;Ceph&#x5BA2;&#x6237;&#x673A;&#x5C31;&#x65E0;&#x6CD5;&#x8BFB;&#x5199;&#x6570;&#x636E;)&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x589E;&#x52A0;&#x53EF;&#x9760;&#x6027;&#x548C;&#x5BB9;&#x9519;&#x6027;&#xFF0C;<code>Ceph</code>&#x652F;&#x6301;<code>mon</code>&#x96C6;&#x7FA4;&#x3002;&#x5728;&#x4E00;&#x4E2A;&#x76D1;&#x89C6;&#x5668;&#x96C6;&#x7FA4;&#x4E2D;&#xFF0C;&#x5EF6;&#x8FDF;&#x548C;&#x5176;&#x4ED6;&#x6545;&#x969C;&#x53EF;&#x80FD;&#x5BFC;&#x81F4;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x76D1;&#x89C6;&#x5668;&#x843D;&#x540E;&#x4E8E;&#x96C6;&#x7FA4;&#x7684;&#x5F53;&#x524D;&#x72B6;&#x6001;&#x3002;&#x7531;&#x4E8E;&#x8FD9;&#x4E2A;&#x539F;&#x56E0;&#xFF0C;<code>Ceph</code>&#x5FC5;&#x987B;&#x5728;&#x5173;&#x4E8E;&#x96C6;&#x7FA4;&#x72B6;&#x6001;&#x7684;&#x5404;&#x4E2A;&#x76D1;&#x89C6;&#x5668;&#x5B9E;&#x4F8B;&#x4E4B;&#x95F4;&#x8FBE;&#x6210;&#x4E00;&#x81F4;&#x3002;<code>Ceph</code>&#x603B;&#x662F;&#x4F7F;&#x7528;&#x5927;&#x591A;&#x6570;&#x76D1;&#x89C6;&#x5668;(&#x4F8B;&#x5982;&#xFF0C;1&#x3001;2:3&#x3001;3:5&#x3001;4:6&#x7B49;)&#x548C;<code>Paxos</code>&#x7B97;&#x6CD5;&#x6765;&#x5728;&#x76D1;&#x89C6;&#x5668;&#x4E4B;&#x95F4;&#x5EFA;&#x7ACB;&#x5173;&#x4E8E;&#x96C6;&#x7FA4;&#x5F53;&#x524D;&#x72B6;&#x6001;&#x7684;&#x5171;&#x8BC6;</p>
<p><strong>&#x5373;&#x90E8;&#x7F72;&#x591A;&#x70B9;ceph mon &#x89C4;&#x907F;&#x5355;&#x70B9;&#x6545;&#x969C;</strong></p>
<h2 id="&#x8EAB;&#x4EFD;&#x8BA4;&#x8BC1;&#x9AD8;&#x53EF;&#x7528;&#x6027;"><a name="&#x8EAB;&#x4EFD;&#x8BA4;&#x8BC1;&#x9AD8;&#x53EF;&#x7528;&#x6027;" class="anchor-navigation-ex-anchor" href="#&#x8EAB;&#x4EFD;&#x8BA4;&#x8BC1;&#x9AD8;&#x53EF;&#x7528;&#x6027;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x8EAB;&#x4EFD;&#x8BA4;&#x8BC1;&#x9AD8;&#x53EF;&#x7528;&#x6027;</h2>
<p>&#x4E3A;&#x4E86;&#x8BC6;&#x522B;&#x7528;&#x6237;&#x5E76;&#x9632;&#x6B62;&#x4E2D;&#x95F4;&#x4EBA;&#x653B;&#x51FB;&#xFF0C;<code>Ceph</code>&#x63D0;&#x4F9B;&#x4E86;<code>cephx</code>&#x8EAB;&#x4EFD;&#x9A8C;&#x8BC1;&#x7CFB;&#x7EDF;&#x6765;&#x9A8C;&#x8BC1;&#x7528;&#x6237;&#x548C;&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x3002;&#xFF08;<code>cephx</code>&#x534F;&#x8BAE;&#x4E0D;&#x5904;&#x7406;&#x4F20;&#x8F93;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x52A0;&#x5BC6;(&#x4F8B;&#x5982;&#xFF0C;<code>SSL/TLS</code>)&#x6216;&#x9759;&#x6B62;&#x65F6;&#x7684;&#x52A0;&#x5BC6;&#x3002;&#xFF09;</p>
<p><code>Cephx</code>&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5BC6;&#x94A5;&#x8FDB;&#x884C;&#x8EAB;&#x4EFD;&#x9A8C;&#x8BC1;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5BA2;&#x6237;&#x7AEF;&#x548C;&#x76D1;&#x63A7;&#x96C6;&#x7FA4;&#x90FD;&#x62E5;&#x6709;&#x5BA2;&#x6237;&#x7AEF;&#x5BC6;&#x94A5;&#x7684;&#x526F;&#x672C;&#x3002;&#x8EAB;&#x4EFD;&#x9A8C;&#x8BC1;&#x534F;&#x8BAE;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF0C;&#x53CC;&#x65B9;&#x80FD;&#x591F;&#x5411;&#x5BF9;&#x65B9;&#x8BC1;&#x660E;&#x4ED6;&#x4EEC;&#x6709;&#x4E00;&#x4E2A;&#x5BC6;&#x94A5;&#x7684;&#x526F;&#x672C;&#xFF0C;&#x800C;&#x4E0D;&#x5B9E;&#x9645;&#x66B4;&#x9732;&#x5B83;&#x3002;&#x8FD9;&#x63D0;&#x4F9B;&#x4E86;&#x76F8;&#x4E92;&#x7684;&#x8EAB;&#x4EFD;&#x9A8C;&#x8BC1;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x96C6;&#x7FA4;&#x786E;&#x5B9A;&#x7528;&#x6237;&#x62E5;&#x6709;&#x5BC6;&#x94A5;&#xFF0C;&#x7528;&#x6237;&#x4E5F;&#x786E;&#x5B9A;&#x96C6;&#x7FA4;&#x62E5;&#x6709;&#x5BC6;&#x94A5;&#x7684;&#x526F;&#x672C;</p>
<p><code>Ceph</code>&#x7684;&#x4E00;&#x4E2A;&#x5173;&#x952E;&#x7684;&#x53EF;&#x4F38;&#x7F29;&#x6027;&#x7279;&#x6027;&#x662F;&#x907F;&#x514D;&#x5BF9;<code>Ceph</code>&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x7684;&#x96C6;&#x4E2D;&#x63A5;&#x53E3;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x5FC5;&#x987B;&#x80FD;&#x591F;&#x76F4;&#x63A5;&#x4E0E;<code>OSD</code>&#x4EA4;&#x4E92;&#x3002;&#x4E3A;&#x4E86;&#x4FDD;&#x62A4;&#x6570;&#x636E;&#xFF0C;<code>Ceph</code>&#x63D0;&#x4F9B;&#x4E86;&#x5176;<code>cephx</code>&#x8EAB;&#x4EFD;&#x9A8C;&#x8BC1;&#x7CFB;&#x7EDF;&#xFF0C;&#x8BE5;&#x7CFB;&#x7EDF;&#x5BF9;&#x64CD;&#x4F5C;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x7528;&#x6237;&#x8FDB;&#x884C;&#x8EAB;&#x4EFD;&#x9A8C;&#x8BC1;&#x3002;<code>cephx</code>&#x534F;&#x8BAE;&#x7684;&#x64CD;&#x4F5C;&#x65B9;&#x5F0F;&#x4E0E;<code>Kerberos</code>&#x7C7B;&#x4F3C;</p>
<p>&#x8981;&#x4F7F;&#x7528;<code>cephx</code>&#xFF0C;&#x7BA1;&#x7406;&#x5458;&#x5FC5;&#x987B;&#x9996;&#x5148;&#x8BBE;&#x7F6E;&#x7528;&#x6237;&#x3002;&#x5728;&#x4E0B;&#x9762;&#x7684;&#x56FE;&#x8868;&#x4E2D;<code>client.admin</code>&#x4ECE;&#x547D;&#x4EE4;&#x884C;&#x8C03;&#x7528;<code>ceph auth get-or-create-key</code>&#x6765;&#x751F;&#x6210;&#x7528;&#x6237;&#x540D;&#x548C;&#x5BC6;&#x94A5;&#x3002;
<code>Ceph</code>&#x7684;<code>auth</code>&#x5B50;&#x7CFB;&#x7EDF;&#x751F;&#x6210;&#x7528;&#x6237;&#x540D;&#x548C;&#x5BC6;&#x94A5;&#xFF0C;&#x5C06;&#x4E00;&#x4E2A;&#x526F;&#x672C;&#x5B58;&#x50A8;&#x5728;&#x76D1;&#x89C6;&#x5668;&#x4E2D;&#xFF0C;&#x5E76;&#x5C06;&#x7528;&#x6237;&#x7684;&#x5BC6;&#x94A5;&#x4F20;&#x8F93;&#x56DE;<code>client.admin</code>&#x3002;
&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5BA2;&#x6237;&#x7AEF;&#x548C;&#x76D1;&#x89C6;&#x5668;&#x5171;&#x4EAB;&#x4E00;&#x4E2A;&#x5BC6;&#x94A5;&#x6765;&#x4F7F;&#x7528;<code>cephx</code>.</p>
<p><img src="images/generateuser.png" alt=""></p>
<p>&#x4E3A;&#x4E86;&#x4F7F;&#x7528;&#x76D1;&#x89C6;&#x5668;&#x8FDB;&#x884C;&#x8EAB;&#x4EFD;&#x9A8C;&#x8BC1;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x5C06;&#x7528;&#x6237;&#x540D;&#x4F20;&#x9012;&#x7ED9;&#x76D1;&#x89C6;&#x5668;&#xFF0C;&#x76D1;&#x89C6;&#x5668;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x4F1A;&#x8BDD;&#x5BC6;&#x94A5;&#x5E76;&#x4F7F;&#x7528;&#x4E0E;&#x7528;&#x6237;&#x540D;&#x76F8;&#x5173;&#x8054;&#x7684;&#x5BC6;&#x94A5;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x52A0;&#x5BC6;&#x3002;
&#x7136;&#x540E;&#xFF0C;&#x76D1;&#x89C6;&#x5668;&#x5C06;&#x52A0;&#x5BC6;&#x7684;&#x7968;&#x636E;&#x4F20;&#x8F93;&#x56DE;&#x5BA2;&#x6237;&#x7AEF;&#x3002;&#x968F;&#x540E;&#xFF0C;&#x5BA2;&#x6237;&#x673A;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5BC6;&#x94A5;&#x89E3;&#x5BC6;&#xFF0C;&#x4EE5;&#x68C0;&#x7D22;&#x4F1A;&#x8BDD;&#x5BC6;&#x94A5;&#x3002;&#x4F1A;&#x8BDD;&#x5BC6;&#x94A5;&#x6807;&#x8BC6;&#x5F53;&#x524D;&#x4F1A;&#x8BDD;&#x7684;&#x7528;&#x6237;&#x3002;
&#x7136;&#x540E;&#x5BA2;&#x6237;&#x7AEF;&#x4F7F;&#x7528;&#x4F1A;&#x8BDD;&#x5BC6;&#x94A5;&#x7B7E;&#x540D;&#x7684;&#x7528;&#x6237;&#x8BF7;&#x6C42;&#x7968;&#x636E;&#x3002;&#x76D1;&#x89C6;&#x5668;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x7968;&#x636E;&#xFF0C;&#x7528;&#x7528;&#x6237;&#x7684;&#x5BC6;&#x94A5;&#x5BF9;&#x5176;&#x52A0;&#x5BC6;&#xFF0C;&#x5E76;&#x5C06;&#x5176;&#x4F20;&#x56DE;&#x5BA2;&#x6237;&#x673A;&#x3002;
&#x5BA2;&#x6237;&#x7AEF;&#x89E3;&#x5BC6;&#x7968;&#x636E;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;&#x5B83;&#x5BF9;&#x6574;&#x4E2A;&#x96C6;&#x7FA4;&#x4E2D;&#x7684;<code>OSDs</code>&#x548C;&#x5143;&#x6570;&#x636E;&#x670D;&#x52A1;&#x5668;&#x7684;&#x8BF7;&#x6C42;&#x8FDB;&#x884C;&#x7B7E;&#x540D;</p>
<p><img src="images/authenticate.png" alt=""></p>
<p><code>cephx</code>&#x534F;&#x8BAE;&#x5BF9;&#x5BA2;&#x6237;&#x7AEF;&#x673A;&#x5668;&#x548C;<code>Ceph</code>&#x670D;&#x52A1;&#x5668;&#x4E4B;&#x95F4;&#x7684;&#x901A;&#x4FE1;&#x8FDB;&#x884C;&#x8EAB;&#x4EFD;&#x9A8C;&#x8BC1;&#x3002;
&#x5728;&#x521D;&#x59CB;&#x8EAB;&#x4EFD;&#x9A8C;&#x8BC1;&#x4E4B;&#x540E;&#xFF0C;&#x5BA2;&#x6237;&#x673A;&#x548C;&#x670D;&#x52A1;&#x5668;&#x4E4B;&#x95F4;&#x53D1;&#x9001;&#x7684;&#x6BCF;&#x4E2A;&#x6D88;&#x606F;&#x90FD;&#x4F7F;&#x7528;&#x7968;&#x636E;&#x8FDB;&#x884C;&#x7B7E;&#x540D;&#xFF0C;
&#x76D1;&#x89C6;&#x5668;&#x3001;OSD&#x548C;&#x5143;&#x6570;&#x636E;&#x670D;&#x52A1;&#x5668;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5B83;&#x4EEC;&#x7684;&#x5171;&#x4EAB;&#x79D8;&#x5BC6;&#x6765;&#x9A8C;&#x8BC1;&#x8BE5;&#x7968;&#x636E;</p>
<p><img src="images/ticket.png" alt=""></p>
<p>&#x8FD9;&#x79CD;&#x8EAB;&#x4EFD;&#x9A8C;&#x8BC1;&#x63D0;&#x4F9B;&#x7684;&#x4FDD;&#x62A4;&#x5728;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x548C;<code>Ceph</code>&#x670D;&#x52A1;&#x5668;&#x4E3B;&#x673A;&#x4E4B;&#x95F4;&#x3002;&#x8EAB;&#x4EFD;&#x9A8C;&#x8BC1;&#x6CA1;&#x6709;&#x6269;&#x5C55;&#x5230;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x4E4B;&#x5916;&#x3002;
&#x5982;&#x679C;&#x7528;&#x6237;&#x4ECE;&#x8FDC;&#x7A0B;&#x4E3B;&#x673A;&#x8BBF;&#x95EE;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#xFF0C;<code>Ceph</code>&#x8EAB;&#x4EFD;&#x9A8C;&#x8BC1;&#x4E0D;&#x5E94;&#x7528;&#x4E8E;&#x7528;&#x6237;&#x7684;&#x4E3B;&#x673A;&#x548C;&#x5BA2;&#x6237;&#x7AEF;&#x4E3B;&#x673A;&#x4E4B;&#x95F4;&#x7684;&#x8FDE;&#x63A5;</p>
<h2 id="&#x52A8;&#x6001;&#x96C6;&#x7FA4;&#x7BA1;&#x7406;"><a name="&#x52A8;&#x6001;&#x96C6;&#x7FA4;&#x7BA1;&#x7406;" class="anchor-navigation-ex-anchor" href="#&#x52A8;&#x6001;&#x96C6;&#x7FA4;&#x7BA1;&#x7406;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x52A8;&#x6001;&#x96C6;&#x7FA4;&#x7BA1;&#x7406;</h2>
<p>&#x6BCF;&#x4E2A;&#x6C60;&#xFF08;pool&#xFF09;&#x90FD;&#x6709;&#x8BB8;&#x591A;&#x653E;&#x7F6E;&#x7EC4;&#xFF08;PG&#xFF09;&#xFF0C;<code>CRUSH</code>&#x52A8;&#x6001;&#x5730;&#x5C06;<code>PGs</code>&#x6620;&#x5C04;&#x5230;<code>OSDs</code>&#x3002;&#x5F53;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x5B58;&#x50A8;&#x5BF9;&#x8C61;&#x65F6;&#xFF0C;<code>CRUSH</code>&#x5C06;&#x6BCF;&#x4E2A;&#x5BF9;&#x8C61;&#x6620;&#x5C04;&#x5230;&#x653E;&#x7F6E;&#x7EC4;</p>
<p>&#x5C06;&#x5BF9;&#x8C61;&#x6620;&#x5C04;&#x5230;&#x653E;&#x7F6E;&#x7EC4;&#x5C06;&#x5728;<code>ceph osd</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x548C;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x4E4B;&#x95F4;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x95F4;&#x63A5;&#x5C42;&#x3002;
<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x5FC5;&#x987B;&#x80FD;&#x591F;&#x589E;&#x957F;(&#x6216;&#x6536;&#x7F29;)&#xFF0C;&#x5E76;&#x91CD;&#x65B0;&#x5E73;&#x8861;&#x52A8;&#x6001;&#x5B58;&#x50A8;&#x5BF9;&#x8C61;&#x7684;&#x4F4D;&#x7F6E;&#x3002;
&#x5982;&#x679C;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x201C;&#x77E5;&#x9053;&#x201D;&#x54EA;&#x4E2A;<code>ceph osd</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x6709;&#x54EA;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x90A3;&#x4E48;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x548C;<code>ceph osd</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x5C31;&#x4F1A;&#x4EA7;&#x751F;&#x4E00;&#x4E2A;&#x7D27;&#x5BC6;&#x8026;&#x5408;&#x3002;
&#x76F8;&#x53CD;&#xFF0C;<code>CRUSH</code>&#x7B97;&#x6CD5;&#x5C06;&#x6BCF;&#x4E2A;&#x5BF9;&#x8C61;&#x6620;&#x5C04;&#x5230;&#x4E00;&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x6BCF;&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#x6620;&#x5C04;&#x5230;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;<code>ceph osd</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x3002;
&#x8FD9;&#x4E00;&#x95F4;&#x63A5;&#x5C42;&#x5141;&#x8BB8;<code>Ceph</code>&#x5728;&#x65B0;&#x7684;<code>ceph osd</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x548C;&#x5E95;&#x5C42;<code>OSD</code>&#x8BBE;&#x5907;&#x4E0A;&#x7EBF;&#x65F6;&#x52A8;&#x6001;&#x91CD;&#x65B0;&#x5E73;&#x8861;&#x3002;&#x4E0B;&#x56FE;&#x63CF;&#x8FF0;&#x4E86;<code>CRUSH</code>&#x5982;&#x4F55;&#x5C06;&#x5BF9;&#x8C61;&#x6620;&#x5C04;&#x5230;&#x653E;&#x7F6E;&#x7EC4;&#xFF0C;&#x4EE5;&#x53CA;&#x5C06;&#x653E;&#x7F6E;&#x7EC4;&#x6620;&#x5C04;&#x5230;OSD&#x3002;</p>
<p><img src="images/obj-pg-OSD-.png" alt=""></p>
<p>&#x6709;&#x4E86;&#x96C6;&#x7FA4;&#x6620;&#x5C04;&#x7684;&#x526F;&#x672C;&#x548C;<code>CRUSH</code>&#x7B97;&#x6CD5;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x5C31;&#x53EF;&#x4EE5;&#x51C6;&#x786E;&#x5730;&#x8BA1;&#x7B97;&#x51FA;&#x5728;&#x8BFB;&#x5199;&#x7279;&#x5B9A;&#x5BF9;&#x8C61;&#x65F6;&#x5E94;&#x8BE5;&#x4F7F;&#x7528;&#x54EA;&#x4E2A;<code>OSD</code>&#x3002;</p>
<blockquote>
<p>&#x8BA1;&#x7B97;&#x653E;&#x7F6E;&#x7EC4;ID</p>
</blockquote>
<p>&#x5F53;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x7ED1;&#x5B9A;&#x5230;<code>Ceph mon</code>&#x65F6;&#xFF0C;&#x5B83;&#x5C06;&#x68C0;&#x7D22;&#x96C6;&#x7FA4;&#x6620;&#x5C04;&#x7684;&#x6700;&#x65B0;&#x526F;&#x672C;&#x3002;&#x901A;&#x8FC7;&#x96C6;&#x7FA4;&#x6620;&#x5C04;&#xFF0C;&#x5BA2;&#x6237;&#x83B7;&#x53D6;&#x96C6;&#x7FA4;&#x4E2D;&#x7684;&#x6240;&#x6709;<code>mon</code>&#x3001;<code>OSD</code>&#x548C;<code>mds</code>&#x4FE1;&#x606F;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5B83;&#x5BF9;&#x5BF9;&#x8C61;&#x4F4D;&#x7F6E;&#x4E00;&#x65E0;&#x6240;&#x77E5;&#x3002;</p>
<p><strong>&#x8BA1;&#x7B97;&#x8FC7;&#x7A0B;</strong></p>
<p>&#x3002;&#x8FD9;&#x5F88;&#x7B80;&#x5355;:<code>Ceph</code>&#x5C06;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x5728;&#x547D;&#x540D;&#x6C60;&#x4E2D;(&#x4F8B;&#x5982;&#xFF0C;&#x201C;liverpool&#x201D;)&#x3002;
&#x5F53;&#x5BA2;&#x6237;&#x7AEF;&#x60F3;&#x8981;&#x5B58;&#x50A8;&#x4E00;&#x4E2A;&#x547D;&#x540D;&#x5BF9;&#x8C61;(&#x4F8B;&#x5982;&#xFF0C;&#x201C;john&#x201D;&#x3001;&#x201C;paul&#x201D;&#x3001;&#x201C;george&#x201D;&#x3001;&#x201C;ringo&#x201D;&#x7B49;)&#x65F6;&#xFF0C;&#x5B83;&#x4F7F;&#x7528;&#x5BF9;&#x8C61;&#x540D;&#x3001;&#x54C8;&#x5E0C;&#x7801;&#x3001;&#x6C60;&#x4E2D;&#x7684;<code>PGs</code>&#x6570;&#x91CF;&#x548C;&#x6C60;&#x540D;&#x8BA1;&#x7B97;&#x653E;&#x7F6E;&#x7EC4;&#x3002;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x4F7F;&#x7528;&#x4EE5;&#x4E0B;&#x6B65;&#x9AA4;&#x8BA1;&#x7B97;<code>PG id</code>&#x3002;</p>
<ul>
<li><p>1&#x3001;&#x5BA2;&#x6237;&#x7AEF;&#x8F93;&#x5165;&#x5BF9;&#x8C61;<code>ID</code>&#x548C;<code>pool</code></p>
</li>
<li><p>2&#x3001;<code>Ceph</code>&#x83B7;&#x53D6;&#x5BF9;&#x8C61;<code>ID</code>&#x5E76;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x54C8;&#x5E0C;&#x8FD0;&#x7B97;</p>
</li>
<li><p>3&#x3001;<code>Ceph</code>&#x8BA1;&#x7B97;<code>pg</code>&#x6570;&#x7684;&#x54C8;&#x5E0C;&#x6A21;,&#xFF08;&#x4F8B;&#x5982;&#xFF0C;58&#xFF09;&#x83B7;&#x53D6;<code>PG ID</code></p>
</li>
<li><p>4&#x3001;<code>Ceph</code>&#x83B7;&#x53D6;&#x7ED9;&#x5B9A;&#x6C60;&#x540D;&#x7684;&#x6C60;<code>ID</code>&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x201C;liverpool&#x201D;=4&#xFF09;</p>
</li>
<li><p>5&#x3001;<code>Ceph</code>&#x5C06;&#x6C60;<code>ID</code>&#x524D;&#x7F6E;&#x5230;<code>PG ID</code>(&#x4F8B;&#x5982;&#xFF0C;4.58)&#x3002;</p>
</li>
</ul>
<blockquote>
<p>&#x91CD;&#x65B0;&#x5E73;&#x8861;</p>
</blockquote>
<p>&#x5F53;&#x4F60;&#x5C06;<code>ceph osd</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x6DFB;&#x52A0;&#x5230;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x65F6;&#xFF0C;&#x96C6;&#x7FA4;&#x6620;&#x5C04;&#x4F1A;&#x968F;&#x7740;&#x65B0;&#x7684;<code>OSD</code>&#x66F4;&#x65B0;&#x3002;&#x518D;&#x6B21;&#x8BA1;&#x7B97;<code>PG id</code>&#xFF0C;&#x8FD9;&#x5C06;&#x66F4;&#x6539;&#x96C6;&#x7FA4;&#x6620;&#x5C04;&#x3002;
&#x4E0B;&#x9762;&#x7684;&#x56FE;&#x63CF;&#x8FF0;&#x4E86;&#x91CD;&#x65B0;&#x5E73;&#x8861;&#x7684;&#x8FC7;&#x7A0B;(&#x867D;&#x7136;&#x5F88;&#x7C97;&#x7565;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x5927;&#x578B;&#x96C6;&#x7FA4;&#x4E2D;&#x5F71;&#x54CD;&#x66F4;&#x5C0F;)&#xFF0C;
&#x5176;&#x4E2D;&#x4E00;&#x4E9B;(&#x4F46;&#x4E0D;&#x662F;&#x6240;&#x6709;)<code>pg</code>&#x4ECE;&#x73B0;&#x6709;<code>OSD</code> (OSD 1&#x548C;OSD 2)&#x8FC1;&#x79FB;&#x5230;&#x65B0;&#x7684;OSD (OSD 3)&#x3002;&#x5373;&#x4F7F;&#x5728;&#x91CD;&#x65B0;&#x5E73;&#x8861;&#x65F6;&#xFF0C;&#x5D29;&#x6E83;&#x4E5F;&#x662F;&#x7A33;&#x5B9A;&#x7684;&#x3002;
&#x8BB8;&#x591A;&#x653E;&#x7F6E;&#x7EC4;&#x4FDD;&#x6301;&#x539F;&#x6765;&#x7684;&#x914D;&#x7F6E;&#xFF0C;&#x6BCF;&#x4E2A;<code>OSD</code>&#x589E;&#x52A0;&#x4E86;&#x4E00;&#x4E9B;&#x5BB9;&#x91CF;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x91CD;&#x65B0;&#x5E73;&#x8861;&#x5B8C;&#x6210;&#x540E;&#xFF0C;&#x65B0;<code>OSD</code>&#x4E0A;&#x4E0D;&#x4F1A;&#x51FA;&#x73B0;&#x8D1F;&#x8F7D;&#x5CF0;&#x503C;&#x3002;</p>
<p><img src="images/rebalancing.png" alt=""></p>
<blockquote>
<p>&#x6570;&#x636E;&#x4E00;&#x81F4;&#x6027;</p>
</blockquote>
<p>&#x4F5C;&#x4E3A;&#x7EF4;&#x62A4;&#x6570;&#x636E;&#x4E00;&#x81F4;&#x6027;&#x548C;&#x6E05;&#x6D01;&#x5EA6;&#x7684;&#x4E00;&#x90E8;&#x5206;&#xFF0C;<code>ceph osd</code>&#x8FD8;&#x53EF;&#x4EE5;&#x6E05;&#x7406;&#x653E;&#x7F6E;&#x7EC4;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#x3002;
&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;<code>ceph osd</code>&#x53EF;&#x4EE5;&#x5C06;&#x4E00;&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#x5143;&#x6570;&#x636E;&#x4E0E;&#x5176;&#x5B58;&#x50A8;&#x5728;&#x5176;&#x4ED6;<code>OSD</code>&#x4E2D;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x4E2D;&#x7684;&#x526F;&#x672C;&#x8FDB;&#x884C;&#x6BD4;&#x8F83;&#x3002;
&#x6E05;&#x7406;&#xFF08;&#x901A;&#x5E38;&#x6BCF;&#x5929;&#x6267;&#x884C;&#xFF09;&#x6355;&#x83B7;<code>OSD</code>&#x9519;&#x8BEF;&#x6216;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x9519;&#x8BEF;&#x3002;
<code>OSD</code>&#x8FD8;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x9010;&#x4F4D;&#x6BD4;&#x8F83;&#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x6765;&#x6267;&#x884C;&#x66F4;&#x6DF1;&#x5165;&#x7684;&#x6E05;&#x7406;&#x3002;&#x6DF1;&#x5EA6;&#x6E05;&#x7406;&#xFF08;&#x901A;&#x5E38;&#x6BCF;&#x5468;&#x6267;&#x884C;&#x4E00;&#x6B21;&#xFF09;&#x4F1A;&#x5728;&#x78C1;&#x76D8;&#x4E0A;&#x53D1;&#x73B0;&#x5728;&#x8F7B;&#x5EA6;&#x6E05;&#x7406;&#x65F6;&#x4E0D;&#x660E;&#x663E;&#x7684;&#x574F;&#x6247;&#x533A;&#x3002;</p>
<h2 id="&#x5206;&#x7EA7;&#x7F13;&#x5B58;"><a name="&#x5206;&#x7EA7;&#x7F13;&#x5B58;" class="anchor-navigation-ex-anchor" href="#&#x5206;&#x7EA7;&#x7F13;&#x5B58;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5206;&#x7EA7;&#x7F13;&#x5B58;</h2>
<p>&#x7F13;&#x5B58;&#x5C42;&#x4E3A;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x63D0;&#x4F9B;&#x4E86;&#x66F4;&#x597D;&#x7684;<code>I/O</code>&#x6027;&#x80FD;&#xFF0C;&#x7528;&#x4E8E;&#x5B58;&#x50A8;&#x5728;&#x5907;&#x4EFD;&#x5B58;&#x50A8;&#x5C42;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x5B50;&#x96C6;&#x3002;
&#x5206;&#x7EA7;&#x7F13;&#x5B58;&#x5305;&#x62EC;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x4F5C;&#x4E3A;&#x7F13;&#x5B58;&#x5C42;&#x7684;&#x76F8;&#x5BF9;&#x5FEB;&#x901F;/&#x6602;&#x8D35;&#x7684;&#x5B58;&#x50A8;&#x8BBE;&#x5907;(&#x4F8B;&#x5982;&#xFF0C;&#x56FA;&#x6001;&#x9A71;&#x52A8;&#x5668;)&#x6C60;&#xFF0C;&#x4EE5;&#x53CA;&#x4E00;&#x4E2A;&#x914D;&#x7F6E;&#x4E3A;&#x7EA0;&#x9519;&#x7801;&#x6216;&#x76F8;&#x5BF9;&#x8F83;&#x6162;/&#x4FBF;&#x5B9C;&#x7684;&#x8BBE;&#x5907;&#x4F5C;&#x4E3A;&#x7ECF;&#x6D4E;&#x5B58;&#x50A8;&#x5C42;&#x7684;&#x540E;&#x5907;&#x6C60;&#x3002;
<code>Ceph objecter</code>&#x5904;&#x7406;&#x653E;&#x7F6E;&#x5BF9;&#x8C61;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x800C;&#x5206;&#x5C42;&#x4EE3;&#x7406;&#x786E;&#x5B9A;&#x4F55;&#x65F6;&#x5C06;&#x5BF9;&#x8C61;&#x4ECE;&#x7F13;&#x5B58;&#x5237;&#x65B0;&#x5230;&#x540E;&#x5907;&#x5B58;&#x50A8;&#x5C42;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x7F13;&#x5B58;&#x5C42;&#x548C;&#x540E;&#x5907;&#x5B58;&#x50A8;&#x5C42;&#x5BF9;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x662F;&#x5B8C;&#x5168;&#x900F;&#x660E;&#x7684;</p>
<p><img src="images/cache-tiering.png" alt=""></p>
<h2 id="ceph&#x534F;&#x8BAE;"><a name="ceph&#x534F;&#x8BAE;" class="anchor-navigation-ex-anchor" href="#ceph&#x534F;&#x8BAE;"><i class="fa fa-link" aria-hidden="true"></i></a>Ceph&#x534F;&#x8BAE;</h2>
<p><code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x4F7F;&#x7528;&#x539F;&#x751F;&#x534F;&#x8BAE;&#x4E0E;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x8FDB;&#x884C;&#x4EA4;&#x4E92;&#xFF0C;<code>Ceph</code>&#x5C06;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x6253;&#x5305;&#x5230;<code>librados</code>&#x5E93;&#x4E2D;&#x3002;
&#x4E0B;&#x56FE;&#x63CF;&#x8FF0;&#x4E86;&#x57FA;&#x672C;&#x67B6;&#x6784;&#xFF1A;</p>
<p><img src="images/ceph-protocol.png" alt=""></p>
<h3 id="ceph&#x534F;&#x8BAE;&#x4E0E;librados"><a name="ceph&#x534F;&#x8BAE;&#x4E0E;librados" class="anchor-navigation-ex-anchor" href="#ceph&#x534F;&#x8BAE;&#x4E0E;librados"><i class="fa fa-link" aria-hidden="true"></i></a><code>Ceph</code>&#x534F;&#x8BAE;&#x4E0E;<code>librados</code></h3>
<p>&#x73B0;&#x4EE3;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x5177;&#x6709;&#x5F02;&#x6B65;&#x901A;&#x4FE1;&#x529F;&#x80FD;&#x7684;&#x7B80;&#x5355;&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x63A5;&#x53E3;&#x3002;
<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x5177;&#x6709;&#x5F02;&#x6B65;&#x901A;&#x4FE1;&#x80FD;&#x529B;&#x7684;&#x7B80;&#x5355;&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x63A5;&#x53E3;&#x3002;
&#x8BE5;&#x63A5;&#x53E3;&#x63D0;&#x4F9B;&#x4E86;&#x5BF9;&#x6574;&#x4E2A;&#x96C6;&#x7FA4;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x76F4;&#x63A5;&#x3001;&#x5E76;&#x884C;&#x8BBF;&#x95EE;&#x3002;&#x5982;&#xFF1A;</p>
<ul>
<li>&#x6C60;&#x64CD;&#x4F5C;</li>
<li>&#x5FEB;&#x7167;&#x548C;&#x5199;&#x65F6;&#x590D;&#x5236;&#x514B;&#x9686;</li>
<li>&#x8BFB;/&#x5199;&#x5BF9;&#x8C61;-&#x521B;&#x5EFA;&#x6216;&#x5220;&#x9664;-&#x6574;&#x4E2A;&#x5BF9;&#x8C61;&#x6216;&#x5B57;&#x8282;&#x8303;&#x56F4;-&#x8FFD;&#x52A0;&#x6216;&#x622A;&#x65AD;</li>
<li>&#x521B;&#x5EFA;/&#x8BBE;&#x7F6E;/&#x83B7;&#x53D6;/&#x5220;&#x9664;<code>XATTRs</code></li>
<li>&#x521B;&#x5EFA;/&#x8BBE;&#x7F6E;/&#x83B7;&#x53D6;/&#x5220;&#x9664;&#x952E;&#x503C;&#x5BF9;</li>
<li>&#x590D;&#x5408;&#x8FD0;&#x7B97;&#x4E0E;&#x53CC;ack&#x8BED;&#x4E49;</li>
<li>&#x5BF9;&#x8C61;&#x7C7B;</li>
</ul>
<h3 id="&#x5BF9;&#x8C61;&#x89C2;&#x6D4B;&#x901A;&#x77E5;"><a name="&#x5BF9;&#x8C61;&#x89C2;&#x6D4B;&#x901A;&#x77E5;" class="anchor-navigation-ex-anchor" href="#&#x5BF9;&#x8C61;&#x89C2;&#x6D4B;&#x901A;&#x77E5;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5BF9;&#x8C61;&#x89C2;&#x6D4B;&#x901A;&#x77E5;</h3>
<p>&#x5BA2;&#x6237;&#x7AEF;&#x53EF;&#x4EE5;&#x6301;&#x4E45;&#x6027;&#x89C2;&#x6D4B;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x4FDD;&#x6301;&#x4E0E;&#x4E3B;<code>OSD</code>&#x7684;&#x4F1A;&#x8BDD;&#x5904;&#x4E8E;&#x6253;&#x5F00;&#x72B6;&#x6001;&#x3002;
&#x5BA2;&#x6237;&#x7AEF;&#x53EF;&#x4EE5;&#x5411;&#x6240;&#x6709;&#x89C2;&#x5BDF;&#x8005;&#x53D1;&#x9001;&#x901A;&#x77E5;&#x6D88;&#x606F;&#x548C;&#x6709;&#x6548;&#x8D1F;&#x8F7D;&#xFF0C;&#x5E76;&#x5728;&#x89C2;&#x5BDF;&#x8005;&#x6536;&#x5230;&#x901A;&#x77E5;&#x65F6;&#x63A5;&#x6536;&#x901A;&#x77E5;&#x3002;
&#x8FD9;&#x4F7F;&#x5BA2;&#x6237;&#x7AEF;&#x80FD;&#x591F;&#x5C06;&#x4EFB;&#x4F55;&#x5BF9;&#x8C61;&#x7528;&#x4F5C;&#x540C;&#x6B65;/&#x901A;&#x4FE1;&#x901A;&#x9053;</p>
<p><img src="images/object-watch.png" alt=""></p>
<h2 id="&#x6570;&#x636E;&#x5206;&#x6BB5;"><a name="&#x6570;&#x636E;&#x5206;&#x6BB5;" class="anchor-navigation-ex-anchor" href="#&#x6570;&#x636E;&#x5206;&#x6BB5;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6570;&#x636E;&#x5206;&#x6BB5;</h2>
<p>&#x5B58;&#x50A8;&#x8BBE;&#x5907;&#x6709;&#x541E;&#x5410;&#x91CF;&#x9650;&#x5236;&#xFF0C;&#x8FD9;&#x4F1A;&#x5F71;&#x54CD;&#x6027;&#x80FD;&#x548C;&#x53EF;&#x4F38;&#x7F29;&#x6027;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5B58;&#x50A8;&#x7CFB;&#x7EDF;&#x901A;&#x5E38;&#x652F;&#x6301;&#x8DE8;&#x591A;&#x4E2A;&#x5B58;&#x50A8;&#x8BBE;&#x5907;&#x5206;&#x6BB5;&#x5B58;&#x50A8;&#x987A;&#x5E8F;&#x4FE1;&#x606F;&#xFF0C;&#x4EE5;&#x63D0;&#x9AD8;&#x541E;&#x5410;&#x91CF;&#x548C;&#x6027;&#x80FD;&#x3002;
<code>RAID</code>&#x662F;&#x6700;&#x5E38;&#x89C1;&#x7684;&#x6570;&#x636E;&#x5206;&#x6761;&#x5F62;&#x5F0F;&#x3002;&#x4E0E;<code>Ceph</code>&#x7684;&#x6761;&#x5E26;&#x5316;&#x6700;&#x76F8;&#x4F3C;&#x7684;<code>RAID</code>&#x7C7B;&#x578B;&#x662F;<code>raid0</code>&#xFF0C;&#x6216;&#x201C;&#x6761;&#x5E26;&#x5377;&#x201D;&#x3002;<code>Ceph</code>&#x7684;&#x5206;&#x6761;&#x63D0;&#x4F9B;&#x4E86;<code>RAID 0</code>&#x5206;&#x6761;&#x7684;&#x541E;&#x5410;&#x91CF;&#xFF0C;<code>n-way RAID</code>&#x955C;&#x50CF;&#x7684;&#x53EF;&#x9760;&#x6027;&#x548C;&#x66F4;&#x5FEB;&#x7684;&#x6062;&#x590D;&#x3002;</p>
<p><code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x4E2D;<code>Ceph</code>&#x5B58;&#x50A8;&#x7684;&#x5BF9;&#x8C61;&#x6CA1;&#x6709;&#x6761;&#x5E26;&#x5316;&#x3002;<code>Ceph</code>&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x3001;<code>Ceph</code>&#x5757;&#x8BBE;&#x5907;&#x548C;<code>Ceph</code>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x5728;&#x591A;&#x4E2A;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x5BF9;&#x8C61;&#x4E0A;&#x6761;&#x5E26;&#x5316;&#x5B83;&#x4EEC;&#x7684;&#x6570;&#x636E;&#x3002;
&#x901A;&#x8FC7;<code>librados</code>&#x76F4;&#x63A5;&#x5199;&#x5165;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x7684;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x5FC5;&#x987B;&#x4E3A;&#x81EA;&#x5DF1;&#x6267;&#x884C;&#x6761;&#x5E26;&#x5316;&#xFF08;&#x548C;&#x5E76;&#x884C;I/O&#xFF09;&#x4EE5;&#x83B7;&#x5F97;&#x8FD9;&#x4E9B;&#x597D;&#x5904;&#x3002;</p>
<p>&#x6700;&#x7B80;&#x5355;&#x7684;<code>Ceph</code>&#x6761;&#x5E26;&#x683C;&#x5F0F;&#x6D89;&#x53CA;1&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x6761;&#x5E26;&#x8BA1;&#x6570;&#x3002;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x5C06;&#x6761;&#x5E26;&#x5355;&#x5143;&#x5199;&#x5165;<code>Ceph</code>&#x5B58;&#x50A8;&#x7FA4;&#x96C6;&#x5BF9;&#x8C61;&#xFF0C;&#x76F4;&#x5230;&#x8BE5;&#x5BF9;&#x8C61;&#x8FBE;&#x5230;&#x6700;&#x5927;&#x5BB9;&#x91CF;&#xFF0C;&#x7136;&#x540E;&#x4E3A;&#x989D;&#x5916;&#x7684;&#x6570;&#x636E;&#x6761;&#x5E26;&#x521B;&#x5EFA;&#x53E6;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x3002;
&#x6700;&#x7B80;&#x5355;&#x7684;&#x6761;&#x5E26;&#x5316;&#x5F62;&#x5F0F;&#x5BF9;&#x4E8E;&#x5C0F;&#x5757;&#x8BBE;&#x5907;&#x56FE;&#x50CF;&#x3001;<code>S3</code>&#x6216;<code>Swift</code>&#x5BF9;&#x8C61;&#x548C;<code>cepfs</code>&#x6587;&#x4EF6;&#x5C31;&#x8DB3;&#x591F;&#x4E86;&#x3002;
&#x7136;&#x800C;&#xFF0C;&#x8FD9;&#x79CD;&#x7B80;&#x5355;&#x7684;&#x5F62;&#x5F0F;&#x5E76;&#x6CA1;&#x6709;&#x6700;&#x5927;&#x9650;&#x5EA6;&#x5730;&#x5229;&#x7528;<code>Ceph</code>&#x5728;&#x653E;&#x7F6E;&#x7EC4;&#x4E4B;&#x95F4;&#x5206;&#x53D1;&#x6570;&#x636E;&#x7684;&#x80FD;&#x529B;&#xFF0C;&#x56E0;&#x6B64;&#x5E76;&#x6CA1;&#x6709;&#x6781;&#x5927;&#x5730;&#x63D0;&#x9AD8;&#x6027;&#x80FD;&#x3002;&#x4E0B;&#x56FE;&#x63CF;&#x8FF0;&#x4E86;&#x6761;&#x5E26;&#x5316;&#x7684;&#x6700;&#x7B80;&#x5355;&#x5F62;&#x5F0F;&#xFF1A;</p>
<p><img src="images/striping.png" alt=""></p>
<p>&#x5982;&#x679C;&#x9884;&#x671F;&#x4F1A;&#x6709;&#x8F83;&#x5927;&#x7684;&#x955C;&#x50CF;&#x3001;&#x8F83;&#x5927;&#x7684;<code>S3</code>&#x6216;<code>Swift</code>&#x5BF9;&#x8C61;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x89C6;&#x9891;&#xFF09;&#x6216;&#x8F83;&#x5927;&#x7684;<code>cepfs</code>&#x76EE;&#x5F55;&#xFF0C;&#x90A3;&#x4E48;&#x901A;&#x8FC7;&#x5728;&#x5BF9;&#x8C61;&#x96C6;&#x4E2D;&#x7684;&#x591A;&#x4E2A;&#x5BF9;&#x8C61;&#x4E0A;&#x5BF9;&#x5BA2;&#x6237;&#x7AEF;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x6761;&#x5E26;&#x5316;&#xFF0C;&#x4F1A;&#x6709;&#x76F8;&#x5F53;&#x5927;&#x7684;&#x8BFB;/&#x5199;&#x6027;&#x80FD;&#x6539;&#x8FDB;&#x3002;
&#x5F53;&#x5BA2;&#x6237;&#x7AEF;&#x5E76;&#x884C;&#x5730;&#x5C06;&#x6761;&#x5E26;&#x5355;&#x5143;&#x5199;&#x5165;&#x76F8;&#x5E94;&#x7684;&#x5BF9;&#x8C61;&#x65F6;&#xFF0C;&#x4F1A;&#x663E;&#x8457;&#x63D0;&#x5347;&#x5199;&#x5165;&#x6027;&#x80FD;&#x3002;&#x7531;&#x4E8E;&#x5BF9;&#x8C61;&#x88AB;&#x6620;&#x5C04;&#x5230;&#x4E0D;&#x540C;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x5E76;&#x8FDB;&#x4E00;&#x6B65;&#x6620;&#x5C04;&#x5230;&#x4E0D;&#x540C;&#x7684;<code>OSD</code>&#xFF0C;&#x56E0;&#x6B64;&#x6BCF;&#x6B21;&#x5199;&#x5165;&#x90FD;&#x4EE5;&#x6700;&#x5927;&#x7684;&#x5199;&#x5165;&#x901F;&#x5EA6;&#x5E76;&#x884C;&#x8FDB;&#x884C;&#x3002;
&#x5BF9;&#x5355;&#x4E2A;&#x78C1;&#x76D8;&#x7684;&#x5199;&#x5165;&#x5C06;&#x53D7;&#x5230;&#x78C1;&#x5934;&#x79FB;&#x52A8;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x6BCF;&#x6B21;&#x5BFB;&#x9053;6ms&#xFF09;&#x548C;&#x8BE5;&#x8BBE;&#x5907;&#x5E26;&#x5BBD;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;100MB/s&#xFF09;&#x7684;&#x9650;&#x5236;&#x3002;
&#x901A;&#x8FC7;&#x5C06;&#x5199;&#x64CD;&#x4F5C;&#x6269;&#x5C55;&#x5230;&#x591A;&#x4E2A;&#x5BF9;&#x8C61;&#xFF08;&#x6620;&#x5C04;&#x5230;&#x4E0D;&#x540C;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x548C;OSD&#xFF09;&#xFF0C;<code>Ceph</code>&#x53EF;&#x4EE5;&#x51CF;&#x5C11;&#x6BCF;&#x4E2A;&#x9A71;&#x52A8;&#x5668;&#x7684;&#x5BFB;&#x9053;&#x6B21;&#x6570;&#xFF0C;&#x5E76;&#x7ED3;&#x5408;&#x591A;&#x4E2A;&#x9A71;&#x52A8;&#x5668;&#x7684;&#x541E;&#x5410;&#x91CF;&#xFF0C;&#x4EE5;&#x5B9E;&#x73B0;&#x66F4;&#x5FEB;&#x7684;&#x5199;&#xFF08;&#x6216;&#x8BFB;&#xFF09;&#x901F;&#x5EA6;&#x3002;</p>
<p>&#x5728;&#x4E0B;&#x9762;&#x7684;&#x56FE;&#x4E2D;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x6570;&#x636E;&#x5728;&#x7531;4&#x4E2A;&#x5BF9;&#x8C61;&#x7EC4;&#x6210;&#x7684;&#x5BF9;&#x8C61;&#x96C6;(&#x4E0B;&#x56FE;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#x96C6;1)&#x4E0A;&#x8FDB;&#x884C;&#x5206;&#x6761;&#xFF0C;
&#x5176;&#x4E2D;&#x7B2C;&#x4E00;&#x4E2A;&#x5206;&#x6761;&#x5355;&#x5143;&#x662F;&#x5BF9;&#x8C61;0&#x4E2D;&#x7684;&#x5206;&#x6761;&#x5355;&#x5143;0&#xFF0C;&#x7B2C;&#x56DB;&#x4E2A;&#x5206;&#x6761;&#x5355;&#x5143;&#x662F;&#x5BF9;&#x8C61;3&#x4E2D;&#x7684;&#x5206;&#x6761;&#x5355;&#x5143;3&#x3002;
&#x5199;&#x5165;&#x7B2C;&#x56DB;&#x4E2A;&#x5206;&#x6761;&#x540E;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x786E;&#x5B9A;&#x5BF9;&#x8C61;&#x96C6;&#x662F;&#x5426;&#x5DF2;&#x6EE1;&#x3002;
&#x5982;&#x679C;&#x5BF9;&#x8C61;&#x96C6;&#x672A;&#x6EE1;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x5C06;&#x5F00;&#x59CB;&#x518D;&#x6B21;&#x5411;&#x7B2C;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;(&#x4E0B;&#x56FE;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;0)&#x5199;&#x5165;&#x6761;&#x5E26;&#x3002;
&#x5982;&#x679C;&#x5BF9;&#x8C61;&#x96C6;&#x5DF2;&#x6EE1;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x5C06;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5BF9;&#x8C61;&#x96C6;(&#x4E0B;&#x56FE;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#x96C6;2)&#xFF0C;
&#x5E76;&#x5F00;&#x59CB;&#x5199;&#x5165;&#x65B0;&#x5BF9;&#x8C61;&#x96C6;(&#x4E0B;&#x56FE;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;4)&#x4E2D;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x6761;&#x5E26;(&#x6761;&#x5E26;&#x5355;&#x5143;16)&#x3002;</p>
<p><img src="images/multi-strping.png" alt=""></p>
<p>&#x51B3;&#x5B9A;<code>Ceph</code>&#x6761;&#x5E26;&#x5316;&#x6570;&#x636E;&#x7684;&#x65B9;&#x5F0F;&#x7684;&#x4E09;&#x4E2A;&#x91CD;&#x8981;&#x53D8;&#x91CF;:</p>
<ul>
<li>&#x5BF9;&#x8C61;&#x5927;&#x5C0F;&#xFF1A;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#x5177;&#x6709;&#x6700;&#x5927;&#x53EF;&#x914D;&#x7F6E;&#x5927;&#x5C0F;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;2MB&#x3001;4MB&#x7B49;&#xFF09;&#x3002;&#x5BF9;&#x8C61;&#x5927;&#x5C0F;&#x5E94;&#x8BE5;&#x8DB3;&#x591F;&#x5927;&#x4EE5;&#x5BB9;&#x7EB3;&#x591A;&#x4E2A;&#x6761;&#x5E26;&#x5355;&#x4F4D;&#xFF0C;&#x5E76;&#x4E14;&#x5E94;&#x8BE5;&#x662F;&#x6761;&#x5E26;&#x5355;&#x4F4D;&#x7684;&#x500D;&#x6570;</li>
<li>&#x6761;&#x5E26;&#x5BBD;&#x5EA6;&#xFF1A;&#x6761;&#x5E26;&#x5177;&#x6709;&#x53EF;&#x914D;&#x7F6E;&#x7684;&#x5355;&#x5143;&#x5927;&#x5C0F;&#xFF08;&#x4F8B;&#x5982;64kb&#xFF09;&#x3002;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x5C06;&#x8981;&#x5199;&#x5165;&#x5BF9;&#x8C61;&#x7684;&#x6570;&#x636E;&#x5212;&#x5206;&#x4E3A;&#x5927;&#x5C0F;&#x76F8;&#x7B49;&#x7684;&#x6761;&#x5E26;&#x5355;&#x5143;&#xFF0C;&#x4F46;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x6761;&#x5E26;&#x5355;&#x5143;&#x9664;&#x5916;&#x3002;&#x6761;&#x5E26;&#x5BBD;&#x5EA6;&#x5E94;&#x8BE5;&#x662F;&#x5BF9;&#x8C61;&#x5927;&#x5C0F;&#x7684;&#x4E00;&#x5C0F;&#x90E8;&#x5206;&#xFF0C;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x53EF;&#x4EE5;&#x5305;&#x542B;&#x8BB8;&#x591A;&#x6761;&#x7EB9;&#x5355;&#x4F4D;&#x3002;</li>
<li>&#x6761;&#x5E26;&#x8BA1;&#x6570;&#xFF1A;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x5728;&#x7531;&#x6761;&#x5E26;&#x8BA1;&#x6570;&#x786E;&#x5B9A;&#x7684;&#x4E00;&#x7CFB;&#x5217;&#x5BF9;&#x8C61;&#x4E0A;&#x5199;&#x5165;&#x6761;&#x5E26;&#x5355;&#x5143;&#x5E8F;&#x5217;&#x3002;&#x8FD9;&#x4E00;&#x7CFB;&#x5217;&#x5BF9;&#x8C61;&#x88AB;&#x79F0;&#x4E3A;&#x5BF9;&#x8C61;&#x96C6;&#x3002;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x5199;&#x5165;&#x5BF9;&#x8C61;&#x96C6;&#x4E2D;&#x7684;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x540E;&#xFF0C;&#x5B83;&#x8FD4;&#x56DE;&#x5230;&#x5BF9;&#x8C61;&#x96C6;&#x4E2D;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;</li>
</ul>
<p>&#x4E00;&#x65E6;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x5C06;&#x6570;&#x636E;&#x5206;&#x6761;&#x5230;&#x6761;&#x5E26;&#x5355;&#x5143;&#x5E76;&#x5C06;&#x6761;&#x5E26;&#x5355;&#x5143;&#x6620;&#x5C04;&#x5230;&#x5BF9;&#x8C61;&#xFF0C;<code>Ceph</code>&#x7684;<code>CRUSH</code>&#x7B97;&#x6CD5;&#x5C06;&#x5BF9;&#x8C61;&#x6620;&#x5C04;&#x5230;&#x653E;&#x7F6E;&#x7EC4;&#xFF0C;&#x5E76;&#x5C06;&#x653E;&#x7F6E;&#x7EC4;&#x6620;&#x5C04;&#x5230;<code>ceph osd</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x5BF9;&#x8C61;&#x4F5C;&#x4E3A;&#x6587;&#x4EF6;&#x5B58;&#x50A8;&#x5728;&#x5B58;&#x50A8;&#x78C1;&#x76D8;&#x4E0A;</p>
<h1 id="ceph&#x5B58;&#x50A8;&#x7C7B;&#x578B;"><a name="ceph&#x5B58;&#x50A8;&#x7C7B;&#x578B;" class="anchor-navigation-ex-anchor" href="#ceph&#x5B58;&#x50A8;&#x7C7B;&#x578B;"><i class="fa fa-link" aria-hidden="true"></i></a>Ceph&#x5B58;&#x50A8;&#x7C7B;&#x578B;</h1>
<p><code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x5305;&#x62EC;&#x8BB8;&#x591A;&#x670D;&#x52A1;&#x63A5;&#x53E3;:</p>
<ul>
<li><p>&#x5757;&#x8BBE;&#x5907;&#xFF1A;<code>Ceph</code>&#x5757;&#x8BBE;&#x5907;(&#x53C8;&#x79F0;RBD)&#x670D;&#x52A1;&#x63D0;&#x4F9B;&#x53EF;&#x8C03;&#x6574;&#x5927;&#x5C0F;&#x3001;&#x7CBE;&#x7B80;&#x914D;&#x7F6E;&#x7684;&#x5757;&#x8BBE;&#x5907;&#xFF0C;&#x5E76;&#x63D0;&#x4F9B;&#x5FEB;&#x7167;&#x548C;&#x514B;&#x9686;&#x3002;<code>Ceph</code>&#x8DE8;&#x96C6;&#x7FA4;&#x5212;&#x5206;&#x5757;&#x8BBE;&#x5907;&#x4EE5;&#x83B7;&#x5F97;&#x9AD8;&#x6027;&#x80FD;&#x3002;<code>Ceph</code>&#x65E2;&#x652F;&#x6301;&#x5185;&#x6838;&#x5BF9;&#x8C61;(KO)&#xFF0C;&#x4E5F;&#x652F;&#x6301;&#x76F4;&#x63A5;&#x4F7F;&#x7528;<code>librbd</code>&#x7684;<code>QEMU</code>&#x7BA1;&#x7406;&#x7A0B;&#x5E8F;&#x2014;&#x2014;&#x907F;&#x514D;&#x4E86;&#x865A;&#x62DF;&#x5316;&#x7CFB;&#x7EDF;&#x7684;&#x5185;&#x6838;&#x5BF9;&#x8C61;&#x5F00;&#x9500;</p>
</li>
<li><p>&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#xFF1A;<code>Ceph</code>&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x670D;&#x52A1;(&#x7B80;&#x79F0;RGW)&#x63D0;&#x4F9B;<code>RESTful api</code>&#xFF0C;&#x517C;&#x5BB9;<code>Amazon S3</code>&#x548C;<code>OpenStack Swift</code>&#x63A5;&#x53E3;</p>
</li>
<li><p>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF1A;<code>Ceph</code>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;(cepphfs)&#x670D;&#x52A1;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x517C;&#x5BB9;<code>POSIX</code>&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x53EF;&#x4EE5;&#x6302;&#x8F7D;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;(FUSE)&#x4F7F;&#x7528;&#x3002;</p>
</li>
</ul>
<p><img src="images/artitecture.png" alt=""></p>
<h2 id="ceph&#x5757;&#x5B58;&#x50A8;"><a name="ceph&#x5757;&#x5B58;&#x50A8;" class="anchor-navigation-ex-anchor" href="#ceph&#x5757;&#x5B58;&#x50A8;"><i class="fa fa-link" aria-hidden="true"></i></a>Ceph&#x5757;&#x5B58;&#x50A8;</h2>
<p>&#x5757;&#x662F;&#x5B57;&#x8282;&#x5E8F;&#x5217;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;512&#x5B57;&#x8282;&#x7684;&#x6570;&#x636E;&#x5757;&#xFF09;&#x3002;&#x57FA;&#x4E8E;&#x5757;&#x7684;&#x5B58;&#x50A8;&#x63A5;&#x53E3;&#x662F;&#x4F7F;&#x7528;&#x65CB;&#x8F6C;&#x4ECB;&#x8D28;&#xFF08;&#x5982;&#x786C;&#x76D8;&#x3001;CD&#x3001;&#x8F6F;&#x76D8;&#xFF0C;&#x751A;&#x81F3;&#x4F20;&#x7EDF;&#x7684;9&#x78C1;&#x9053;&#x78C1;&#x5E26;&#xFF09;&#x5B58;&#x50A8;&#x6570;&#x636E;&#x7684;&#x6700;&#x5E38;&#x7528;&#x65B9;&#x6CD5;&#x3002;
&#x5757;&#x8BBE;&#x5907;&#x63A5;&#x53E3;&#x7684;&#x666E;&#x904D;&#x6027;&#x4F7F;&#x5F97;&#x865A;&#x62DF;&#x5757;&#x8BBE;&#x5907;&#x6210;&#x4E3A;&#x4E0E;<code>Ceph</code>&#x8FD9;&#x6837;&#x7684;&#x6D77;&#x91CF;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x7CFB;&#x7EDF;&#x4EA4;&#x4E92;&#x7684;&#x7406;&#x60F3;&#x5019;&#x9009;&#x8BBE;&#x5907;</p>
<p><code>Ceph</code>&#x5757;&#x8BBE;&#x5907;&#x662F;&#x7CBE;&#x7B80;&#x914D;&#x7F6E;&#x7684;&#xFF0C;&#x53EF;&#x8C03;&#x6574;&#x5927;&#x5C0F;&#xFF0C;&#x5E76;&#x5728;<code>Ceph</code>&#x96C6;&#x7FA4;&#x4E2D;&#x7684;&#x591A;&#x4E2A;<code>OSD</code>&#x4E0A;&#x5B58;&#x50A8;&#x6570;&#x636E;&#x6761;&#x5E26;&#x5316;&#x3002;
<code>Ceph</code>&#x5757;&#x8BBE;&#x5907;&#x5229;&#x7528;<code>RADOS</code>&#x529F;&#x80FD;&#xFF0C;&#x5982;&#x5FEB;&#x7167;&#x3001;&#x590D;&#x5236;&#x548C;&#x4E00;&#x81F4;&#x6027;&#x3002;
<code>Ceph</code>&#x7684;<code>RADOS</code>&#x5757;&#x8BBE;&#x5907;&#xFF08;RBD&#xFF09;&#x4F7F;&#x7528;&#x5185;&#x6838;&#x6A21;&#x5757;&#x6216;<code>librbd</code>&#x5E93;&#x4E0E;<code>OSD</code>&#x4EA4;&#x4E92;</p>
<p><img src="images/rbd-artitechture.png" alt=""></p>
<p><code>Ceph</code>&#x7684;<code>block</code>&#x8BBE;&#x5907;&#x4EE5;&#x65E0;&#x9650;&#x7684;&#x53EF;&#x6269;&#x5C55;&#x6027;&#x5411;&#x5185;&#x6838;&#x6A21;&#x5757;&#x6216;<code>kvm</code>&#xFF08;&#x5982;QEMU&#xFF09;&#x4EE5;&#x53CA;&#x4E3A;&#x57FA;&#x4E8E;&#x4E91;&#x7684;&#x8BA1;&#x7B97;&#x7CFB;&#x7EDF;&#xFF08;&#x5982;OpenStack&#x548C;CloudStack&#xFF09;&#x63D0;&#x4F9B;&#x9AD8;&#x6027;&#x80FD;&#x5B58;&#x50A8;&#xFF0C;
&#x8FD9;&#x4E9B;&#x7CFB;&#x7EDF;&#x4F9D;&#x8D56;<code>libvirt</code>&#x548C;<code>QEMU</code>&#x4E0E;<code>Ceph block</code>&#x8BBE;&#x5907;&#x96C6;&#x6210;&#x3002;&#x60A8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x540C;&#x4E00;&#x96C6;&#x7FA4;&#x540C;&#x65F6;&#x64CD;&#x4F5C;<code>Ceph-RADOS</code>&#x7F51;&#x5173;&#x3001;<code>CephFS</code>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x548C;<code>Ceph-block</code>&#x8BBE;&#x5907;&#x3002;</p>
<p><code>Ceph</code>&#x5757;&#x8BBE;&#x5907;&#x5728;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x4E2D;&#x7684;&#x591A;&#x4E2A;&#x5BF9;&#x8C61;&#x4E0A;&#x5212;&#x5206;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;&#xFF0C;&#x6BCF;&#x4E2A;&#x5BF9;&#x8C61;&#x6620;&#x5C04;&#x5230;&#x4E00;&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#x5E76;&#x5206;&#x5E03;&#xFF0C;&#x653E;&#x7F6E;&#x7EC4;&#x5206;&#x5E03;&#x5728;&#x6574;&#x4E2A;&#x96C6;&#x7FA4;&#x4E2D;&#x4E0D;&#x540C;&#x7684;<code>ceph osd</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x4E0A;&#x3002;</p>
<p>&#x7CBE;&#x7B80;&#x914D;&#x7F6E;&#x7684;&#x53EF;&#x5FEB;&#x7167;<code>Ceph</code>&#x5757;&#x8BBE;&#x5907;&#x662F;&#x865A;&#x62DF;&#x5316;&#x548C;&#x4E91;&#x8BA1;&#x7B97;&#x7684;&#x4E00;&#x4E2A;&#x6709;&#x5438;&#x5F15;&#x529B;&#x7684;&#x9009;&#x62E9;&#x3002;
&#x5728;&#x865A;&#x62DF;&#x673A;&#x573A;&#x666F;&#x4E2D;&#xFF0C;&#x4EBA;&#x4EEC;&#x901A;&#x5E38;&#x5728;<code>QEMU/KVM</code>&#x4E2D;&#x90E8;&#x7F72;&#x5E26;&#x6709;<code>rbd</code>&#x7F51;&#x7EDC;&#x5B58;&#x50A8;&#x9A71;&#x52A8;&#x7A0B;&#x5E8F;&#x7684;<code>Ceph</code>&#x5757;&#x8BBE;&#x5907;&#xFF0C;&#x5176;&#x4E2D;&#x670D;&#x52A1;&#x7AEF;&#x4F7F;&#x7528;<code>librbd</code>&#x5411;&#x5BA2;&#x6237;&#x7AEF;&#x63D0;&#x4F9B;&#x5757;&#x8BBE;&#x5907;&#x670D;&#x52A1;&#x3002;
&#x8BB8;&#x591A;&#x4E91;&#x8BA1;&#x7B97;&#x6808;&#x4F7F;&#x7528;<code>libvirt</code>&#x4E0E;&#x7BA1;&#x7406;&#x7A0B;&#x5E8F;&#x96C6;&#x6210;&#x3002;&#x60A8;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<code>QEMU</code>&#x548C;<code>libvirt</code>&#x4F7F;&#x7528;&#x7626;&#x914D;&#x7F6E;&#x7684;<code>Ceph</code>&#x5757;&#x8BBE;&#x5907;&#x6765;&#x652F;&#x6301;<code>OpenStack</code>&#x548C;<code>CloudStack</code>&#x4EE5;&#x53CA;&#x5176;&#x4ED6;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x3002;</p>
<h2 id="ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;"><a name="ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;" class="anchor-navigation-ex-anchor" href="#ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;"><i class="fa fa-link" aria-hidden="true"></i></a>Ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</h2>
<p><code>Ceph</code>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;(cepphfs)&#x63D0;&#x4F9B;&#x4E86;<code>posix</code>&#x517C;&#x5BB9;&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4F5C;&#x4E3A;&#x4E00;&#x79CD;&#x670D;&#x52A1;&#xFF0C;&#x5B83;&#x662F;&#x5728;&#x57FA;&#x4E8E;&#x5BF9;&#x8C61;&#x7684;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x4E4B;&#x4E0A;&#x5206;&#x5C42;&#x7684;&#x3002;
<code>cepfs</code>&#x6587;&#x4EF6;&#x6620;&#x5C04;&#x5230;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x4E2D;&#x5B58;&#x50A8;&#x7684;&#x5BF9;&#x8C61;&#x3002;<code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x5C06;<code>cepfs</code>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x6302;&#x8F7D;&#x4E3A;&#x5185;&#x6838;&#x5BF9;&#x8C61;&#x6216;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;(FUSE)</p>
<p><img src="images/cephfs-artitecture.png" alt=""></p>
<p><code>Ceph</code>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x670D;&#x52A1;&#x5305;&#x62EC;&#x90E8;&#x7F72;&#x5728;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x4E2D;&#x7684;<code>Ceph</code>&#x5143;&#x6570;&#x636E;&#x670D;&#x52A1;&#x5668;(MDS)&#x3002;
<code>MDS</code>&#x7684;&#x76EE;&#x7684;&#x662F;&#x5C06;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x5143;&#x6570;&#x636E;(&#x76EE;&#x5F55;&#x3001;&#x6587;&#x4EF6;&#x6240;&#x6709;&#x6743;&#x3001;&#x8BBF;&#x95EE;&#x6A21;&#x5F0F;&#x7B49;)&#x5B58;&#x50A8;&#x5728;&#x9AD8;&#x53EF;&#x7528;&#x6027;<code>Ceph</code>&#x5143;&#x6570;&#x636E;&#x670D;&#x52A1;&#x5668;&#x4E2D;&#xFF0C;&#x5143;&#x6570;&#x636E;&#x9A7B;&#x7559;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x3002;
<code>MDS</code>(&#x79F0;&#x4E3A;Ceph - MDS&#x7684;&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;)&#x5B58;&#x5728;&#x7684;&#x539F;&#x56E0;&#x662F;&#xFF0C;&#x7B80;&#x5355;&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x64CD;&#x4F5C;&#xFF0C;&#x5982;&#x5217;&#x51FA;&#x76EE;&#x5F55;&#x6216;&#x66F4;&#x6539;&#x76EE;&#x5F55;(ls&#x3001;cd)&#xFF0C;&#x4F1A;&#x7ED9;<code>ceph osd</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x5E26;&#x6765;&#x4E0D;&#x5FC5;&#x8981;&#x7684;&#x8D1F;&#x62C5;&#x3002;
&#x56E0;&#x6B64;&#xFF0C;&#x5C06;&#x5143;&#x6570;&#x636E;&#x4ECE;&#x6570;&#x636E;&#x4E2D;&#x5206;&#x79BB;&#x51FA;&#x6765;&#x610F;&#x5473;&#x7740;<code>Ceph</code>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x53EF;&#x4EE5;&#x63D0;&#x4F9B;&#x9AD8;&#x6027;&#x80FD;&#x670D;&#x52A1;&#xFF0C;&#x800C;&#x4E0D;&#x4F1A;&#x5BF9;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x9020;&#x6210;&#x8D1F;&#x62C5;&#x3002;</p>
<p><code>cepfs</code>&#x5C06;&#x5143;&#x6570;&#x636E;&#x4E0E;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x5206;&#x79BB;&#xFF0C;&#x5143;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x5728;<code>MDS</code>&#x4E2D;&#xFF0C;&#x6587;&#x4EF6;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x5728;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5BF9;&#x8C61;&#x4E2D;&#x3002;
<code>Ceph</code>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x65E8;&#x5728;&#x4E0E;<code>POSIX</code>&#x517C;&#x5BB9;&#x3002;&#x4E3A;&#x4E86;&#x5B9E;&#x73B0;&#x9AD8;&#x53EF;&#x7528;&#x6027;&#x6216;&#x53EF;&#x4F38;&#x7F29;&#x6027;&#xFF0C;<code>ceph-mds</code>&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x5355;&#x4E2A;&#x8FDB;&#x7A0B;&#x8FD0;&#x884C;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x5C06;&#x5176;&#x5206;&#x53D1;&#x5230;&#x591A;&#x4E2A;&#x7269;&#x7406;&#x673A;&#x5668;&#x3002;</p>
<ul>
<li>&#x9AD8;&#x53EF;&#x7528;&#xFF1A;&#x989D;&#x5916;&#x7684;<code>ceph-mds</code>&#x5B9E;&#x4F8B;&#x53EF;&#x4EE5;&#x662F;&#x5907;&#x7528;&#x7684;&#xFF0C;&#x968F;&#x65F6;&#x51C6;&#x5907;&#x63A5;&#x7BA1;&#x4EFB;&#x4F55;&#x5931;&#x6548;&#x7684;<code>active ceph-mds</code>&#x7684;&#x804C;&#x8D23;&#x3002;&#x8FD9;&#x5F88;&#x5BB9;&#x6613;&#xFF0C;&#x56E0;&#x4E3A;&#x5305;&#x62EC;&#x65E5;&#x5FD7;&#x5728;&#x5185;&#x7684;&#x6240;&#x6709;&#x6570;&#x636E;&#x90FD;&#x5B58;&#x50A8;&#x5728;<code>RADOS</code>&#x4E0A;&#x3002;&#x8BE5;&#x8F6C;&#x6362;&#x7531;<code>ceph-mon</code>&#x81EA;&#x52A8;&#x89E6;&#x53D1;</li>
<li>&#x53EF;&#x6269;&#x5C55;&#xFF1A;&#x591A;&#x4E2A;<code>ceph mds</code>&#x5B9E;&#x4F8B;&#x53EF;&#x4EE5;&#x5904;&#x4E8E;&#x6D3B;&#x52A8;&#x72B6;&#x6001;&#xFF0C;&#x5B83;&#x4EEC;&#x5C06;&#x76EE;&#x5F55;&#x6811;&#x62C6;&#x5206;&#x4E3A;&#x5B50;&#x6811;&#xFF08;&#x4EE5;&#x53CA;&#x5355;&#x4E2A;&#x7E41;&#x5FD9;&#x76EE;&#x5F55;&#x7684;&#x788E;&#x7247;&#xFF09;&#xFF0C;&#x4ECE;&#x800C;&#x6709;&#x6548;&#x5730;&#x5E73;&#x8861;&#x6240;&#x6709;&#x6D3B;&#x52A8;&#x670D;&#x52A1;&#x5668;&#x4E4B;&#x95F4;&#x7684;&#x8D1F;&#x8F7D;</li>
</ul>
<h3 id="&#x90E8;&#x7F72;&#x5143;&#x6570;&#x636E;&#x670D;&#x52A1;&#x5668;"><a name="&#x90E8;&#x7F72;&#x5143;&#x6570;&#x636E;&#x670D;&#x52A1;&#x5668;" class="anchor-navigation-ex-anchor" href="#&#x90E8;&#x7F72;&#x5143;&#x6570;&#x636E;&#x670D;&#x52A1;&#x5668;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x90E8;&#x7F72;&#x5143;&#x6570;&#x636E;&#x670D;&#x52A1;&#x5668;</h3>
<h4 id="mds&#x5BBF;&#x4E3B;&#x673A;&#x914D;&#x7F6E;&#x9700;&#x6C42;"><a name="mds&#x5BBF;&#x4E3B;&#x673A;&#x914D;&#x7F6E;&#x9700;&#x6C42;" class="anchor-navigation-ex-anchor" href="#mds&#x5BBF;&#x4E3B;&#x673A;&#x914D;&#x7F6E;&#x9700;&#x6C42;"><i class="fa fa-link" aria-hidden="true"></i></a>MDS&#x5BBF;&#x4E3B;&#x673A;&#x914D;&#x7F6E;&#x9700;&#x6C42;</h4>
<ul>
<li><p><code>MDS</code>&#x7684;&#x5F53;&#x524D;&#x7248;&#x672C;&#x662F;&#x5355;&#x7EBF;&#x7A0B;&#x548C;<code>cpu</code>&#x7ED1;&#x5B9A;&#x7684;&#xFF0C;&#x7528;&#x4E8E;&#x5927;&#x591A;&#x6570;&#x6D3B;&#x52A8;&#xFF0C;&#x5305;&#x62EC;&#x54CD;&#x5E94;&#x5BA2;&#x6237;&#x673A;&#x8BF7;&#x6C42;&#x3002;
&#x5373;&#x4F7F;&#x5982;&#x6B64;&#xFF0C;&#x4E00;&#x4E2A;<code>MDS</code>&#x5728;&#x6700;&#x6D3B;&#x8DC3;&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x8D1F;&#x8F7D;&#x4E0B;&#x4ECD;&#x7136;&#x4F7F;&#x7528;&#x5927;&#x7EA6;2&#x5230;3&#x4E2A;<code>CPU</code>&#x6838;&#x3002;&#x8FD9;&#x662F;&#x7531;&#x4E8E;&#x5176;&#x4ED6;&#x6742;&#x9879;&#x7EF4;&#x62A4;&#x7EBF;&#x7A0B;&#x534F;&#x540C;&#x5DE5;&#x4F5C;&#x9020;&#x6210;&#x7684;&#x3002;</p>
</li>
<li><p>&#x5185;&#x5B58;&#xFF1A;&#x7528;&#x4E8E;<code>MDS</code>&#x7BA1;&#x7406;&#x6240;&#x6709;&#x5BA2;&#x6237;&#x7AEF;&#x548C;&#x5176;&#x4ED6;&#x6D3B;&#x52A8;<code>MDS</code>&#x4E4B;&#x95F4;&#x7684;&#x5206;&#x5E03;&#x5F0F;&#x534F;&#x4F5C;&#x5143;&#x6570;&#x636E;&#x7F13;&#x5B58;&#xFF0C;1000&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x8282;&#x70B9;&#x7684;<code>MDS</code>&#x5C06;&#x4F7F;&#x7528;&#x81F3;&#x5C11;64<code>GB</code>&#x7684;&#x7F13;&#x5B58;&#x3002;</p>
</li>
</ul>
<p>&#x5728;&#x88F8;&#x91D1;&#x5C5E;&#x96C6;&#x7FA4;&#x4E2D;&#xFF0C;&#x6700;&#x4F73;&#x5B9E;&#x8DF5;&#x662F;&#x4E3A;<code>MDS</code>&#x670D;&#x52A1;&#x5668;&#x8FC7;&#x5EA6;&#x4F9B;&#x5E94;&#x786C;&#x4EF6;&#x3002;&#x5373;&#x4F7F;&#x5355;&#x4E2A;<code>MDS</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x4E0D;&#x80FD;&#x5145;&#x5206;&#x5229;&#x7528;&#x786C;&#x4EF6;&#xFF0C;&#x4EE5;&#x540E;&#x4E5F;&#x53EF;&#x4EE5;&#x5728;&#x540C;&#x4E00;&#x8282;&#x70B9;&#x4E0A;&#x542F;&#x52A8;&#x66F4;&#x591A;&#x7684;&#x6D3B;&#x52A8;<code>MDS</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#xFF0C;&#x4EE5;&#x5145;&#x5206;&#x5229;&#x7528;&#x53EF;&#x7528;&#x7684;&#x5185;&#x6838;&#x548C;&#x5185;&#x5B58;&#x3002;
&#x6B64;&#x5916;&#xFF0C;&#x901A;&#x8FC7;&#x96C6;&#x7FA4;&#x4E0A;&#x7684;&#x5DE5;&#x4F5C;&#x8D1F;&#x8F7D;&#xFF0C;&#x53EF;&#x4EE5;&#x6E05;&#x695A;&#x5730;&#x770B;&#x5230;&#xFF0C;&#x5728;&#x540C;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x4E0A;&#x4F7F;&#x7528;&#x591A;&#x4E2A;&#x4E3B;<code>MDS</code>.</p>
<p>&#x4ECE;&#x7CFB;&#x7EDF;&#x9AD8;&#x53EF;&#x7528;&#x6027;&#x8003;&#x8651;&#xFF0C;&#x96C6;&#x7FA4;&#x4E2D;&#x81F3;&#x5C11;&#x90E8;&#x7F72;&#x4E24;&#x4E2A;&#x4EE5;&#x4E0A;<code>MDS</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;</p>
<p>&#x5B98;&#x65B9;&#x5EFA;&#x8BAE;&#x5C06;<code>MDS</code>&#x4E0E;&#x5176;&#x4ED6;<code>Ceph</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x90E8;&#x7F72;&#x5728;&#x540C;&#x4E00;&#x5BBF;&#x4E3B;&#x673A;&#xFF0C;&#x4F46;&#x9700;&#x8FDB;&#x884C;&#x914D;&#x989D;&#x9650;&#x5236;</p>
<h2 id="ceph-&#x5BF9;&#x8C61;&#x5B58;&#x50A8;"><a name="ceph-&#x5BF9;&#x8C61;&#x5B58;&#x50A8;" class="anchor-navigation-ex-anchor" href="#ceph-&#x5BF9;&#x8C61;&#x5B58;&#x50A8;"><i class="fa fa-link" aria-hidden="true"></i></a>Ceph &#x5BF9;&#x8C61;&#x5B58;&#x50A8;</h2>
<p><code>Ceph</code>&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;<code>radosgw</code>&#x662F;&#x4E00;&#x4E2A;<code>FastCGI</code>&#x670D;&#x52A1;&#xFF0C;&#x5B83;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;<code>RESTful</code>&#x7684;<code>HTTP API</code>&#x6765;&#x5B58;&#x50A8;&#x5BF9;&#x8C61;&#x548C;&#x5143;&#x6570;&#x636E;&#x3002;
&#x5B83;&#x4EE5;&#x81EA;&#x5DF1;&#x7684;&#x6570;&#x636E;&#x683C;&#x5F0F;&#x5728;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x4E4B;&#x4E0A;&#x5206;&#x5C42;&#xFF0C;&#x5E76;&#x7EF4;&#x62A4;&#x81EA;&#x5DF1;&#x7684;&#x7528;&#x6237;&#x6570;&#x636E;&#x5E93;&#x3001;&#x8EAB;&#x4EFD;&#x9A8C;&#x8BC1;&#x548C;&#x8BBF;&#x95EE;&#x63A7;&#x5236;&#x3002;
<code>RADOS</code>&#x7F51;&#x5173;&#x91C7;&#x7528;&#x7EDF;&#x4E00;&#x7684;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#xFF0C;&#x65E2;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>OpenStack swift</code>&#x63A5;&#x53E3;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>Amazon s3</code>&#x63A5;&#x53E3;&#x3002;
&#x4F8B;&#x5982;&#xFF0C;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x4F7F;&#x7528;<code>s3</code>&#x517C;&#x5BB9;&#x7684;<code>API</code>&#x5199;&#x5165;&#x6570;&#x636E;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x4F7F;&#x7528;<code>swift</code>&#x517C;&#x5BB9;&#x7684;<code>API</code>&#x8BFB;&#x53D6;&#x6570;&#x636E;</p>
<p><strong>S3/Swift&#x5BF9;&#x8C61;&#x548C;&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x5BF9;&#x8C61;&#x5BF9;&#x6BD4;&#xFF1A;</strong></p>
<p><code>Ceph</code>&#x7684;<code>Object Storage</code>&#x4F7F;&#x7528;<code>Object</code>&#x8FD9;&#x4E2A;&#x672F;&#x8BED;&#x6765;&#x63CF;&#x8FF0;&#x5B83;&#x5B58;&#x50A8;&#x7684;&#x6570;&#x636E;&#x3002;
<code>S3</code>&#x548C;<code>Swift</code>&#x5BF9;&#x8C61;&#x4E0E;<code>Ceph</code>&#x5199;&#x5165;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x7684;&#x5BF9;&#x8C61;&#x4E0D;&#x540C;&#x3002;
<code>Ceph</code>&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x5BF9;&#x8C61;&#x6620;&#x5C04;&#x5230;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x5BF9;&#x8C61;&#x3002;
<code>S3</code>&#x548C;<code>Swift</code>&#x5BF9;&#x8C61;&#x4E0D;&#x4E00;&#x5B9A;&#x4E0E;&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x4E2D;&#x5B58;&#x50A8;&#x7684;&#x5BF9;&#x8C61;&#x4EE5;1:1&#x7684;&#x65B9;&#x5F0F;&#x5BF9;&#x5E94;&#x3002;
<code>S3</code>&#x6216;<code>Swift</code>&#x5BF9;&#x8C61;&#x6709;&#x53EF;&#x80FD;&#x6620;&#x5C04;&#x5230;&#x591A;&#x4E2A;<code>Ceph</code>&#x5BF9;&#x8C61;&#x3002;</p>
<h2 id="&#x7ADE;&#x54C1;&#x5BF9;&#x6BD4;"><a name="&#x7ADE;&#x54C1;&#x5BF9;&#x6BD4;" class="anchor-navigation-ex-anchor" href="#&#x7ADE;&#x54C1;&#x5BF9;&#x6BD4;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x7ADE;&#x54C1;&#x5BF9;&#x6BD4;</h2>
<h3 id="&#x5BF9;&#x6BD4;raid"><a name="&#x5BF9;&#x6BD4;raid" class="anchor-navigation-ex-anchor" href="#&#x5BF9;&#x6BD4;raid"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5BF9;&#x6BD4;raid</h3>
<p><code>RAID</code>(Redundant Array of Independent Disks)&#x5373;&#x72EC;&#x7ACB;&#x5197;&#x4F59;&#x78C1;&#x76D8;&#x9635;&#x5217;&#xFF0C;&#x662F;&#x4E00;&#x79CD;&#x628A;&#x591A;&#x5757;&#x72EC;&#x7ACB;&#x7684;&#x786C;&#x76D8;&#xFF08;&#x7269;&#x7406;&#x786C;&#x76D8;&#xFF09;&#x6309;&#x4E0D;&#x540C;&#x7684;&#x65B9;&#x5F0F;&#x7EC4;&#x5408;&#x8D77;&#x6765;&#x5F62;&#x6210;&#x4E00;&#x4E2A;&#x786C;&#x76D8;&#x7EC4;&#xFF08;&#x903B;&#x8F91;&#x786C;&#x76D8;&#xFF09;&#xFF0C;&#x8BA9;&#x7528;&#x6237;&#x8BA4;&#x4E3A;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5355;&#x4E2A;&#x8D85;&#x5927;&#x786C;&#x76D8;&#xFF0C;&#x4ECE;&#x800C;&#x63D0;&#x4F9B;&#x6BD4;&#x5355;&#x4E2A;&#x786C;&#x76D8;&#x66F4;&#x9AD8;&#x7684;&#x5B58;&#x50A8;&#x6027;&#x80FD;&#x548C;&#x63D0;&#x4F9B;&#x6570;&#x636E;&#x5907;&#x4EFD;&#x6280;&#x672F;</p>
<ul>
<li><p><a href="">RAID</a></p>
<ul>
<li><p>&#x6F2B;&#x957F;&#x7684;&#x91CD;&#x5EFA;&#x8FC7;&#x7A0B;&#xFF0C;&#x800C;&#x4E14;&#x5728;&#x91CD;&#x5EFA;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x4E0D;&#x80FD;&#x6709;&#x7B2C;&#x4E8C;&#x5757;&#x76D8;&#x635F;&#x574F;&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x5F15;&#x53D1;&#x66F4;&#x5927;&#x7684;&#x95EE;&#x9898;&#xFF1B;</p>
</li>
<li><p>&#x5907;&#x7528;&#x76D8;&#x589E;&#x52A0;<a href="https://baike.baidu.com/item/tco/5979397?fr=aladdin" target="_blank">TCO</a> &#xFF0C;&#x4F5C;&#x4E3A;&#x5907;&#x7528;&#x76D8;&#xFF0C;&#x5F53;&#x6CA1;&#x6709;&#x786C;&#x76D8;&#x6545;&#x969C;&#x65F6;&#xFF0C;&#x5C31;&#x4F1A;&#x4E00;&#x76F4;&#x95F2;&#x7F6E;&#x7684;</p>
</li>
<li><p>&#x4E0D;&#x80FD;&#x4FDD;&#x8BC1;&#x4E24;&#x5757;&#x76D8;&#x540C;&#x65F6;&#x6545;&#x969C;&#x540E;&#xFF0C;&#x6570;&#x636E;&#x7684;&#x53EF;&#x9760;&#x6027;</p>
</li>
<li><p>&#x5728;&#x91CD;&#x5EFA;&#x7ED3;&#x675F;&#x524D;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x65E0;&#x6CD5;&#x83B7;&#x53D6;&#x5230;&#x8DB3;&#x591F;&#x7684;<code>IO</code>&#x8D44;&#x6E90;</p>
</li>
<li><p>&#x65E0;&#x6CD5;&#x907F;&#x514D;&#x7F51;&#x7EDC;&#x3001;&#x670D;&#x52A1;&#x5668;&#x786C;&#x4EF6;&#x3001;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x3001;&#x7535;&#x6E90;&#x7B49;&#x6545;&#x969C;</p>
</li>
</ul>
</li>
<li><p><a href="">Ceph</a></p>
<ul>
<li><p>&#x4E3A;&#x4E86;&#x4FDD;&#x8BC1;&#x53EF;&#x9760;&#x6027;&#xFF0C;&#x91C7;&#x7528;&#x4E86;&#x6570;&#x636E;&#x590D;&#x5236;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x4E0D;&#x518D;&#x9700;&#x8981;<code>RAID</code>&#xFF0C;&#x4E5F;&#x5C31;&#x514B;&#x670D;&#x4E86;<code>RAID</code>&#x5B58;&#x5728;&#x7684;&#x8BF8;&#x591A;&#x95EE;&#x9898;</p>
</li>
<li><p><code>Ceph</code> &#x6570;&#x636E;&#x5B58;&#x50A8;&#x539F;&#x5219;&#xFF1A;&#x4E00;&#x4E2A;<code>Pool</code> &#x6709;&#x82E5;&#x5E72;<code>PG</code>&#xFF0C;&#x6BCF;&#x4E2A;<code>PG</code> &#x5305;&#x542B;&#x82E5;&#x5E72;&#x5BF9;&#x8C61;&#xFF0C;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x53EA;&#x80FD;&#x5B58;&#x50A8;&#x5728;&#x4E00;&#x4E2A;<code>PG</code>&#x4E2D;&#xFF0C;&#x800C;<code>Ceph</code> &#x9ED8;&#x8BA4;&#x4E00;&#x4E2A;<code>PG</code> &#x5305;&#x542B;&#x4E09;&#x4E2A;<code>OSD</code>&#xFF0C;&#x6BCF;&#x4E2A;<code>OSD</code>&#x90FD;&#x53EF;&#x770B;&#x505A;&#x4E00;&#x5757;&#x786C;&#x76D8;&#x3002;
&#x56E0;&#x6B64;&#xFF0C;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x5728;<code>Ceph</code>&#x4E2D;&#x65F6;&#xFF0C;&#x5C31;&#x88AB;&#x4FDD;&#x5B58;&#x4E86;&#x4E09;&#x4EFD;&#x3002;&#x5F53;&#x4E00;&#x4E2A;&#x78C1;&#x76D8;&#x6545;&#x969C;&#x65F6;&#xFF0C;&#x8FD8;&#x5269;&#x4E0B;2&#x4E2A;<code>PG</code>&#xFF0C;&#x7CFB;&#x7EDF;&#x5C31;&#x4F1A;&#x4ECE;&#x53E6;&#x5916;&#x4E24;&#x4E2A;<code>PG</code>&#x4E2D;&#x590D;&#x5236;&#x6570;&#x636E;&#x5230;&#x5176;&#x4ED6;&#x78C1;&#x76D8;&#x4E0A;&#x3002;&#x8FD9;&#x4E2A;&#x662F;&#x7531;<code>crush</code>&#x7B97;&#x6CD5;&#x51B3;&#x5B9A;</p>
</li>
<li><p>&#x78C1;&#x76D8;&#x590D;&#x5236;&#x5C5E;&#x6027;&#x503C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x7BA1;&#x7406;&#x5458;&#x8FDB;&#x884C;&#x8C03;&#x6574;</p>
</li>
<li><p>&#x78C1;&#x76D8;&#x5B58;&#x50A8;&#x4E0A;&#x4F7F;&#x7528;&#x4E86;&#x52A0;&#x6743;&#x673A;&#x5236;&#xFF0C;&#x6240;&#x4EE5;&#x78C1;&#x76D8;&#x5927;&#x5C0F;&#x4E0D;&#x4E00;&#x81F4;&#x4E5F;&#x4E0D;&#x4F1A;&#x51FA;&#x73B0;&#x95EE;&#x9898;</p>
</li>
</ul>
</li>
</ul>
<h3 id="&#x5BF9;&#x6BD4;san&#x3001;nas&#x3001;das"><a name="&#x5BF9;&#x6BD4;san&#x3001;nas&#x3001;das" class="anchor-navigation-ex-anchor" href="#&#x5BF9;&#x6BD4;san&#x3001;nas&#x3001;das"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5BF9;&#x6BD4;SAN&#x3001;NAS&#x3001;DAS</h3>
<ul>
<li><p>DAS</p>
<p>  <code>Direct Attached Storage</code>&#xFF0C;&#x5373;&#x76F4;&#x8FDE;&#x9644;&#x52A0;&#x5B58;&#x50A8;&#xFF0C;&#x7B2C;&#x4E00;&#x4EE3;&#x5B58;&#x50A8;&#x7CFB;&#x7EDF;&#xFF0C;&#x901A;&#x8FC7;<code>SCSI</code>&#x603B;&#x7EBF;&#x6269;&#x5C55;&#x81F3;&#x4E00;&#x4E2A;&#x5916;&#x90E8;&#x7684;&#x5B58;&#x50A8;&#xFF0C;&#x78C1;&#x5E26;&#x6574;&#x5217;&#xFF0C;&#x4F5C;&#x4E3A;&#x670D;&#x52A1;&#x5668;&#x6269;&#x5C55;&#x7684;&#x4E00;&#x90E8;&#x5206;</p>
</li>
<li><p>NAS</p>
<p>  <code>Network Attached Storage</code>&#xFF0C;&#x5373;&#x7F51;&#x7EDC;&#x9644;&#x52A0;&#x5B58;&#x50A8;&#xFF0C;&#x901A;&#x8FC7;&#x7F51;&#x7EDC;&#x534F;&#x8BAE;&#x5982;<code>NFS</code>&#x8FDC;&#x7A0B;&#x83B7;&#x53D6;&#x540E;&#x7AEF;&#x6587;&#x4EF6;&#x670D;&#x52A1;&#x5668;&#x5171;&#x4EAB;&#x7684;&#x5B58;&#x50A8;&#x7A7A;&#x95F4;&#xFF0C;&#x5C06;&#x6587;&#x4EF6;&#x5B58;&#x50A8;&#x5355;&#x72EC;&#x5206;&#x79BB;&#x51FA;&#x6765;</p>
</li>
<li><p>SAN</p>
<p>  <code>Storage Area Network</code>&#xFF0C;&#x5373;&#x5B58;&#x50A8;&#x533A;&#x57DF;&#x7F51;&#x7EDC;&#xFF0C;&#x5206;&#x4E3A;<code>IP-SAN</code>&#x548C;<code>FC-SAN</code>&#xFF0C;&#x5373;&#x901A;&#x8FC7;<code>TCP/IP</code>&#x534F;&#x8BAE;&#x548C;<code>FC</code>(Fiber Channel)&#x5149;&#x7EA4;&#x534F;&#x8BAE;&#x8FDE;&#x63A5;&#x5230;&#x5B58;&#x50A8;&#x670D;&#x52A1;&#x5668;</p>
</li>
<li><p>Ceph</p>
<p>  <code>Ceph</code>&#x5728;&#x4E00;&#x4E2A;&#x7EDF;&#x4E00;&#x7684;&#x5B58;&#x50A8;&#x7CFB;&#x7EDF;&#x4E2D;&#x540C;&#x65F6;&#x63D0;&#x4F9B;&#x4E86;&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x3001;&#x5757;&#x5B58;&#x50A8;&#x548C;&#x6587;&#x4EF6;&#x5B58;&#x50A8;&#xFF0C;&#x5373;<code>Ceph</code>&#x662F;&#x4E00;&#x4E2A;&#x7EDF;&#x4E00;&#x5B58;&#x50A8;&#xFF0C;&#x80FD;&#x591F;&#x5C06;&#x4F01;&#x4E1A;&#x4F01;&#x4E1A;&#x4E2D;&#x7684;&#x4E09;&#x79CD;&#x5B58;&#x50A8;&#x9700;&#x6C42;&#x7EDF;&#x4E00;&#x6C47;&#x603B;&#x5230;&#x4E00;&#x4E2A;&#x5B58;&#x50A8;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x5E76;&#x63D0;&#x4F9B;&#x5206;&#x5E03;&#x5F0F;&#x3001;&#x6A2A;&#x5411;&#x6269;&#x5C55;&#xFF0C;&#x9AD8;&#x5EA6;&#x53EF;&#x9760;&#x6027;&#x7684;&#x5B58;&#x50A8;&#x7CFB;&#x7EDF;</p>
</li>
</ul>
<p><strong>&#x4E3B;&#x8981;&#x533A;&#x522B;&#x5982;&#x4E0B;&#xFF1A;</strong></p>
<ul>
<li><p><code>DAS</code>&#x76F4;&#x8FDE;&#x5B58;&#x50A8;&#x670D;&#x52A1;&#x5668;&#x4F7F;&#x7528;<code>SCSI</code>&#x6216;<code>FC</code>&#x534F;&#x8BAE;&#x8FDE;&#x63A5;&#x5230;&#x5B58;&#x50A8;&#x9635;&#x5217;&#x3001;&#x901A;&#x8FC7;<code>SCSI</code>&#x603B;&#x7EBF;&#x548C;<code>FC</code>&#x5149;&#x7EA4;&#x534F;&#x8BAE;&#x7C7B;&#x578B;&#x8FDB;&#x884C;&#x6570;&#x636E;&#x4F20;&#x8F93;&#xFF1B;
&#x4F8B;&#x5982;&#x4E00;&#x5757;&#x6709;&#x7A7A;&#x95F4;&#x5927;&#x5C0F;&#x7684;&#x88F8;&#x78C1;&#x76D8;&#xFF1A;<code>/dev/sdb</code>&#x3002;<code>DAS</code>&#x5B58;&#x50A8;&#x867D;&#x7136;&#x7EC4;&#x7F51;&#x7B80;&#x5355;&#x3001;&#x6210;&#x672C;&#x4F4E;&#x5EC9;&#x4F46;&#x662F;&#x53EF;&#x6269;&#x5C55;&#x6027;&#x6709;&#x9650;&#x3001;&#x65E0;&#x6CD5;&#x591A;&#x4E3B;&#x673A;&#x5B9E;&#x73B0;&#x5171;&#x4EAB;&#x3001;&#x76EE;&#x524D;&#x5DF2;&#x7ECF;&#x5F88;&#x5C11;&#x4F7F;&#x7528;</p>
</li>
<li><p><code>NAS</code>&#x7F51;&#x7EDC;&#x5B58;&#x50A8;&#x670D;&#x52A1;&#x5668;&#x4F7F;&#x7528;<code>TCP</code>&#x7F51;&#x7EDC;&#x534F;&#x8BAE;&#x8FDE;&#x63A5;&#x81F3;&#x6587;&#x4EF6;&#x5171;&#x4EAB;&#x5B58;&#x50A8;&#x3001;&#x5E38;&#x89C1;&#x7684;&#x6709;<code>NFS</code>&#x3001;<code>CIFS</code>&#x534F;&#x8BAE;&#x7B49;&#xFF1B;&#x901A;&#x8FC7;&#x7F51;&#x7EDC;&#x7684;&#x65B9;&#x5F0F;&#x6620;&#x5C04;&#x5B58;&#x50A8;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x76EE;&#x5F55;&#x5230;&#x76EE;&#x6807;&#x4E3B;&#x673A;&#xFF0C;&#x5982;<code>/data</code>&#x3002;
<code>NAS</code>&#x7F51;&#x7EDC;&#x5B58;&#x50A8;&#x4F7F;&#x7528;&#x7B80;&#x5355;&#xFF0C;&#x901A;&#x8FC7;<code>IP</code>&#x534F;&#x8BAE;&#x5B9E;&#x73B0;&#x4E92;&#x76F8;&#x8BBF;&#x95EE;&#xFF0C;&#x591A;&#x53F0;&#x4E3B;&#x673A;&#x53EF;&#x4EE5;&#x540C;&#x65F6;&#x5171;&#x4EAB;&#x540C;&#x4E00;&#x4E2A;&#x5B58;&#x50A8;&#x3002;&#x4F46;&#x662F;<code>NAS</code>&#x7F51;&#x7EDC;&#x5B58;&#x50A8;&#x7684;&#x6027;&#x80FD;&#x6709;&#x9650;&#xFF0C;&#x53EF;&#x9760;&#x6027;&#x4E0D;&#x662F;&#x5F88;&#x9AD8;&#x3002;</p>
</li>
<li><p><code>SAN</code>&#x5B58;&#x50A8;&#x533A;&#x57DF;&#x7F51;&#x7EDC;&#x670D;&#x52A1;&#x5668;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x5B58;&#x50A8;&#x533A;&#x57DF;&#x7F51;&#x7EDC;<code>IP</code>&#x6216;<code>FC</code>&#x8FDE;&#x63A5;&#x5230;&#x5B58;&#x50A8;&#x9635;&#x5217;&#x3001;&#x5E38;&#x89C1;&#x7684;<code>SAN</code>&#x534F;&#x8BAE;&#x7C7B;&#x578B;&#x6709;<code>IP-SAN</code>&#x548C;<code>FC-SAN</code>&#x3002;<code>SAN</code>&#x5B58;&#x50A8;&#x533A;&#x57DF;&#x7F51;&#x7EDC;&#x7684;&#x6027;&#x80FD;&#x975E;&#x5E38;&#x597D;&#x3001;&#x53EF;&#x6269;&#x5C55;&#x6027;&#x5F3A;&#xFF1B;&#x4F46;&#x662F;&#x6210;&#x672C;&#x7279;&#x522B;&#x9AD8;&#x3001;&#x5C24;&#x5176;&#x662F;<code>FC</code>&#x5B58;&#x50A8;&#x7F51;&#x7EDC;&#xFF1A;&#x56E0;&#x4E3A;&#x9700;&#x8981;&#x7528;&#x5230;<code>HBA</code>&#x5361;&#x3001;<code>FC</code>&#x4EA4;&#x6362;&#x673A;&#x548C;&#x652F;&#x6301;<code>FC</code>&#x63A5;&#x53E3;&#x7684;&#x5B58;&#x50A8;</p>
</li>
</ul>
<pre class="language-"><code>| &#x5B58;&#x50A8;&#x7ED3;&#x6784;/&#x6027;&#x80FD;&#x5BF9;&#x6BD4; | DAS | NAS | FC-SAN | IP-SAN | Ceph |
| :----:| :----: | :----: | :----: | :----: | :----: |
| &#x6210;&#x672C; | &#x4F4E; | &#x8F83;&#x4F4E; | &#x9AD8; | &#x8F83;&#x9AD8; | &#x9AD8; |
| &#x6570;&#x636E;&#x4F20;&#x8F93;&#x901F;&#x5EA6; | &#x5FEB; | &#x6162; | &#x6781;&#x5FEB; | &#x8F83;&#x5FEB; | &#x5FEB; |
| &#x6269;&#x5C55;&#x6027; | &#x65E0;&#x6269;&#x5C55;&#x6027; | &#x8F83;&#x4F4E; | &#x6613;&#x4E8E;&#x6269;&#x5C55; | &#x6700;&#x6613;&#x6269;&#x5C55; | &#x6613;&#x4E8E;&#x6269;&#x5C55; |
| &#x670D;&#x52A1;&#x5668;&#x8BBF;&#x95EE;&#x5B58;&#x50A8;&#x65B9;&#x5F0F; | &#x5757; | &#x6587;&#x4EF6; | &#x5757; | &#x5757; | &#x5BF9;&#x8C61;&#x3001;&#x6587;&#x4EF6;&#x3001;&#x5757; |
| &#x670D;&#x52A1;&#x5668;&#x7CFB;&#x7EDF;&#x6027;&#x80FD;&#x5F00;&#x9500; | &#x4F4E; | &#x8F83;&#x4F4E; | &#x4F4E; | &#x8F83;&#x9AD8; | &#x4F4E; |
| &#x5B89;&#x5168;&#x6027; | &#x9AD8; | &#x4F4E; | &#x9AD8; | &#x4F4E; | &#x9AD8; |
| &#x662F;&#x5426;&#x96C6;&#x4E2D;&#x7BA1;&#x7406;&#x5B58;&#x50A8; | &#x5426; | &#x662F; | &#x662F; | &#x662F; | &#x5426; |
| &#x5907;&#x4EFD;&#x6548;&#x7387; | &#x4F4E; | &#x8F83;&#x4F4E; | &#x9AD8; | &#x8F83;&#x9AD8; | &#x9AD8; |
| &#x7F51;&#x7EDC;&#x4F20;&#x8F93;&#x534F;&#x8BAE; | &#x65E0; | TCP/IP | FC | TCP/IP | &#x79C1;&#x6709;&#x534F;&#x8BAE;(TCP) |
</code></pre><h3 id="&#x5BF9;&#x6BD4;&#x5176;&#x4ED6;&#x5206;&#x5E03;&#x5F0F;&#x5B58;&#x50A8;"><a name="&#x5BF9;&#x6BD4;&#x5176;&#x4ED6;&#x5206;&#x5E03;&#x5F0F;&#x5B58;&#x50A8;" class="anchor-navigation-ex-anchor" href="#&#x5BF9;&#x6BD4;&#x5176;&#x4ED6;&#x5206;&#x5E03;&#x5F0F;&#x5B58;&#x50A8;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5BF9;&#x6BD4;&#x5176;&#x4ED6;&#x5206;&#x5E03;&#x5F0F;&#x5B58;&#x50A8;</h3>
<h1 id="&#x96C6;&#x6210;&#x90E8;&#x7F72;"><a name="&#x96C6;&#x6210;&#x90E8;&#x7F72;" class="anchor-navigation-ex-anchor" href="#&#x96C6;&#x6210;&#x90E8;&#x7F72;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x96C6;&#x6210;&#x90E8;&#x7F72;</h1>
<h2 id="&#x786C;&#x4EF6;&#x9700;&#x6C42;"><a name="&#x786C;&#x4EF6;&#x9700;&#x6C42;" class="anchor-navigation-ex-anchor" href="#&#x786C;&#x4EF6;&#x9700;&#x6C42;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x786C;&#x4EF6;&#x9700;&#x6C42;</h2>
<p><code>Ceph</code>&#x88AB;&#x8BBE;&#x8BA1;&#x6210;&#x5728;&#x666E;&#x901A;&#x786C;&#x4EF6;&#x4E0A;&#x8FD0;&#x884C;&#xFF0C;&#x8FD9;&#x4F7F;&#x5F97;&#x6784;&#x5EFA;&#x548C;&#x7EF4;&#x62A4;<code>pb</code>&#x7EA7;&#x6570;&#x636E;&#x96C6;&#x7FA4;&#x5728;&#x7ECF;&#x6D4E;&#x4E0A;&#x53EF;&#x884C;,&#x5728;&#x89C4;&#x5212;&#x96C6;&#x7FA4;&#x786C;&#x4EF6;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x5E73;&#x8861;&#x8BB8;&#x591A;&#x8003;&#x8651;&#x56E0;&#x7D20;&#xFF0C;&#x5305;&#x62EC;&#x6545;&#x969C;&#x57DF;&#x548C;&#x6F5C;&#x5728;&#x7684;&#x6027;&#x80FD;&#x95EE;&#x9898;&#x3002;
&#x786C;&#x4EF6;&#x89C4;&#x5212;&#x5E94;&#x8BE5;&#x5305;&#x62EC;&#x5728;&#x591A;&#x4E2A;&#x4E3B;&#x673A;&#x4E0A;&#x5206;&#x5E03;<code>Ceph</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x548C;&#x5176;&#x4ED6;&#x4F7F;&#x7528;<code>Ceph</code>&#x7684;&#x8FDB;&#x7A0B;&#x3002;&#x5B98;&#x65B9;&#x5EFA;&#x8BAE;&#x5728;&#x4E3A;&#x7279;&#x5B9A;&#x7C7B;&#x578B;&#x7684;&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x914D;&#x7F6E;&#x7684;&#x4E3B;&#x673A;&#x4E0A;&#x8FD0;&#x884C;&#x7279;&#x5B9A;&#x7C7B;&#x578B;&#x7684;<code>Ceph</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x3002;</p>
<p>&#x5373;<code>ceph</code>&#x96C6;&#x7FA4;&#x4E0E;&#x5BA2;&#x6237;&#x7AEF;&#x5E94;&#x4E3A;&#x4E0D;&#x540C;&#x5BBF;&#x4E3B;&#x673A;&#xFF0C;&#x5177;&#x4F53;&#x786C;&#x4EF6;&#x9700;&#x6C42;&#x53C2;&#x8003;&#x5982;&#x4E0B;&#xFF1A;</p>
<h3 id="cpu"><a name="cpu" class="anchor-navigation-ex-anchor" href="#cpu"><i class="fa fa-link" aria-hidden="true"></i></a>CPU</h3>
<p><code>Ceph</code>&#x5143;&#x6570;&#x636E;&#x670D;&#x52A1;&#x5668;&#x52A8;&#x6001;&#x5730;&#x91CD;&#x65B0;&#x5206;&#x914D;&#x5B83;&#x4EEC;&#x7684;&#x8D1F;&#x8F7D;&#xFF0C;&#x8FD9;&#x662F;<code>CPU</code>&#x5BC6;&#x96C6;&#x578B;&#x7684;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5143;&#x6570;&#x636E;&#x670D;&#x52A1;&#x5668;&#x5E94;&#x8BE5;&#x5177;&#x6709;&#x5F3A;&#x5927;&#x7684;&#x5904;&#x7406;&#x80FD;&#x529B;(&#x4F8B;&#x5982;&#xFF0C;&#x56DB;&#x6838;&#x6216;&#x66F4;&#x597D;&#x7684;cpu)&#x3002;<code>ceph osds</code>&#x8FD0;&#x884C;<code>RADOS</code>&#x670D;&#x52A1;&#xFF0C;&#x4F7F;&#x7528;<code>CRUSH</code>&#x8BA1;&#x7B97;&#x6570;&#x636E;&#x4F4D;&#x7F6E;&#xFF0C;&#x590D;&#x5236;&#x6570;&#x636E;&#xFF0C;&#x5E76;&#x7EF4;&#x62A4;&#x5B83;&#x4EEC;&#x81EA;&#x5DF1;&#x7684;&#x96C6;&#x7FA4;&#x6620;&#x5C04;&#x526F;&#x672C;&#x3002;
&#x56E0;&#x6B64;&#xFF0C;<code>OSD</code>&#x5E94;&#x8BE5;&#x5177;&#x6709;&#x5408;&#x7406;&#x7684;&#x5904;&#x7406;&#x80FD;&#x529B;(&#x4F8B;&#x5982;&#xFF0C;&#x53CC;&#x6838;&#x5904;&#x7406;&#x5668;)&#x3002;&#x76D1;&#x89C6;&#x5668;&#x53EA;&#x662F;&#x7EF4;&#x62A4;&#x96C6;&#x7FA4;&#x6620;&#x5C04;&#x7684;&#x4E3B;&#x526F;&#x672C;&#xFF0C;&#x56E0;&#x6B64;&#x5B83;&#x4EEC;&#x4E0D;&#x662F;<code>CPU</code>&#x5BC6;&#x96C6;&#x578B;&#x7684;&#x3002;
&#x60A8;&#x8FD8;&#x5FC5;&#x987B;&#x8003;&#x8651;&#x4E3B;&#x673A;&#x9664;&#x4E86;&#x8FD0;&#x884C;<code>Ceph</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x5916;&#xFF0C;&#x662F;&#x5426;&#x8FD8;&#x5C06;&#x8FD0;&#x884C;<code>cpu</code>&#x5BC6;&#x96C6;&#x578B;&#x8FDB;&#x7A0B;&#x3002;
&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x60A8;&#x7684;&#x4E3B;&#x673A;&#x5C06;&#x8FD0;&#x884C;&#x8BA1;&#x7B97;&#x865A;&#x62DF;&#x673A;(&#x4F8B;&#x5982;<code>OpenStack Nova</code>)&#xFF0C;&#x60A8;&#x5C06;&#x9700;&#x8981;&#x786E;&#x4FDD;&#x8FD9;&#x4E9B;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x4E3A;<code>Ceph</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x7559;&#x51FA;&#x8DB3;&#x591F;&#x7684;&#x5904;&#x7406;&#x80FD;&#x529B;&#x3002;
&#x5EFA;&#x8BAE;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x4E3B;&#x673A;&#x4E0A;&#x8FD0;&#x884C;&#x989D;&#x5916;&#x7684;<code>cpu</code>&#x5BC6;&#x96C6;&#x578B;&#x8FDB;&#x7A0B;</p>
<p><strong>&#x6837;&#x4F8B;&#x96C6;&#x7FA4;CPU&#x914D;&#x7F6E;&#xFF1A;</strong></p>
<pre class="language-"><code>Architecture:          x86_64
CPU op-mode(s):        32-bit, 64-bit
Byte Order:            Little Endian
CPU(s):                72
On-line CPU(s) list:   0-71
Thread(s) per core:    2
Core(s) per socket:    18
Socket(s):             2
NUMA node(s):          2
Vendor ID:             GenuineIntel
CPU family:            6
Model:                 85
Model name:            Intel(R) Xeon(R) Gold 6240 CPU @ 2.60GHz
Stepping:              7
CPU MHz:               999.914
CPU max MHz:           3900.0000
CPU min MHz:           1000.0000
BogoMIPS:              5200.00
Virtualization:        VT-x
L1d cache:             32K
L1i cache:             32K
L2 cache:              1024K
L3 cache:              25344K
NUMA node0 CPU(s):     0-17,36-53
NUMA node1 CPU(s):     18-35,54-71
Flags:                 fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf eagerfpu pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch epb cat_l3 cdp_l3 invpcid_single intel_ppin intel_pt ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow vnmi flexpriority ept vpid fsgsbase tsc_adjust bmi1 hle avx2 smep bmi2 erms invpcid rtm cqm mpx rdt_a avx512f avx512dq rdseed adx smap clflushopt clwb avx512cd avx512bw avx512vl xsaveopt xsavec xgetbv1 cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local dtherm ida arat pln pts hwp hwp_act_window hwp_epp hwp_pkg_req pku ospke avx512_vnni md_clear spec_ctrl intel_stibp flush_l1d arch_capabilities
</code></pre><h3 id="&#x5185;&#x5B58;"><a name="&#x5185;&#x5B58;" class="anchor-navigation-ex-anchor" href="#&#x5185;&#x5B58;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5185;&#x5B58;</h3>
<p>&#x5185;&#x5B58;&#x8D8A;&#x591A;&#x8D8A;&#x597D;</p>
<ul>
<li><p><code>CEPH-MON</code>&amp;<code>CEPH-MGR</code>&#xFF08;&#x76D1;&#x63A7;&#x3001;&#x7BA1;&#x7406;&#x8282;&#x70B9;&#xFF09;</p>
<p>  &#x76D1;&#x89C6;&#x5668;&#x548C;&#x7BA1;&#x7406;&#x5668;&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x7684;&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x60C5;&#x51B5;&#x901A;&#x5E38;&#x968F;&#x96C6;&#x7FA4;&#x7684;&#x5927;&#x5C0F;&#x800C;&#x53D8;&#x5316;&#x3002;&#x5BF9;&#x4E8E;&#x5C0F;&#x578B;&#x96C6;&#x7FA4;&#xFF0C;&#x4E00;&#x822C;1-2<code>GB</code>&#x5C31;&#x8DB3;&#x591F;&#x4E86;&#x3002;&#x5BF9;&#x4E8E;&#x5927;&#x578B;&#x96C6;&#x7FA4;&#xFF0C;&#x60A8;&#x5E94;&#x8BE5;&#x63D0;&#x4F9B;&#x66F4;&#x591A;(5-10<code>GB</code>)&#x3002;&#x60A8;&#x53EF;&#x80FD;&#x8FD8;&#x9700;&#x8981;&#x8003;&#x8651;&#x8C03;&#x6574;<code>mon_OSD_cache_size</code>&#x6216;<code>rocksdb_cache_size</code>&#x7B49;&#x8BBE;&#x7F6E;</p>
</li>
<li><p><code>CEPH-MDS</code>&#x5143;&#x6570;&#x636E;&#x8282;&#x70B9;</p>
<p>  &#x5143;&#x6570;&#x636E;&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x7684;&#x5185;&#x5B58;&#x5229;&#x7528;&#x7387;&#x53D6;&#x51B3;&#x4E8E;&#x5B83;&#x7684;&#x7F13;&#x5B58;&#x88AB;&#x914D;&#x7F6E;&#x4E3A;&#x6D88;&#x8017;&#x591A;&#x5C11;&#x5185;&#x5B58;&#x3002;&#x5BF9;&#x4E8E;&#x5927;&#x591A;&#x6570;&#x7CFB;&#x7EDF;&#xFF0C;&#x5B98;&#x65B9;&#x5EFA;&#x8BAE;&#x81F3;&#x5C11;&#x4F7F;&#x7528;1<code>GB</code>&#x3002;&#x5177;&#x4F53;&#x5927;&#x5C0F;&#x53EF;&#x8C03;&#x6574;<code>mds_cache_memory</code></p>
</li>
<li><p><code>OSDS</code>(<code>CEPH-OSD</code>)&#x5B58;&#x50A8;&#x8282;&#x70B9;</p>
<p>  &#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4F7F;&#x7528;<code>BlueStore</code>&#x540E;&#x7AEF;&#x7684;<code>OSD</code>&#x9700;&#x8981;3-5<code>GB</code> <code>RAM</code>&#x3002;&#x5F53;&#x4F7F;&#x7528;<code>BlueStore</code>&#x65F6;&#xFF0C;
  &#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x914D;&#x7F6E;&#x9009;&#x9879;<code>OSD_memory_target</code>&#x6765;&#x8C03;&#x6574;<code>OSD</code>&#x7684;&#x5185;&#x5B58;&#x6D88;&#x8017;&#x3002;&#x5F53;&#x4F7F;&#x7528;&#x9057;&#x7559;&#x7684;<code>FileStore</code>&#x540E;&#x7AEF;&#x65F6;&#xFF0C;
  &#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x9875;&#x9762;&#x7F13;&#x5B58;&#x7528;&#x4E8E;&#x7F13;&#x5B58;&#x6570;&#x636E;&#xFF0C;&#x6240;&#x4EE5;&#x901A;&#x5E38;&#x4E0D;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x8C03;&#x4F18;&#xFF0C;&#x5E76;&#x4E14;<code>OSD</code>&#x7684;&#x5185;&#x5B58;&#x6D88;&#x8017;&#x901A;&#x5E38;&#x4E0E;&#x7CFB;&#x7EDF;&#x4E2D;&#x6BCF;&#x4E2A;&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x7684;<code>PGs</code>&#x6570;&#x91CF;&#x6709;&#x5173;&#x3002;</p>
</li>
</ul>
<p><strong>&#x6837;&#x4F8B;&#x96C6;&#x7FA4;&#x5185;&#x5B58;&#x914D;&#x7F6E;&#xFF1A;</strong></p>
<pre class="language-"><code>              total        used        free      shared  buff/cache   available
Mem:           187G        8.8G        164G        4.0G         13G        173G
Swap:            0B          0B          0B
</code></pre><h3 id="&#x5B58;&#x50A8;"><a name="&#x5B58;&#x50A8;" class="anchor-navigation-ex-anchor" href="#&#x5B58;&#x50A8;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5B58;&#x50A8;</h3>
<p>&#x8BF7;&#x4ED4;&#x7EC6;&#x89C4;&#x5212;&#x60A8;&#x7684;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x914D;&#x7F6E;&#x3002;&#x5728;&#x89C4;&#x5212;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x8003;&#x8651;&#x5927;&#x91CF;&#x7684;&#x6210;&#x672C;&#x548C;&#x6027;&#x80FD;&#x6298;&#x8877;&#x3002;
&#x540C;&#x65F6;&#x8FDB;&#x884C;<code>OS</code>&#x64CD;&#x4F5C;&#xFF0C;&#x4EE5;&#x53CA;&#x591A;&#x4E2A;&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x5BF9;&#x5355;&#x4E2A;&#x9A71;&#x52A8;&#x5668;&#x540C;&#x65F6;&#x8FDB;&#x884C;&#x8BFB;&#x548C;&#x5199;&#x64CD;&#x4F5C;&#x7684;&#x8BF7;&#x6C42;&#x4F1A;&#x663E;&#x8457;&#x964D;&#x4F4E;&#x6027;&#x80FD;&#x3002;</p>
<p><strong>&#x6CE8;&#x610F;&#xFF1A;</strong></p>
<p>&#x56E0;&#x4E3A;<code>Ceph</code>&#x5728;&#x53D1;&#x9001;<code>ACK</code>&#x4E4B;&#x524D;&#x5FC5;&#x987B;&#x628A;&#x6240;&#x6709;&#x7684;&#x6570;&#x636E;&#x90FD;&#x5199;&#x5230;&#x65E5;&#x5FD7;&#x4E2D;(&#x81F3;&#x5C11;&#x5BF9;&#x4E8E;<code>XFS</code>&#x6765;&#x8BF4;&#x662F;&#x8FD9;&#x6837;)&#xFF0C;&#x8BA9;&#x65E5;&#x5FD7;&#x548C;<code>OSD</code>&#x7684;&#x6027;&#x80FD;&#x5E73;&#x8861;&#x662F;&#x975E;&#x5E38;&#x91CD;&#x8981;&#x7684;!</p>
<ul>
<li><p>&#x786C;&#x76D8;&#x9A71;&#x52A8;&#x5668;</p>
<p>  <code>OSD</code>&#x5E94;&#x8BE5;&#x6709;&#x8DB3;&#x591F;&#x7684;&#x786C;&#x76D8;&#x9A71;&#x52A8;&#x5668;&#x7A7A;&#x95F4;&#x6765;&#x5B58;&#x653E;&#x5BF9;&#x8C61;&#x6570;&#x636E;&#x3002;&#x5B98;&#x65B9;&#x5EFA;&#x8BAE;&#x786C;&#x76D8;&#x9A71;&#x52A8;&#x5668;&#x7684;&#x6700;&#x5C0F;&#x5927;&#x5C0F;&#x4E3A;1<code>TB</code>&#x3002;
  &#x8003;&#x8651;&#x8F83;&#x5927;&#x78C1;&#x76D8;&#x7684;&#x6BCF;<code>GB</code>&#x6210;&#x672C;&#x4F18;&#x52BF;&#x3002;&#x5B98;&#x65B9;&#x5EFA;&#x8BAE;&#x5C06;&#x786C;&#x76D8;&#x9A71;&#x52A8;&#x5668;&#x7684;&#x4EF7;&#x683C;&#x9664;&#x4EE5;&#x5343;&#x5146;&#x5B57;&#x8282;&#x6570;&#xFF0C;&#x5F97;&#x51FA;&#x6BCF;&#x5343;&#x5146;&#x5B57;&#x8282;&#x7684;&#x6210;&#x672C;&#xFF0C;&#x56E0;&#x4E3A;&#x8F83;&#x5927;&#x7684;&#x9A71;&#x52A8;&#x5668;&#x53EF;&#x80FD;&#x5BF9;&#x6BCF;&#x5343;&#x5146;&#x5B57;&#x8282;&#x7684;&#x6210;&#x672C;&#x6709;&#x5F88;&#x5927;&#x7684;&#x5F71;&#x54CD;&#x3002;
  &#x4F8B;&#x5982;&#xFF0C;&#x4EF7;&#x683C;&#x4E3A;$75.00&#x7684;1<code>TB</code>&#x786C;&#x76D8;&#x7684;&#x6210;&#x672C;&#x4E3A;&#x6BCF;<code>GB</code>$0.07(&#x5373;$75 / 1024 = 0.0732)&#x3002;
  &#x76F8;&#x6BD4;&#x4E4B;&#x4E0B;&#xFF0C;&#x4EF7;&#x683C;&#x4E3A;150&#x7F8E;&#x5143;&#x7684;3<code>TB</code>&#x786C;&#x76D8;&#x7684;&#x6210;&#x672C;&#x4E3A;&#x6BCF;<code>GB</code> 0.05&#x7F8E;&#x5143;(&#x5373;150&#x7F8E;&#x5143;/ 3072 = 0.0488)&#x3002;
  &#x5728;&#x524D;&#x9762;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528;1<code>TB</code>&#x7684;&#x78C1;&#x76D8;&#x901A;&#x5E38;&#x4F1A;&#x4F7F;&#x6BCF;<code>GB</code>&#x7684;&#x6210;&#x672C;&#x589E;&#x52A0;40%&#x2014;&#x2014;&#x4ECE;&#x800C;&#x5927;&#x5927;&#x964D;&#x4F4E;&#x96C6;&#x7FA4;&#x7684;&#x6210;&#x672C;&#x6548;&#x7387;&#x3002;
  &#x6B64;&#x5916;&#xFF0C;&#x5B58;&#x50A8;&#x9A71;&#x52A8;&#x5668;&#x5BB9;&#x91CF;&#x8D8A;&#x5927;&#xFF0C;&#x6BCF;&#x4E2A;<code>ceph osd</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x9700;&#x8981;&#x7684;&#x5185;&#x5B58;&#x5C31;&#x8D8A;&#x591A;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x5728;&#x91CD;&#x65B0;&#x5E73;&#x8861;&#x3001;&#x56DE;&#x586B;&#x548C;&#x6062;&#x590D;&#x671F;&#x95F4;&#x3002;
  &#x4E00;&#x822C;&#x7684;&#x7ECF;&#x9A8C;&#x6CD5;&#x5219;&#x662F;1<code>TB</code>&#x7684;&#x5B58;&#x50A8;&#x7A7A;&#x95F4;&#x9700;&#x8981;<code>1GB</code>&#x7684;<code>RAM</code></p>
<p>  &#x5B58;&#x50A8;&#x9A71;&#x52A8;&#x5668;&#x53D7;&#x5230;&#x5BFB;&#x9053;&#x65F6;&#x95F4;&#x3001;&#x8BBF;&#x95EE;&#x65F6;&#x95F4;&#x3001;&#x8BFB;&#x548C;&#x5199;&#x65F6;&#x95F4;&#x4EE5;&#x53CA;&#x603B;&#x541E;&#x5410;&#x91CF;&#x7684;&#x9650;&#x5236;&#x3002;
  &#x8FD9;&#x4E9B;&#x7269;&#x7406;&#x9650;&#x5236;&#x4F1A;&#x5F71;&#x54CD;&#x6574;&#x4E2A;&#x7CFB;&#x7EDF;&#x7684;&#x6027;&#x80FD;&#x2014;&#x2014;&#x5C24;&#x5176;&#x662F;&#x5728;&#x6062;&#x590D;&#x8FC7;&#x7A0B;&#x4E2D;&#x3002;
  &#x5B98;&#x65B9;&#x5EFA;&#x8BAE;&#x4E3A;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x548C;&#x8F6F;&#x4EF6;&#x4F7F;&#x7528;&#x4E13;&#x7528;&#x7684;&#x9A71;&#x52A8;&#x5668;&#xFF0C;&#x4E3A;&#x4E3B;&#x673A;&#x4E0A;&#x8FD0;&#x884C;&#x7684;&#x6BCF;&#x4E2A;<code>ceph osd</code>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x9A71;&#x52A8;&#x5668;(&#x7269;&#x7406;&#x786C;&#x76D8;)&#x3002;
  &#x5927;&#x591A;&#x6570;<code>&#x6162;OSD</code>&#x95EE;&#x9898;&#x662F;&#x7531;&#x4E8E;&#x5728;&#x540C;&#x4E00;&#x4E2A;&#x9A71;&#x52A8;&#x5668;&#x4E0A;&#x8FD0;&#x884C;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x3001;&#x591A;&#x4E2A;<code>OSD</code>&#x548C;/&#x6216;&#x591A;&#x4E2A;&#x65E5;&#x5FD7;&#x5F15;&#x8D77;&#x7684;&#x3002;
  &#x7531;&#x4E8E;&#x5728;&#x5C0F;&#x578B;&#x96C6;&#x7FA4;&#x4E0A;&#x6545;&#x969C;&#x6392;&#x9664;&#x6027;&#x80FD;&#x95EE;&#x9898;&#x7684;&#x6210;&#x672C;&#x53EF;&#x80FD;&#x4F1A;&#x8D85;&#x8FC7;&#x989D;&#x5916;&#x78C1;&#x76D8;&#x9A71;&#x52A8;&#x5668;&#x7684;&#x6210;&#x672C;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x907F;&#x514D;&#x8FC7;&#x5EA6;&#x4F7F;&#x7528;<code>OSD</code>&#x5B58;&#x50A8;&#x9A71;&#x52A8;&#x5668;&#x6765;&#x52A0;&#x901F;&#x96C6;&#x7FA4;&#x8BBE;&#x8BA1;&#x89C4;&#x5212;</p>
<p>  &#x60A8;&#x53EF;&#x4EE5;&#x5728;&#x6BCF;&#x4E2A;&#x786C;&#x76D8;&#x9A71;&#x52A8;&#x5668;&#x4E0A;&#x8FD0;&#x884C;&#x591A;&#x4E2A;<code>ceph osd</code>&#x8FDB;&#x7A0B;&#xFF0C;&#x4F46;&#x8FD9;&#x53EF;&#x80FD;&#x4F1A;&#x5BFC;&#x81F4;&#x8D44;&#x6E90;&#x4E89;&#x7528;&#xFF0C;&#x5E76;&#x964D;&#x4F4E;&#x603B;&#x4F53;&#x541E;&#x5410;&#x91CF;&#x3002;
  &#x60A8;&#x53EF;&#x4EE5;&#x5C06;&#x65E5;&#x5FD7;&#x548C;&#x5BF9;&#x8C61;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x5728;&#x540C;&#x4E00;&#x4E2A;&#x9A71;&#x52A8;&#x5668;&#x4E0A;&#xFF0C;&#x4F46;&#x8FD9;&#x53EF;&#x80FD;&#x4F1A;&#x589E;&#x52A0;&#x5411;&#x5BA2;&#x6237;&#x7AEF;&#x8BB0;&#x5F55;&#x5199;&#x64CD;&#x4F5C;&#x548C;<code>ACK</code>&#x6240;&#x9700;&#x7684;&#x65F6;&#x95F4;&#x3002;
  <code>Ceph</code>&#x5FC5;&#x987B;&#x5148;&#x5411;&#x65E5;&#x5FD7;&#x5199;&#x5165;&#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x624D;&#x80FD;&#x5BF9;&#x5199;&#x5165;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x9A8C;&#x8BC1;</p>
</li>
</ul>
<p><strong>&#x603B;&#x7ED3;&#x4E3A;&#xFF1A;<code>Ceph</code>&#x6700;&#x4F73;&#x5B9E;&#x8DF5;&#x89C4;&#x5B9A;&#xFF0C;&#x60A8;&#x5E94;&#x8BE5;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x9A71;&#x52A8;&#x5668;&#x4E0A;&#x8FD0;&#x884C;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x3001;<code>OSD</code>&#x6570;&#x636E;&#x548C;<code>OSD</code>&#x65E5;&#x5FD7;</strong></p>
<ul>
<li><p>&#x56FA;&#x6001;&#x786C;&#x76D8;</p>
<p>  &#x63D0;&#x9AD8;&#x6027;&#x80FD;&#x7684;&#x4E00;&#x4E2A;&#x673A;&#x4F1A;&#x662F;&#x4F7F;&#x7528;&#x56FA;&#x6001;&#x9A71;&#x52A8;&#x5668;(SSD)&#x6765;&#x51CF;&#x5C11;&#x968F;&#x673A;&#x8BBF;&#x95EE;&#x65F6;&#x95F4;&#x548C;&#x8BFB;&#x53D6;&#x5EF6;&#x8FDF;&#xFF0C;&#x540C;&#x65F6;&#x52A0;&#x901F;&#x541E;&#x5410;&#x91CF;&#x3002;
  &#x4E0E;&#x786C;&#x76D8;&#x9A71;&#x52A8;&#x5668;&#x76F8;&#x6BD4;&#xFF0C;<code>SSD</code>&#x6BCF;<code>GB</code>&#x7684;&#x6210;&#x672C;&#x901A;&#x5E38;&#x8D85;&#x8FC7;10&#x500D;&#xFF0C;&#x4F46;<code>SSD</code>&#x7684;&#x8BBF;&#x95EE;&#x65F6;&#x95F4;&#x901A;&#x5E38;&#x81F3;&#x5C11;&#x6BD4;&#x786C;&#x76D8;&#x9A71;&#x52A8;&#x5668;&#x5FEB;100&#x500D;</p>
<p>  <code>SSD</code>&#x6CA1;&#x6709;&#x53EF;&#x79FB;&#x52A8;&#x7684;&#x673A;&#x68B0;&#x90E8;&#x4EF6;&#xFF0C;&#x56E0;&#x6B64;&#x5B83;&#x4EEC;&#x4E0D;&#x5FC5;&#x53D7;&#x5230;&#x4E0E;&#x786C;&#x76D8;&#x9A71;&#x52A8;&#x5668;&#x76F8;&#x540C;&#x7C7B;&#x578B;&#x7684;&#x9650;&#x5236;&#x3002;&#x4E0D;&#x8FC7;<code>SSD</code>&#x786E;&#x5B9E;&#x6709;&#x5F88;&#x5927;&#x7684;&#x5C40;&#x9650;&#x6027;&#x3002;
  &#x5728;&#x8BC4;&#x4F30;<code>SSD</code>&#x65F6;&#xFF0C;&#x8003;&#x8651;&#x987A;&#x5E8F;&#x8BFB;&#x5199;&#x7684;&#x6027;&#x80FD;&#x662F;&#x5F88;&#x91CD;&#x8981;&#x7684;&#x3002;
  &#x5F53;&#x5B58;&#x50A8;&#x591A;&#x4E2A;<code>OSD</code>&#x7684;&#x591A;&#x4E2A;&#x65E5;&#x5FD7;&#x65F6;&#xFF0C;&#x987A;&#x5E8F;&#x5199;&#x541E;&#x5410;&#x91CF;&#x4E3A;400MB/s&#x7684;<code>SSD</code>&#x53EF;&#x80FD;&#x6BD4;&#x987A;&#x5E8F;&#x5199;&#x541E;&#x5410;&#x91CF;&#x4E3A;120MB/s&#x7684;<code>SSD</code>&#x6027;&#x80FD;&#x66F4;&#x597D;</p>
<p>  &#x7531;&#x4E8E;<code>SSD</code>&#x6CA1;&#x6709;&#x53EF;&#x79FB;&#x52A8;&#x7684;&#x673A;&#x68B0;&#x90E8;&#x4EF6;&#xFF0C;&#x6240;&#x4EE5;&#x5728;<code>Ceph</code>&#x4E2D;&#x4E0D;&#x9700;&#x8981;&#x5927;&#x91CF;&#x5B58;&#x50A8;&#x7A7A;&#x95F4;&#x7684;&#x533A;&#x57DF;&#x4F7F;&#x7528;<code>SSD</code>&#x662F;&#x6709;&#x610F;&#x4E49;&#x7684;&#x3002;
  &#x76F8;&#x5BF9;&#x4FBF;&#x5B9C;&#x7684;&#x56FA;&#x6001;&#x786C;&#x76D8;&#x53EF;&#x80FD;&#x4F1A;&#x5438;&#x5F15;&#x4F60;&#x7684;&#x7ECF;&#x6D4E;&#x610F;&#x8BC6;&#x3002;&#x8C28;&#x614E;&#x4F7F;&#x7528;&#x3002;
  &#x5F53;&#x9009;&#x62E9;&#x4E0E;<code>Ceph</code>&#x4E00;&#x8D77;&#x4F7F;&#x7528;&#x7684;<code>SSD</code>&#x65F6;&#xFF0C;&#x53EF;&#x63A5;&#x53D7;&#x7684;<code>IOPS</code>&#x662F;&#x4E0D;&#x591F;&#x7684;&#x3002;&#x5BF9;&#x4E8E;&#x65E5;&#x5FD7;&#x548C;<code>SSD</code>&#x6709;&#x51E0;&#x4E2A;&#x91CD;&#x8981;&#x7684;&#x6027;&#x80FD;&#x8003;&#x8651;&#x56E0;&#x7D20;:</p>
<ul>
<li>&#x5199;&#x5BC6;&#x96C6;&#x578B;&#x8BED;&#x4E49;:&#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x6D89;&#x53CA;&#x5199;&#x5BC6;&#x96C6;&#x578B;&#x8BED;&#x4E49;&#xFF0C;&#x56E0;&#x6B64;&#x60A8;&#x5E94;&#x8BE5;&#x786E;&#x4FDD;&#x9009;&#x62E9;&#x90E8;&#x7F72;&#x7684;<code>SSD</code>&#x5728;&#x5199;&#x5165;&#x6570;&#x636E;&#x65F6;&#x7684;&#x6027;&#x80FD;&#x7B49;&#x4E8E;&#x6216;&#x4F18;&#x4E8E;&#x786C;&#x76D8;&#x9A71;&#x52A8;&#x5668;&#x3002;
&#x5EC9;&#x4EF7;&#x7684;<code>SSD</code>&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x52A0;&#x901F;&#x8BBF;&#x95EE;&#x65F6;&#x95F4;&#x7684;&#x540C;&#x65F6;&#x5F15;&#x5165;&#x5199;&#x5EF6;&#x8FDF;&#xFF0C;&#x56E0;&#x4E3A;&#x6709;&#x65F6;&#x9AD8;&#x6027;&#x80FD;&#x786C;&#x76D8;&#x9A71;&#x52A8;&#x5668;&#x7684;&#x5199;&#x901F;&#x5EA6;&#x53EF;&#x4EE5;&#x4E0E;&#x5E02;&#x573A;&#x4E0A;&#x4E00;&#x4E9B;&#x66F4;&#x7ECF;&#x6D4E;&#x7684;<code>SSD</code>&#x4E00;&#x6837;&#x5FEB;&#x751A;&#x81F3;&#x66F4;&#x5FEB;!</li>
<li>&#x987A;&#x5E8F;&#x5199;:&#x5F53;&#x60A8;&#x5728;&#x4E00;&#x4E2A;<code>SSD</code>&#x4E0A;&#x5B58;&#x50A8;&#x591A;&#x4E2A;&#x65E5;&#x5FD7;&#x65F6;&#xFF0C;&#x60A8;&#x8FD8;&#x5FC5;&#x987B;&#x8003;&#x8651;<code>SSD</code>&#x7684;&#x987A;&#x5E8F;&#x5199;&#x9650;&#x5236;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x53EF;&#x80FD;&#x4F1A;&#x540C;&#x65F6;&#x5904;&#x7406;&#x591A;&#x4E2A;<code>OSD</code>&#x65E5;&#x5FD7;&#x7684;&#x5199;&#x8BF7;&#x6C42;&#x3002;</li>
<li><p>&#x5206;&#x533A;&#x5BF9;&#x9F50;:<code>SSD</code>&#x6027;&#x80FD;&#x7684;&#x4E00;&#x4E2A;&#x5E38;&#x89C1;&#x95EE;&#x9898;&#x662F;&#xFF0C;&#x4EBA;&#x4EEC;&#x559C;&#x6B22;&#x5C06;&#x9A71;&#x52A8;&#x5668;&#x5206;&#x533A;&#x4F5C;&#x4E3A;&#x6700;&#x4F73;&#x5B9E;&#x8DF5;&#xFF0C;&#x4F46;&#x4ED6;&#x4EEC;&#x5E38;&#x5E38;&#x5FFD;&#x7565;&#x4E86;&#x4F7F;&#x7528;<code>SSD</code>&#x8FDB;&#x884C;&#x6B63;&#x786E;&#x7684;&#x5206;&#x533A;&#x5BF9;&#x9F50;&#xFF0C;&#x8FD9;&#x53EF;&#x80FD;&#x5BFC;&#x81F4;<code>SSD</code>&#x4F20;&#x8F93;&#x6570;&#x636E;&#x7684;&#x901F;&#x5EA6;&#x6162;&#x5F97;&#x591A;&#x3002;&#x786E;&#x4FDD;<code>SSD</code>&#x5206;&#x533A;&#x5BF9;&#x9F50;</p>
<p>&#x867D;&#x7136;<code>SSD</code>&#x5B58;&#x50A8;&#x5BF9;&#x8C61;&#x7684;&#x6210;&#x672C;&#x975E;&#x5E38;&#x9AD8;&#xFF0C;&#x4F46;&#x662F;&#x901A;&#x8FC7;&#x5C06;<code>OSD</code>&#x7684;&#x65E5;&#x5FD7;&#x5B58;&#x50A8;&#x5728;<code>SSD</code>&#x4E0A;&#xFF0C;&#x5C06;<code>OSD</code>&#x7684;&#x5BF9;&#x8C61;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x5728;&#x5355;&#x72EC;&#x7684;&#x786C;&#x76D8;&#x9A71;&#x52A8;&#x5668;&#x4E0A;&#xFF0C;&#x53EF;&#x4EE5;&#x663E;&#x8457;&#x63D0;&#x9AD8;<code>OSD</code>&#x7684;&#x6027;&#x80FD;&#x3002;
<code>OSD</code>&#x65E5;&#x5FD7;&#x914D;&#x7F6E;&#x9ED8;&#x8BA4;&#x4E3A;<code>/var/lib/ceph/OSD/$cluster-$id/journal</code>&#x3002;&#x60A8;&#x53EF;&#x4EE5;&#x5C06;&#x6B64;&#x8DEF;&#x5F84;&#x6302;&#x8F7D;&#x5230;<code>SSD</code>&#x6216;<code>SSD</code>&#x5206;&#x533A;&#x4E0A;&#xFF0C;&#x4F7F;&#x5176;&#x4E0E;&#x5BF9;&#x8C61;&#x6570;&#x636E;&#x4E0D;&#x53EA;&#x662F;&#x540C;&#x4E00;&#x4E2A;&#x78C1;&#x76D8;&#x4E0A;&#x7684;&#x6587;&#x4EF6;</p>
<p><code>Ceph</code>&#x52A0;&#x901F;<code>CephFS</code>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x6027;&#x80FD;&#x7684;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#x662F;&#x5C06;<code>CephFS</code>&#x5143;&#x6570;&#x636E;&#x7684;&#x5B58;&#x50A8;&#x4E0E;<code>CephFS</code>&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x7684;&#x5B58;&#x50A8;&#x9694;&#x79BB;&#x3002;
<code>Ceph</code>&#x4E3A;<code>cepfs</code>&#x5143;&#x6570;&#x636E;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x9ED8;&#x8BA4;&#x7684;&#x5143;&#x6570;&#x636E;&#x6C60;&#x3002;&#x60A8;&#x6C38;&#x8FDC;&#x4E0D;&#x5FC5;&#x4E3A;<code>CephFS</code>&#x5143;&#x6570;&#x636E;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6C60;&#xFF0C;&#x4F46;&#x662F;&#x60A8;&#x53EF;&#x4EE5;&#x4E3A;&#x4EC5;&#x6307;&#x5411;&#x4E3B;&#x673A;&#x7684;<code>SSD</code>&#x5B58;&#x50A8;&#x4ECB;&#x8D28;&#x7684;<code>CephFS</code>&#x5143;&#x6570;&#x636E;&#x6C60;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;<code>CRUSH map</code>&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#x3002;</p>
</li>
</ul>
</li>
</ul>
<p><strong>&#x91CD;&#x8981;&#x63D0;&#x793A;: &#x5B98;&#x65B9;&#x5EFA;&#x8BAE;&#x63A2;&#x7D22;<code>SSD</code>&#x7684;&#x4F7F;&#x7528;&#x4EE5;&#x63D0;&#x9AD8;&#x6027;&#x80FD;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5728;&#x5BF9;<code>SSD</code>&#x8FDB;&#x884C;&#x91CD;&#x5927;&#x6295;&#x8D44;&#x4E4B;&#x524D;&#xFF0C;&#x5B98;&#x65B9;&#x5F3A;&#x70C8;&#x5EFA;&#x8BAE;&#x68C0;&#x67E5;<code>SSD</code>&#x7684;&#x6027;&#x80FD;&#x6307;&#x6807;&#xFF0C;&#x5E76;&#x5728;&#x6D4B;&#x8BD5;&#x914D;&#x7F6E;&#x4E2D;&#x6D4B;&#x8BD5;<code>SSD</code>&#xFF0C;&#x4EE5;&#x8BC4;&#x4F30;&#x6027;&#x80FD;</strong></p>
<ul>
<li><p>&#x63A7;&#x5236;&#x5668;</p>
<p>  &#x78C1;&#x76D8;&#x63A7;&#x5236;&#x5668;&#x5BF9;&#x5199;&#x541E;&#x5410;&#x91CF;&#x4E5F;&#x6709;&#x5F88;&#x5927;&#x7684;&#x5F71;&#x54CD;&#x3002;&#x4ED4;&#x7EC6;&#x8003;&#x8651;&#x78C1;&#x76D8;&#x63A7;&#x5236;&#x5668;&#x7684;&#x9009;&#x62E9;&#xFF0C;&#x4EE5;&#x786E;&#x4FDD;&#x5B83;&#x4EEC;&#x4E0D;&#x4F1A;&#x9020;&#x6210;&#x6027;&#x80FD;&#x74F6;&#x9888;&#x3002;</p>
</li>
<li><p>&#x6CE8;&#x610F;&#x4E8B;&#x9879;</p>
<p>  &#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x6BCF;&#x4E2A;&#x4E3B;&#x673A;&#x4E0A;&#x8FD0;&#x884C;&#x591A;&#x4E2A;<code>OSD</code>&#xFF0C;&#x4F46;&#x662F;&#x4F60;&#x5E94;&#x8BE5;&#x786E;&#x4FDD;<code>OSD</code>&#x786C;&#x76D8;&#x7684;&#x603B;&#x541E;&#x5410;&#x91CF;&#x4E0D;&#x8D85;&#x8FC7;&#x5BA2;&#x6237;&#x7AEF;&#x8BFB;&#x5199;&#x6570;&#x636E;&#x6240;&#x9700;&#x7684;&#x7F51;&#x7EDC;&#x5E26;&#x5BBD;&#x3002;
  &#x60A8;&#x8FD8;&#x5E94;&#x8BE5;&#x8003;&#x8651;&#x96C6;&#x7FA4;&#x5728;&#x6BCF;&#x4E2A;&#x4E3B;&#x673A;&#x4E0A;&#x5B58;&#x50A8;&#x7684;&#x603B;&#x4F53;&#x6570;&#x636E;&#x7684;&#x767E;&#x5206;&#x6BD4;&#x3002;&#x5982;&#x679C;&#x67D0;&#x4E2A;&#x4E3B;&#x673A;&#x4E0A;&#x7684;&#x767E;&#x5206;&#x6BD4;&#x5F88;&#x5927;&#xFF0C;&#x5E76;&#x4E14;&#x8BE5;&#x4E3B;&#x673A;&#x53D1;&#x751F;&#x6545;&#x969C;&#xFF0C;&#x90A3;&#x4E48;&#x5B83;&#x53EF;&#x80FD;&#x4F1A;&#x5BFC;&#x81F4;&#x4E00;&#x4E9B;&#x95EE;&#x9898;&#xFF0C;&#x6BD4;&#x5982;&#x8D85;&#x8FC7;&#x4E86;&#x5B8C;&#x6574;&#x7684;&#x6BD4;&#x4F8B;&#xFF0C;&#x8FD9;&#x5C06;&#x5BFC;&#x81F4;<code>Ceph</code>&#x505C;&#x6B62;&#x64CD;&#x4F5C;&#xFF0C;&#x4F5C;&#x4E3A;&#x9632;&#x6B62;&#x6570;&#x636E;&#x4E22;&#x5931;&#x7684;&#x5B89;&#x5168;&#x9884;&#x9632;&#x63AA;&#x65BD;&#x3002;</p>
<p>  &#x5F53;&#x60A8;&#x5728;&#x6BCF;&#x4E2A;&#x4E3B;&#x673A;&#x4E0A;&#x8FD0;&#x884C;&#x591A;&#x4E2A;<code>OSD</code>&#x65F6;&#xFF0C;&#x8FD8;&#x9700;&#x8981;&#x786E;&#x4FDD;&#x5185;&#x6838;&#x662F;&#x6700;&#x65B0;&#x7684;&#x3002;&#x8BF7;&#x53C2;&#x9605;<code>OS</code>&#x63A8;&#x8350;&#xFF0C;&#x4E86;&#x89E3;<code>glibc</code>&#x548C;<code>syncfs(2)</code>&#x65B9;&#x9762;&#x7684;&#x6CE8;&#x610F;&#x4E8B;&#x9879;&#xFF0C;&#x4EE5;&#x786E;&#x4FDD;&#x5728;&#x6BCF;&#x4E2A;&#x4E3B;&#x673A;&#x4E0A;&#x8FD0;&#x884C;&#x591A;&#x4E2A;<code>OSD</code>&#x65F6;&#xFF0C;&#x60A8;&#x7684;&#x786C;&#x4EF6;&#x80FD;&#x591F;&#x50CF;&#x9884;&#x671F;&#x7684;&#x90A3;&#x6837;&#x6267;&#x884C;    </p>
<p>  &#x62E5;&#x6709;&#x5927;&#x91CF;<code>OSD</code>&#x7684;&#x4E3B;&#x673A;(&#x4F8B;&#x5982;&gt; 20)&#x53EF;&#x80FD;&#x4F1A;&#x4EA7;&#x751F;&#x5927;&#x91CF;&#x7EBF;&#x7A0B;&#xFF0C;&#x7279;&#x522B;&#x662F;&#x5728;&#x6062;&#x590D;&#x548C;&#x5E73;&#x8861;&#x8FC7;&#x7A0B;&#x4E2D;&#x3002;&#x8BB8;&#x591A;<code>Linux</code>&#x5185;&#x6838;&#x9ED8;&#x8BA4;&#x7684;&#x6700;&#x5927;&#x7EBF;&#x7A0B;&#x6570;&#x76F8;&#x5BF9;&#x8F83;&#x5C0F;(&#x4F8B;&#x5982;&#xFF0C;32k)&#x3002;&#x5982;&#x679C;&#x5728;&#x62E5;&#x6709;&#x5927;&#x91CF;<code>OSD</code>&#x7684;&#x4E3B;&#x673A;&#x4E0A;&#x542F;&#x52A8;<code>OSD</code>&#x65F6;&#x9047;&#x5230;&#x95EE;&#x9898;&#xFF0C;&#x8BF7;&#x8003;&#x8651;&#x8BBE;&#x7F6E;<code>kernel</code>&#x3002;&#x5C06;<code>pid_max</code>&#x8BBE;&#x7F6E;&#x4E3A;&#x66F4;&#x9AD8;&#x7684;&#x7EBF;&#x7A0B;&#x6570;&#x3002;&#x7406;&#x8BBA;&#x6700;&#x5927;&#x503C;&#x662F;4,194,303&#x7EBF;&#x7A0B;&#x3002;
  &#x4F8B;&#x5982;&#xFF0C;&#x60A8;&#x53EF;&#x4EE5;&#x5C06;&#x4EE5;&#x4E0B;&#x5185;&#x5BB9;&#x6DFB;&#x52A0;&#x5230;<code>/etc/sysctl.conf</code>&#x6587;&#x4EF6;&#x4E2D;: </p>
</li>
</ul>
<pre class="language-"><code>kernel.pid_max = 4194303
</code></pre><p><strong>&#x6837;&#x4F8B;&#x96C6;&#x7FA4;&#x5B58;&#x50A8;&#x914D;&#x7F6E;&#xFF1A;</strong></p>
<pre class="language-"><code>Disk /dev/nvme0n1: 1000.2 GB, 1000204886016 bytes, 1953525168 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes


Disk /dev/nvme1n1: 1000.2 GB, 1000204886016 bytes, 1953525168 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes


Disk /dev/nvme2n1: 1000.2 GB, 1000204886016 bytes, 1953525168 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes


Disk /dev/nvme3n1: 1000.2 GB, 1000204886016 bytes, 1953525168 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes


Disk /dev/sdb: 960.2 GB, 960197124096 bytes, 1875385008 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes

WARNING: fdisk GPT support is currently new, and therefore in an experimental phase. Use at your own discretion.

Disk /dev/sda: 480.1 GB, 480103981056 bytes, 937703088 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes
Disk label type: gpt
Disk identifier: EDC26861-DACE-4831-848D-4FA0C5F642D7


#         Start          End    Size  Type            Name
 1         2048      2099199      1G  EFI System      EFI System Partition
 2      2099200      4196351      1G  Microsoft basic
 3      4196352    937701375  445.1G  Linux LVM

Disk /dev/sde: 960.2 GB, 960197124096 bytes, 1875385008 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes


Disk /dev/sdd: 960.2 GB, 960197124096 bytes, 1875385008 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes


Disk /dev/sdg: 960.2 GB, 960197124096 bytes, 1875385008 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes


Disk /dev/sdf: 960.2 GB, 960197124096 bytes, 1875385008 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes

WARNING: fdisk GPT support is currently new, and therefore in an experimental phase. Use at your own discretion.

Disk /dev/sdh: 960.2 GB, 960197124096 bytes, 1875385008 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes
Disk label type: gpt
Disk identifier: 5F151167-14E6-4826-BBEB-55280AC27EEC


#         Start          End    Size  Type            Name
 1     10487808   1875384974  889.3G  ceph osd        ceph data
 2         2048     10487807      5G  Ceph Journal    ceph journal

Disk /dev/sdc: 960.2 GB, 960197124096 bytes, 1875385008 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes

Disk /dev/mapper/centos-root: 478.0 GB, 477953523712 bytes, 933502976 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes
</code></pre><h3 id="&#x7F51;&#x7EDC;"><a name="&#x7F51;&#x7EDC;" class="anchor-navigation-ex-anchor" href="#&#x7F51;&#x7EDC;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x7F51;&#x7EDC;</h3>
<p>&#x5B98;&#x65B9;&#x8BF4;&#x660E;&#x5982;&#x4E0B;:</p>
<ul>
<li>&#x6BCF;&#x4E2A;&#x4E3B;&#x673A;&#x81F3;&#x5C11;&#x6709;&#x4E24;&#x4E2A;<code>1Gbps</code>&#x7684;&#x7F51;&#x7EDC;&#x63A5;&#x53E3;&#x63A7;&#x5236;&#x5668;(<code>nic</code>)&#x3002;&#x7531;&#x4E8E;&#x5927;&#x591A;&#x6570;&#x666E;&#x901A;&#x786C;&#x76D8;&#x9A71;&#x52A8;&#x5668;&#x7684;&#x541E;&#x5410;&#x91CF;&#x5927;&#x7EA6;&#x4E3A;100MB/&#x79D2;&#xFF0C;&#x60A8;&#x7684;&#x7F51;&#x5361;&#x5E94;&#x8BE5;&#x80FD;&#x591F;&#x5904;&#x7406;&#x4E3B;&#x673A;&#x4E0A;<code>OSD</code>&#x78C1;&#x76D8;&#x7684;&#x6D41;&#x91CF;</li>
<li>&#x5EFA;&#x8BAE;&#x81F3;&#x5C11;&#x4F7F;&#x7528;&#x4E24;&#x4E2A;&#x7F51;&#x5361;&#x6765;&#x8003;&#x8651;&#x516C;&#x5171;(&#x524D;&#x7AEF;)&#x7F51;&#x7EDC;&#x548C;&#x96C6;&#x7FA4;(&#x540E;&#x7AEF;)&#x7F51;&#x7EDC;&#x3002;&#x96C6;&#x7FA4;&#x7F51;&#x7EDC;(&#x6700;&#x597D;&#x4E0D;&#x8FDE;&#x63A5;&#x5230;&#x5916;&#x90E8;&#x7F51;&#x7EDC;)&#x5904;&#x7406;&#x6570;&#x636E;&#x590D;&#x5236;&#x7684;&#x989D;&#x5916;&#x8D1F;&#x8F7D;</li>
<li>&#x901A;&#x8FC7;<code>1Gbps</code>&#x7684;&#x7F51;&#x7EDC;&#x590D;&#x5236;<code>1TB</code>&#x7684;&#x6570;&#x636E;&#x9700;&#x8981;3&#x4E2A;&#x5C0F;&#x65F6;&#xFF0C;<code>3TB</code>(&#x5178;&#x578B;&#x7684;&#x9A71;&#x52A8;&#x5668;&#x914D;&#x7F6E;)&#x9700;&#x8981;9&#x4E2A;&#x5C0F;&#x65F6;&#x3002;&#x76F8;&#x6BD4;&#x4E4B;&#x4E0B;&#xFF0C;&#x5728;<code>10Gbps</code>&#x7684;&#x7F51;&#x7EDC;&#x4E2D;&#xFF0C;&#x590D;&#x5236;&#x65F6;&#x95F4;&#x5C06;&#x5206;&#x522B;&#x4E3A;20&#x5206;&#x949F;&#x548C;1&#x5C0F;&#x65F6;&#x3002;</li>
<li>&#x5728;<code>pb</code>&#x7EA7;&#x96C6;&#x7FA4;&#x4E2D;&#xFF0C;<code>OSD</code>&#x78C1;&#x76D8;&#x6545;&#x969C;&#x5E94;&#x8BE5;&#x662F;&#x4E00;&#x79CD;&#x9884;&#x671F;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x5F02;&#x5E38;&#x3002;&#x7CFB;&#x7EDF;&#x7BA1;&#x7406;&#x5458;&#x5E0C;&#x671B;<code>PGs</code>&#x5C3D;&#x53EF;&#x80FD;&#x5FEB;&#x5730;&#x4ECE;&#x964D;&#x7EA7;&#x72B6;&#x6001;&#x6062;&#x590D;&#x5230;<code>active + clean</code>&#x72B6;&#x6001;&#xFF0C;&#x540C;&#x65F6;&#x8003;&#x8651;&#x5230;&#x4EF7;&#x683C;/&#x6027;&#x80FD;&#x6743;&#x8861;&#x3002;
&#x6B64;&#x5916;&#xFF0C;&#x4E00;&#x4E9B;&#x90E8;&#x7F72;&#x5DE5;&#x5177;(&#x5982;&#x6234;&#x5C14;&#x7684;Crowbar)&#x53EF;&#x4EE5;&#x90E8;&#x7F72;5&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x7F51;&#x7EDC;&#xFF0C;&#x4F46;&#x4F7F;&#x7528;<code>vlan</code>&#x4F7F;&#x786C;&#x4EF6;&#x548C;&#x7F51;&#x7EDC;&#x7535;&#x7F06;&#x66F4;&#x6613;&#x4E8E;&#x7BA1;&#x7406;&#x3002;&#x4F7F;&#x7528;<code>802.1q</code>&#x534F;&#x8BAE;&#x7684;<code>vlan</code>&#x9700;&#x8981;&#x652F;&#x6301;<code>vlan</code>&#x7684;&#x7F51;&#x5361;&#x548C;&#x4EA4;&#x6362;&#x673A;&#x3002;&#x589E;&#x52A0;&#x7684;&#x786C;&#x4EF6;&#x8D39;&#x7528;&#x53EF;&#x80FD;&#x4F1A;&#x88AB;&#x7F51;&#x7EDC;&#x8BBE;&#x7F6E;&#x548C;&#x7EF4;&#x62A4;&#x7684;&#x64CD;&#x4F5C;&#x6210;&#x672C;&#x8282;&#x7701;&#x6240;&#x62B5;&#x6D88;</li>
<li>&#x5F53;&#x4F7F;&#x7528;<code>vlan</code>&#x5904;&#x7406;&#x96C6;&#x7FA4;&#x4E0E;&#x8BA1;&#x7B97;&#x6808;(&#x5982;OpenStack&#x3001;CloudStack&#x7B49;)&#x4E4B;&#x95F4;&#x7684;&#x865A;&#x62DF;&#x673A;&#x6D41;&#x91CF;&#x65F6;&#xFF0C;&#x4E5F;&#x503C;&#x5F97;&#x8003;&#x8651;&#x4F7F;&#x7528;<code>10G</code>&#x4EE5;&#x592A;&#x7F51;&#x3002;
&#x6BCF;&#x4E2A;&#x7F51;&#x7EDC;&#x7684;&#x673A;&#x67B6;&#x9876;&#x90E8;&#x8DEF;&#x7531;&#x5668;&#x4E5F;&#x9700;&#x8981;&#x80FD;&#x591F;&#x4E0E;&#x5177;&#x6709;&#x66F4;&#x5FEB;&#x541E;&#x5410;&#x91CF;&#x7684;&#x810A;&#x67F1;&#x8DEF;&#x7531;&#x5668;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x3002;<code>40Gbps</code>&#x5230;<code>100Gbps</code></li>
<li>&#x60A8;&#x7684;&#x670D;&#x52A1;&#x5668;&#x786C;&#x4EF6;&#x5E94;&#x8BE5;&#x6709;&#x4E00;&#x4E2A;&#x5E95;&#x677F;&#x7BA1;&#x7406;&#x63A7;&#x5236;&#x5668;(<code>BMC</code>)&#x3002;&#x7BA1;&#x7406;&#x548C;&#x90E8;&#x7F72;&#x5DE5;&#x5177;&#x4E5F;&#x53EF;&#x80FD;&#x5E7F;&#x6CDB;&#x5730;&#x4F7F;&#x7528;<code>bmc</code>&#xFF0C;
&#x56E0;&#x6B64;&#x8003;&#x8651;&#x4F7F;&#x7528;&#x5E26;&#x5916;&#x7F51;&#x7EDC;&#x8FDB;&#x884C;&#x7BA1;&#x7406;&#x7684;&#x6210;&#x672C;/&#x6536;&#x76CA;&#x6743;&#x8861;&#x3002;&#x7BA1;&#x7406;&#x7A0B;&#x5E8F;<code>SSH</code>&#x8BBF;&#x95EE;&#x3001;<code>VM</code>&#x955C;&#x50CF;&#x4E0A;&#x4F20;&#x3001;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x955C;&#x50CF;&#x5B89;&#x88C5;&#x3001;&#x7BA1;&#x7406;&#x5957;&#x63A5;&#x5B57;&#x7B49;&#x90FD;&#x53EF;&#x80FD;&#x7ED9;&#x7F51;&#x7EDC;&#x5E26;&#x6765;&#x5DE8;&#x5927;&#x7684;&#x8D1F;&#x8F7D;&#x3002;
&#x8FD0;&#x884C;&#x4E09;&#x4E2A;&#x7F51;&#x7EDC;&#x53EF;&#x80FD;&#x770B;&#x8D77;&#x6765;&#x6709;&#x70B9;&#x5C0F;&#x9898;&#x5927;&#x505A;&#xFF0C;&#x4F46;&#x6BCF;&#x4E2A;&#x6D41;&#x91CF;&#x8DEF;&#x5F84;&#x90FD;&#x4EE3;&#x8868;&#x4E00;&#x4E2A;&#x6F5C;&#x5728;&#x7684;&#x5BB9;&#x91CF;&#x3001;&#x541E;&#x5410;&#x91CF;&#x548C;/&#x6216;&#x6027;&#x80FD;&#x74F6;&#x9888;&#xFF0C;&#x5728;&#x90E8;&#x7F72;&#x5927;&#x89C4;&#x6A21;&#x6570;&#x636E;&#x96C6;&#x7FA4;&#x4E4B;&#x524D;&#xFF0C;&#x60A8;&#x5E94;&#x8BE5;&#x4ED4;&#x7EC6;&#x8003;&#x8651;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;</li>
</ul>
<p><strong>&#x7B80;&#x8A00;&#x4E4B;&#xFF1A;</strong>
    &#x5EFA;&#x8BAE;&#x4E09;&#x4E2A;&#x7F51;&#x7EDC;&#x63A5;&#x53E3;&#xFF1A;</p>
<ul>
<li>ceph&#x96C6;&#x7FA4;&#x7F51;&#x7EDC;&#x63A5;&#x53E3;</li>
<li>&#x5BF9;&#x5916;&#x7F51;&#x7EDC;&#x63A5;&#x53E3;</li>
<li>&#x7BA1;&#x7406;&#x63A5;&#x53E3;</li>
</ul>
<p><strong>&#x6837;&#x4F8B;&#x96C6;&#x7FA4;&#x7F51;&#x53E3;&#x914D;&#x7F6E;&#xFF1A;</strong></p>
<pre class="language-"><code>[root@ceph01 ~]#  ethtool ens4f0
Settings for ens4f0:
        Supported ports: [ FIBRE ]
        Supported link modes:   10000baseT/Full
        Supported pause frame use: Symmetric
        Supports auto-negotiation: No
        Supported FEC modes: Not reported
        Advertised link modes:  10000baseT/Full
        Advertised pause frame use: Symmetric
        Advertised auto-negotiation: No
        Advertised FEC modes: Not reported
        Speed: 10000Mb/s
        Duplex: Full
        Port: FIBRE
        PHYAD: 0
        Transceiver: internal
        Auto-negotiation: off
        Supports Wake-on: d
        Wake-on: d
        Current message level: 0x00000007 (7)
                               drv probe link
        Link detected: yes
</code></pre><h3 id="&#x6545;&#x969C;&#x57DF;"><a name="&#x6545;&#x969C;&#x57DF;" class="anchor-navigation-ex-anchor" href="#&#x6545;&#x969C;&#x57DF;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6545;&#x969C;&#x57DF;</h3>
<p>&#x6545;&#x969C;&#x57DF;&#x662F;&#x6307;&#x963B;&#x6B62;&#x8BBF;&#x95EE;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;<code>OSDs</code>&#x7684;&#x4EFB;&#x4F55;&#x6545;&#x969C;&#x3002;&#x8FD9;&#x53EF;&#x80FD;&#x662F;&#x4E3B;&#x673A;&#x4E0A;&#x5DF2;&#x505C;&#x6B62;&#x7684;&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;;&#x786C;&#x76D8;&#x6545;&#x969C;&#x3001;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5D29;&#x6E83;&#x3001;&#x7F51;&#x5361;&#x6545;&#x969C;&#x3001;&#x7535;&#x6E90;&#x6545;&#x969C;&#x3001;&#x7F51;&#x7EDC;&#x4E2D;&#x65AD;&#x3001;&#x7535;&#x6E90;&#x4E2D;&#x65AD;&#xFF0C;&#x7B49;&#x7B49;&#x3002;
&#x5728;&#x89C4;&#x5212;&#x786C;&#x4EF6;&#x9700;&#x6C42;&#x65F6;&#xFF0C;&#x60A8;&#x5FC5;&#x987B;&#x5E73;&#x8861;&#x964D;&#x4F4E;&#x6210;&#x672C;&#x7684;&#x8BF1;&#x60D1;&#xFF0C;&#x5373;&#x628A;&#x592A;&#x591A;&#x7684;&#x8D23;&#x4EFB;&#x653E;&#x5728;&#x592A;&#x5C11;&#x7684;&#x6545;&#x969C;&#x57DF;&#x4E2D;&#xFF0C;&#x4EE5;&#x53CA;&#x9694;&#x79BB;&#x6BCF;&#x4E2A;&#x6F5C;&#x5728;&#x6545;&#x969C;&#x57DF;&#x6240;&#x589E;&#x52A0;&#x7684;&#x6210;&#x672C;</p>
<h3 id="&#x786C;&#x4EF6;&#x914D;&#x7F6E;&#x5EFA;&#x8BAE;"><a name="&#x786C;&#x4EF6;&#x914D;&#x7F6E;&#x5EFA;&#x8BAE;" class="anchor-navigation-ex-anchor" href="#&#x786C;&#x4EF6;&#x914D;&#x7F6E;&#x5EFA;&#x8BAE;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x786C;&#x4EF6;&#x914D;&#x7F6E;&#x5EFA;&#x8BAE;</h3>
<ul>
<li>&#x6700;&#x5C0F;&#x914D;&#x7F6E;&#x5EFA;&#x8BAE;</li>
</ul>
<table>
<thead>
<tr>
<th>Process</th>
<th>Criteria</th>
<th>Minimum Recommended</th>
</tr>
</thead>
<tbody>
<tr>
<td>ceph-OSD</td>
<td>Processor</td>
<td>1x 64-bit AMD-64 1x 32-bit ARM dual-core or better</td>
</tr>
<tr>
<td></td>
<td>RAM</td>
<td>~1GB for 1TB of storage per daemon</td>
</tr>
<tr>
<td></td>
<td>Volume Storage</td>
<td>1x storage drive per daemon</td>
</tr>
<tr>
<td></td>
<td>Journal</td>
<td>1x SSD partition per daemon (optional)</td>
</tr>
<tr>
<td></td>
<td>Network</td>
<td>2x 1GB Ethernet NICs</td>
</tr>
<tr>
<td>ceph-mon</td>
<td>Processor</td>
<td>1x 64-bit AMD-64 1x 32-bit ARM dual-core or better</td>
</tr>
<tr>
<td></td>
<td>RAM</td>
<td>1 GB per daemon</td>
</tr>
<tr>
<td></td>
<td>Disk Space</td>
<td>10 GB per daemon</td>
</tr>
<tr>
<td></td>
<td>Network</td>
<td>2x 1GB Ethernet NICs</td>
</tr>
<tr>
<td>ceph-mds</td>
<td>Processor</td>
<td>1x 64-bit AMD-64 quad-core 1x 32-bit ARM quad-core</td>
</tr>
<tr>
<td></td>
<td>RAM</td>
<td>1 GB minimum per daemon</td>
</tr>
<tr>
<td></td>
<td>Disk Space</td>
<td>1 MB per daemon</td>
</tr>
<tr>
<td></td>
<td>Network</td>
<td>2x 1GB Ethernet NICs</td>
</tr>
</tbody>
</table>
<ul>
<li>&#x751F;&#x4EA7;&#x73AF;&#x5883;&#x5EFA;&#x8BAE;</li>
</ul>
<table>
<thead>
<tr>
<th>Configuration</th>
<th>Criteria</th>
<th>Minimum Recommended</th>
</tr>
</thead>
<tbody>
<tr>
<td>Dell PE R510</td>
<td>Processor</td>
<td>2x 64-bit quad-core Xeon CPUs</td>
</tr>
<tr>
<td></td>
<td>RAM</td>
<td>16 GB</td>
</tr>
<tr>
<td></td>
<td>Volume Storage</td>
<td>8x 2TB drives. 1 OS, 7 Storage</td>
</tr>
<tr>
<td></td>
<td>Client Network</td>
<td>2x 1GB Ethernet NICs</td>
</tr>
<tr>
<td></td>
<td>OSD Network</td>
<td>2x 1GB Ethernet NICs</td>
</tr>
<tr>
<td></td>
<td>Mgmt. Network</td>
<td>2x 1GB Ethernet NICs</td>
</tr>
<tr>
<td>Dell PE R515</td>
<td>Processor</td>
<td>1x hex-core Opteron CPU</td>
</tr>
<tr>
<td></td>
<td>RAM</td>
<td>16 GB</td>
</tr>
<tr>
<td></td>
<td>Volume Storage</td>
<td>12x 3TB drives. Storage</td>
</tr>
<tr>
<td></td>
<td>OS Storage</td>
<td>1x 500GB drive. Operating System.</td>
</tr>
<tr>
<td></td>
<td>Client Network</td>
<td>2x 1GB Ethernet NICs</td>
</tr>
<tr>
<td></td>
<td>OSD Network</td>
<td>2x 1GB Ethernet NICs</td>
</tr>
<tr>
<td></td>
<td>Mgmt. Network</td>
<td>2x 1GB Ethernet NICs</td>
</tr>
</tbody>
</table>
<h2 id="&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5EFA;&#x8BAE;"><a name="&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5EFA;&#x8BAE;" class="anchor-navigation-ex-anchor" href="#&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5EFA;&#x8BAE;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5EFA;&#x8BAE;</h2>
<h3 id="&#x5185;&#x6838;"><a name="&#x5185;&#x6838;" class="anchor-navigation-ex-anchor" href="#&#x5185;&#x6838;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5185;&#x6838;</h3>
<ul>
<li><code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x5185;&#x6838;<ul>
<li>4.14.x</li>
<li>4.9.x</li>
</ul>
</li>
</ul>
<h3 id="&#x5E73;&#x53F0;"><a name="&#x5E73;&#x53F0;" class="anchor-navigation-ex-anchor" href="#&#x5E73;&#x53F0;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5E73;&#x53F0;</h3>
<table>
<thead>
<tr>
<th>Distro</th>
<th>Release</th>
<th>Code Name</th>
<th>Kernel</th>
<th>Notes</th>
<th>Testing</th>
</tr>
</thead>
<tbody>
<tr>
<td>CentOS</td>
<td>7</td>
<td>N/A</td>
<td>linux-3.10.0</td>
<td>3</td>
<td>B, I, C</td>
</tr>
<tr>
<td>Debian</td>
<td>8.0</td>
<td>Jessie</td>
<td>linux-3.16.0</td>
<td>1, 2</td>
<td>B, I</td>
</tr>
<tr>
<td>Debian</td>
<td>9.0</td>
<td>Stretch</td>
<td>linux-4.9</td>
<td>1, 2</td>
<td>B, I</td>
</tr>
<tr>
<td>Fedora</td>
<td>22</td>
<td>N/A</td>
<td>linux-3.14.0</td>
<td></td>
<td>B, I</td>
</tr>
<tr>
<td>RHEL</td>
<td>7</td>
<td>Maipo</td>
<td>linux-3.10.0</td>
<td></td>
<td>B, I</td>
</tr>
<tr>
<td>Ubuntu</td>
<td>14.04</td>
<td>Trusty Tahr</td>
<td>linux-3.13.0</td>
<td></td>
<td>B, I, C</td>
</tr>
<tr>
<td>Ubuntu</td>
<td>16.04</td>
<td>Xenial Xerus</td>
<td>linux-4.4.0</td>
<td>3</td>
<td>B, I, C</td>
</tr>
</tbody>
</table>
<h2 id="&#x73AF;&#x5883;&#x8BF4;&#x660E;"><a name="&#x73AF;&#x5883;&#x8BF4;&#x660E;" class="anchor-navigation-ex-anchor" href="#&#x73AF;&#x5883;&#x8BF4;&#x660E;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x73AF;&#x5883;&#x8BF4;&#x660E;</h2>
<ul>
<li>&#x8282;&#x70B9;&#x4FE1;&#x606F;</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">&#x8282;&#x70B9;&#x540D;&#x79F0;</th>
<th style="text-align:center">&#x8282;&#x70B9;IP</th>
<th style="text-align:center">&#x8282;&#x70B9;&#x5C5E;&#x6027;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ceph01</td>
<td style="text-align:center">192.168.1.69</td>
<td style="text-align:center">admin,deploy,mon</td>
</tr>
<tr>
<td style="text-align:center">ceph02</td>
<td style="text-align:center">192.168.1.70</td>
<td style="text-align:center">&#x5355;&#x5143;&#x683C;</td>
</tr>
<tr>
<td style="text-align:center">ceph03</td>
<td style="text-align:center">192.168.1.70</td>
<td style="text-align:center">&#x5355;&#x5143;&#x683C;</td>
</tr>
</tbody>
</table>
<h2 id="&#x73AF;&#x5883;&#x521D;&#x59CB;&#x5316;"><a name="&#x73AF;&#x5883;&#x521D;&#x59CB;&#x5316;" class="anchor-navigation-ex-anchor" href="#&#x73AF;&#x5883;&#x521D;&#x59CB;&#x5316;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x73AF;&#x5883;&#x521D;&#x59CB;&#x5316;</h2>
<h3 id="&#x914D;&#x7F6E;yum"><a name="&#x914D;&#x7F6E;yum" class="anchor-navigation-ex-anchor" href="#&#x914D;&#x7F6E;yum"><i class="fa fa-link" aria-hidden="true"></i></a>&#x914D;&#x7F6E;yum</h3>
<p><strong>&#x6240;&#x6709;ceph&#x8282;&#x70B9;&#xFF0C;&#x5305;&#x542B;&#x5BA2;&#x6237;&#x7AEF;&#x8282;&#x70B9;</strong></p>
<blockquote>
<p>1&#x3001;&#x5220;&#x9664;&#x539F;&#x6709;yum&#x6E90;repo&#x6587;&#x4EF6;</p>
</blockquote>
<pre class="language-"><code>rm -f /etc/yum.repos.d/*.repo
</code></pre><blockquote>
<p>2&#x3001;&#x521B;&#x5EFA;yum&#x6E90;&#x6587;&#x4EF6;</p>
</blockquote>
<p><strong>online</strong></p>
<pre class="language-"><code>curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo
curl -o /etc/yum.repos.d/epel-7.repo http://mirrors.aliyun.com/repo/epel-7.repo
</code></pre><p><strong>offline</strong></p>
<p>&#x4E0B;&#x8F7D;&#x4EE5;&#x4E0B;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x81F3;<code>/etc/yum.repos.d/</code></p>
<ul>
<li><a href="http://mirrors.aliyun.com/repo/Centos-7.repo" target="_blank">Centos-7.repo</a></li>
<li><a href="http://mirrors.aliyun.com/repo/epel-7.repo" target="_blank">epel-7.repo</a></li>
</ul>
<blockquote>
<p>3&#x3001;&#x914D;&#x7F6E;<code>ceph</code>&#x955C;&#x50CF;&#x6E90;&#x4ED3;&#x5E93;</p>
</blockquote>
<pre class="language-"><code>cat &gt; /etc/yum.repos.d/ceph.repo &lt;&lt;EOF
[Ceph]
name=Ceph \$basearch
baseurl=https://mirrors.aliyun.com/ceph/rpm-nautilus/el7/\$basearch
enabled=1
gpgcheck=1
gpgkey=https://mirrors.aliyun.com/ceph/keys/release.asc

[Ceph-noarch]
name=Ceph noarch
baseurl=https://mirrors.aliyun.com/ceph/rpm-nautilus/el7/noarch
enabled=1
gpgcheck=1
gpgkey=https://mirrors.aliyun.com/ceph/keys/release.asc

[Ceph-source]
name=Ceph SRPMS
baseurl=https://mirrors.aliyun.com/ceph/rpm-nautilus/el7/SRPMS
enabled=1
gpgcheck=1
gpgkey=https://mirrors.aliyun.com/ceph/keys/release.asc
EOF
</code></pre><blockquote>
<p>4&#x3001;&#x914D;&#x7F6E;<code>yum</code>&#x4EE3;&#x7406;</p>
</blockquote>
<p><strong>&#x9002;&#x7528;&#x4E8E;&#x4E3B;&#x673A;&#x901A;&#x8FC7;&#x4EE3;&#x7406;&#x8BBF;&#x95EE;&#x4E92;&#x8054;&#x7F51;&#x573A;&#x666F;</strong></p>
<p>&#x4EE5;&#x4E0B;&#x53D8;&#x91CF;&#x6CE8;&#x610F;&#x66FF;&#x6362;</p>
<ul>
<li>username: &#x4EE3;&#x7406;&#x7528;&#x6237;&#x540D;</li>
<li>password: &#x4EE3;&#x7406;&#x7528;&#x6237;&#x5BC6;&#x7801;</li>
<li>proxy_host: &#x4EE3;&#x7406;IP&#x5730;&#x5740;</li>
<li>proxy_port: &#x4EE3;&#x7406;&#x7AEF;&#x53E3;</li>
</ul>
<pre class="language-"><code>echo &quot;proxy=http://username:password@proxy_host:proxy_port&quot; &gt;&gt; /etc/yum.conf
</code></pre><h3 id="yum&#x4F9D;&#x8D56;&#x5BFC;&#x51FA;"><a name="yum&#x4F9D;&#x8D56;&#x5BFC;&#x51FA;" class="anchor-navigation-ex-anchor" href="#yum&#x4F9D;&#x8D56;&#x5BFC;&#x51FA;"><i class="fa fa-link" aria-hidden="true"></i></a>yum&#x4F9D;&#x8D56;&#x5BFC;&#x51FA;</h3>
<p><strong>&#x9002;&#x7528;&#x65E0;&#x6CD5;&#x76F4;&#x8FDE;&#x6216;&#x901A;&#x8FC7;&#x4EE3;&#x7406;&#x8FDE;&#x63A5;&#x4E92;&#x8054;&#x7F51;&#x955C;&#x50CF;&#x6E90;</strong></p>
<ul>
<li>&#x8054;&#x7F51;&#x4E3B;&#x673A;&#xFF1A;&#x7528;&#x4E8E;&#x5BFC;&#x51FA;<code>ceph</code>&#x4F9D;&#x8D56;,&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x4E3A;<code>CentOS7</code></li>
<li>&#x79BB;&#x7EBF;&#x4E3B;&#x673A;&#xFF1A;&#x5B9E;&#x9645;&#x90E8;&#x7F72;<code>ceph</code>&#x5E94;&#x7528;&#x7684;&#x4E3B;&#x673A;(&#x591A;&#x8282;&#x70B9;&#x5B9E;&#x4F8B;)</li>
</ul>
<p>&#x4F9D;&#x8D56;&#x5BFC;&#x51FA;&#xFF08;&#x8054;&#x7F51;&#x4E3B;&#x673A;&#xFF09;</p>
<pre class="language-"><code>rm -f /etc/yum.repos.d/*.repo
curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo
curl -o /etc/yum.repos.d/epel-7.repo http://mirrors.aliyun.com/repo/epel-7.repo

yum update -y
yum install yum-plugin-downloadonly -y
yum install --downloadonly --downloaddir=./ceph ceph ceph-common ceph-deploy
</code></pre><p>&#x751F;&#x6210;repo&#x4F9D;&#x8D56;&#x5173;&#x7CFB;&#xFF08;&#x8054;&#x7F51;&#x4E3B;&#x673A;&#xFF09;</p>
<pre class="language-"><code>yum install -y createrepo
createrepo ./ceph
</code></pre><p>&#x538B;&#x7F29;&#xFF08;&#x8054;&#x7F51;&#x4E3B;&#x673A;&#xFF09;</p>
<pre class="language-"><code>tar zcvf ceph.tar.gz ceph
</code></pre><p>&#x914D;&#x7F6E;&#x4F7F;&#x7528;&#xFF08;&#x79BB;&#x7EBF;&#x4E3B;&#x673A;&#xFF09;</p>
<pre class="language-"><code>tar zxvf ceph.tar.gz -C /

cat &gt; /etc/yum.repos.d/ceph.repo &lt;&lt;EOF
[ceph]
name=python-repo
baseurl=file:///ceph
gpgcheck=0
enabled=1
EOF

yum install -y ceph ceph-deploy ceph-common
</code></pre><h3 id="&#x914D;&#x7F6E;&#x65F6;&#x949F;&#x540C;&#x6B65;"><a name="&#x914D;&#x7F6E;&#x65F6;&#x949F;&#x540C;&#x6B65;" class="anchor-navigation-ex-anchor" href="#&#x914D;&#x7F6E;&#x65F6;&#x949F;&#x540C;&#x6B65;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x914D;&#x7F6E;&#x65F6;&#x949F;&#x540C;&#x6B65;</h3>
<blockquote>
<p>&#x914D;&#x7F6E;dns</p>
</blockquote>
<p>&#x8BE5;<code>dns</code>&#x7528;&#x4EE5;&#x89E3;&#x6790;&#x65F6;&#x949F;&#x670D;&#x52A1;&#x5730;&#x5740;&#xFF0C;&#x4E92;&#x8054;&#x7F51;&#x4E0B;&#x5E94;&#x4E3A;<code>114.114.114.114</code></p>
<pre class="language-"><code>echo &quot;nameserver x.x.x.x&quot; &gt;&gt; /etc/resolv.conf
</code></pre><blockquote>
<p>&#x5B89;&#x88C5;ntp</p>
</blockquote>
<pre class="language-"><code>yum install -y ntp
</code></pre><blockquote>
<p>&#x540C;&#x6B65;</p>
</blockquote>
<p>&#x65F6;&#x949F;&#x670D;&#x52A1;&#x5730;&#x5740;&#x636E;&#x5B9E;&#x9645;&#x60C5;&#x51B5;&#x8C03;&#x6574;</p>
<pre class="language-"><code>ntpdate time.wl.com
echo &quot;*/5 * * * * root ntpdate time.wl.com&quot; &gt;&gt; /etc/crontab
</code></pre><blockquote>
<p>&#x8C03;&#x6574;&#x65F6;&#x533A;</p>
</blockquote>
<pre class="language-"><code>ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
</code></pre><h3 id="&#x5347;&#x7EA7;&#x5185;&#x6838;"><a name="&#x5347;&#x7EA7;&#x5185;&#x6838;" class="anchor-navigation-ex-anchor" href="#&#x5347;&#x7EA7;&#x5185;&#x6838;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5347;&#x7EA7;&#x5185;&#x6838;</h3>
<p>&#x5BFC;&#x5165;<code>kernel</code>&#x6E90;</p>
<p><a href="https://www.elrepo.org/elrepo-release-7.0-4.el7.elrepo.noarch.rpm" target="_blank">elrepo-release-7.0-4.el7.elrepo.noarch.rpm</a></p>
<pre class="language-"><code>rpm -ivh elrepo-release-7.0-4.el7.elrepo.noarch.rpm -y
</code></pre><p>&#x5B89;&#x88C5;&#x6700;&#x65B0;&#x4E3B;&#x7EBF;&#x7248;</p>
<pre class="language-"><code>yum -y --enablerepo=elrepo-kernel install kernel-ml.x86_64 kernel-ml-devel.x86_64
</code></pre><p>&#x5220;&#x9664;&#x65E7;&#x7248;&#x672C;&#x5DE5;&#x5177;&#x5305;</p>
<pre class="language-"><code> rpm -qa|grep kernel-3|xargs -n1 yum remove -y
</code></pre><p>&#x5B89;&#x88C5;&#x65B0;&#x7248;&#x672C;&#x5DE5;&#x5177;&#x5305;</p>
<pre class="language-"><code>yum --disablerepo=\* --enablerepo=elrepo-kernel install -y kernel-ml-tools.x86_64
</code></pre><p>&#x67E5;&#x770B;&#x5185;&#x6838;&#x5217;&#x8868;</p>
<pre class="language-"><code>awk -F\&apos; &apos;$1==&quot;menuentry &quot; {print i++ &quot; : &quot; $2}&apos; /etc/grub2.cfg
</code></pre><p>&#x91CD;&#x5EFA;&#x5185;&#x6838;</p>
<pre class="language-"><code>grub2-mkconfig -o /boot/grub2/grub.cfg
</code></pre><p>&#x914D;&#x7F6E;&#x65B0;&#x7248;&#x5185;&#x6838;</p>
<pre class="language-"><code>grub2-set-default 0
</code></pre><p>&#x91CD;&#x542F;</p>
<pre class="language-"><code>reboot
</code></pre><h3 id="raid&#x5361;"><a name="raid&#x5361;" class="anchor-navigation-ex-anchor" href="#raid&#x5361;"><i class="fa fa-link" aria-hidden="true"></i></a>raid&#x5361;</h3>
<p>&#x9002;&#x7528;&#x4E8E;&#x5DF2;&#x5B89;&#x88C5;<code>raid</code>&#x5361;&#x4E3B;&#x673A;</p>
<ul>
<li>&#x7CFB;&#x7EDF;&#x76D8;&#xFF1A;&#x5EFA;&#x8BAE;raid1</li>
<li>&#x6570;&#x636E;&#x76D8;&#xFF1A;&#x914D;&#x7F6E;&#x4E3A;&#x76F4;&#x901A;&#x6A21;&#x5F0F;&#xFF08;JBOD&#xFF09;</li>
</ul>
<h2 id="&#x5B89;&#x88C5;ceph"><a name="&#x5B89;&#x88C5;ceph" class="anchor-navigation-ex-anchor" href="#&#x5B89;&#x88C5;ceph"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5B89;&#x88C5;ceph</h2>
<p><code>ceph</code>&#x7248;&#x672C;&#x4E3A;<code>14.2.16 nautilus</code></p>
<blockquote>
<p>&#x521B;&#x5EFA;ceph&#x76EE;&#x5F55;(deploy&#x8282;&#x70B9;)</p>
</blockquote>
<pre class="language-"><code>mkdir -p /etc/ceph
</code></pre><blockquote>
<p>&#x914D;&#x7F6E;&#x4E3B;&#x673A;&#x4E92;&#x4FE1;(deploy&#x8282;&#x70B9;)</p>
</blockquote>
<pre class="language-"><code>ssh-keygen -t rsa -b 2048 -N &apos;&apos; -f ~/.ssh/id_rsa
ssh-copy-id ceph01
ssh-copy-id ceph02
ssh-copy-id ceph03
</code></pre><blockquote>
<p>&#x5B89;&#x88C5;<code>ceph</code>(&#x6240;&#x6709;&#x8282;&#x70B9;)</p>
</blockquote>
<pre class="language-"><code>yum install -y ceph ceph-deploy
</code></pre><blockquote>
<p>&#x521D;&#x59CB;&#x5316;mon&#x8282;&#x70B9;(deploy&#x8282;&#x70B9;)</p>
</blockquote>
<pre class="language-"><code>ceph-deploy new ceph01 ceph02 ceph03
</code></pre><blockquote>
<p>&#x521D;&#x59CB;&#x5316;<code>mon</code>(deploy&#x8282;&#x70B9;)</p>
</blockquote>
<pre class="language-"><code> ceph-deploy mon create-initial
</code></pre><blockquote>
<p>&#x4FEE;&#x6539;&#x96C6;&#x7FA4;&#x6587;&#x4EF6;(deploy&#x8282;&#x70B9;)</p>
</blockquote>
<pre class="language-"><code>cd /etc/ceph/
echo &quot;public_network=192.168.1.0/24&quot; &gt;&gt; /etc/ceph/ceph.conf
ceph-deploy --overwrite-conf config push ceph01 ceph02 ceph03
</code></pre><blockquote>
<p>&#x914D;&#x7F6E;admin&#x8282;&#x70B9;</p>
</blockquote>
<pre class="language-"><code>cd /etc/ceph/
ceph-deploy admin ceph01 ceph02 ceph03
</code></pre><blockquote>
<p>&#x67E5;&#x770B;&#x96C6;&#x7FA4;&#x72B6;&#x6001;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph -s
  cluster:
    id:     b1c2511e-a1a5-4d6d-a4be-0e7f0d6d4294
    health: HEALTH_WARN
            mon ceph03 is low on available space

  services:
    mon: 3 daemons, quorum ceph01,ceph02,ceph03 (age 31m)
    mgr: no daemons active
    OSD: 0 OSDs: 0 up, 0 in

  data:
    pools:   0 pools, 0 pgs
    objects: 0 objects, 0 B
    usage:   0 B used, 0 B / 0 B avail
    pgs:
</code></pre><blockquote>
<p>&#x5B89;&#x88C5;&#x547D;&#x4EE4;&#x8865;&#x5168;</p>
</blockquote>
<pre class="language-"><code>yum -y install bash-completion
</code></pre><h2 id="&#x914D;&#x7F6E;ceph"><a name="&#x914D;&#x7F6E;ceph" class="anchor-navigation-ex-anchor" href="#&#x914D;&#x7F6E;ceph"><i class="fa fa-link" aria-hidden="true"></i></a>&#x914D;&#x7F6E;ceph</h2>
<h3 id="&#x6DFB;&#x52A0;osd"><a name="&#x6DFB;&#x52A0;osd" class="anchor-navigation-ex-anchor" href="#&#x6DFB;&#x52A0;osd"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6DFB;&#x52A0;OSD</h3>
<blockquote>
<p>ceph01&#x8282;&#x70B9;&#x6DFB;&#x52A0;OSD</p>
</blockquote>
<p>&#x5217;&#x51FA;&#x8282;&#x70B9;<code>ceph01</code>&#x78C1;&#x76D8;&#x4FE1;&#x606F;</p>
<pre class="language-"><code>ceph-deploy disk list ceph01
</code></pre><p>&#x8F93;&#x51FA;&#x5982;&#x4E0B;</p>
<pre class="language-"><code>...
[ceph01][INFO  ] Disk /dev/sda: 960.2 GB, 960197124096 bytes, 1875385008 sectors
[ceph01][INFO  ] Disk /dev/sdb: 480.1 GB, 480103981056 bytes, 937703088 sectors
[ceph01][INFO  ] Disk /dev/sdf: 960.2 GB, 960197124096 bytes, 1875385008 sectors
[ceph01][INFO  ] Disk /dev/sdd: 960.2 GB, 960197124096 bytes, 1875385008 sectors
[ceph01][INFO  ] Disk /dev/sde: 960.2 GB, 960197124096 bytes, 1875385008 sectors
[ceph01][INFO  ] Disk /dev/sdc: 960.2 GB, 960197124096 bytes, 1875385008 sectors
[ceph01][INFO  ] Disk /dev/sdg: 960.2 GB, 960197124096 bytes, 1875385008 sectors
[ceph01][INFO  ] Disk /dev/sdh: 960.2 GB, 960197124096 bytes, 1875385008 sectors
[ceph01][INFO  ] Disk /dev/mapper/centos-root: 478.0 GB, 477953523712 bytes, 933502976 sectors
[ceph01][INFO  ] Disk /dev/nvme0n1: 1000.2 GB, 1000204886016 bytes, 1953525168 sectors
[ceph01][INFO  ] Disk /dev/nvme1n1: 1000.2 GB, 1000204886016 bytes, 1953525168 sectors
[ceph01][INFO  ] Disk /dev/nvme2n1: 1000.2 GB, 1000204886016 bytes, 1953525168 sectors
[ceph01][INFO  ] Disk /dev/nvme3n1: 1000.2 GB, 1000204886016 bytes, 1953525168 sectors
...
</code></pre><p>&#x5176;&#x4E2D;<code>/dev/sda-h</code>&#x4E3A;<code>SSD</code>&#x7C7B;&#x578B;&#x78C1;&#x76D8;&#xFF0C;<code>/dev/nvme*</code>&#x4E3A;<code>nvme</code>&#x7C7B;&#x578B;&#x78C1;&#x76D8;&#xFF0C;&#x4E14;<code>/dev/sdb</code>&#x4E3A;&#x7CFB;&#x7EDF;&#x76D8;</p>
<blockquote>
<p>&#x67E5;&#x770B;&#x78C1;&#x76D8;&#x6302;&#x8F7D;</p>
</blockquote>
<pre class="language-"><code>lsblk
</code></pre><p>&#x8F93;&#x51FA;&#x5982;&#x4E0B;</p>
<pre class="language-"><code>NAME              MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
sdf                 8:80   0 894.3G  0 disk
nvme0n1           259:1    0   1.8T  0 disk
sdd                 8:48   0 894.3G  0 disk
nvme3n1           259:3    0   1.8T  0 disk
sdb                 8:16   0 894.3G  0 disk
&#x251C;&#x2500;sdb2            8:34   0     1G  0 part /boot
&#x251C;&#x2500;sdb3            8:35   0 445.1G  0 part
&#x2502; &#x251C;&#x2500;centos-swap 253:1    0    16G  0 lvm
&#x2502; &#x2514;&#x2500;centos-root 253:0    0 429.1G  0 lvm  /
&#x2514;&#x2500;sdb1            8:33   0     1G  0 part /boot/efi
sdk                 8:160  0 894.3G  0 disk
sdi                 8:128  0 447.1G  0 disk
nvme2n1           259:2    0   1.8T  0 disk
sr0                11:0    1   4.2G  0 rom
sdg                 8:96   0 894.3G  0 disk
sde                 8:64   0 894.3G  0 disk
sdc                 8:32   0 894.3G  0 disk
nvme1n1           259:0    0   1.8T  0 disk
sda                 8:0    0 894.3G  0 disk
sdj                 8:144  0 894.3G  0 disk
sdh                 8:112  0 894.3G  0 disk
</code></pre><p>&#x78C1;&#x76D8;&#x7C7B;&#x578B;&#x8BF4;&#x660E;</p>
<pre class="language-"><code>sda-sdh &#x4E3A;SSD&#x7C7B;&#x578B;
nvme0n1&#x3001;nvme1n1&#x3001;nvme2n1&#x3001;nvme3n1&#x4E3A;nvme&#x7C7B;&#x578B;
&#x7CFB;&#x7EDF;&#x76D8;&#xFF1A;nvme0n1
</code></pre><blockquote>
<p>&#x683C;&#x5F0F;&#x5316;&#x78C1;&#x76D8;</p>
</blockquote>
<pre class="language-"><code>mkfs.ext4 /dev/sda
mkfs.ext4 /dev/sdc
mkfs.ext4 /dev/sdd
mkfs.ext4 /dev/sde
mkfs.ext4 /dev/sdf
mkfs.ext4 /dev/sdg
mkfs.ext4 /dev/sdh
mkfs.ext4 /dev/nvme0n1
mkfs.ext4 /dev/nvme1n1
mkfs.ext4 /dev/nvme2n1
mkfs.ext4 /dev/nvme3n1
</code></pre><blockquote>
<p>&#x64E6;&#x51C0;&#x8282;&#x70B9;<code>SSD</code>&#x7C7B;&#x578B;&#x78C1;&#x76D8;</p>
</blockquote>
<pre class="language-"><code>ceph-deploy disk zap ceph01 /dev/sda

cd /etc/ceph/
for i in {c..h};do
ceph-deploy disk zap ceph01 /dev/sd$i
done
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;<code>SSD</code>&#x7C7B;&#x578B;<code>OSD</code>&#x8282;&#x70B9;</p>
</blockquote>
<pre class="language-"><code>cd /etc/ceph
for i in {c..h};do
ceph-deploy osd create --data /dev/sd$i ceph01
done

ceph-deploy osd create --data /dev/sda ceph01
</code></pre><blockquote>
<p>&#x64E6;&#x51C0;&#x8282;&#x70B9;<code>nvme</code>&#x7C7B;&#x578B;&#x78C1;&#x76D8;</p>
</blockquote>
<pre class="language-"><code>cd /etc/ceph
for i in {0..3};do
ceph-deploy disk zap ceph01 /dev/nvme${i}n1
done
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;<code>nvme</code>&#x7C7B;&#x578B;<code>OSD</code>&#x8282;&#x70B9;</p>
</blockquote>
<pre class="language-"><code>cd /etc/ceph
for i in {0..3};do
ceph-deploy OSD create --data /dev/nvme${i}n1 ceph01
done
</code></pre><blockquote>
<p>ceph02&#x8282;&#x70B9;&#x6DFB;&#x52A0;OSD</p>
</blockquote>
<p>&#x5217;&#x51FA;&#x8282;&#x70B9;<code>ceph02</code>&#x78C1;&#x76D8;&#x4FE1;&#x606F;(ceph01&#x8282;&#x70B9;&#x6267;&#x884C;)</p>
<pre class="language-"><code>ceph-deploy disk list ceph02
</code></pre><p>&#x8F93;&#x51FA;&#x5982;&#x4E0B;</p>
<pre class="language-"><code>...
[root@ceph01 ceph]# ceph-deploy disk list ceph02
[ceph_deploy.conf][DEBUG ] found configuration file at: /root/.cephdeploy.conf
[ceph_deploy.cli][INFO  ] Invoked (2.0.1): /usr/bin/ceph-deploy disk list ceph02
[ceph_deploy.cli][INFO  ] ceph-deploy options:
[ceph_deploy.cli][INFO  ]  username                      : None
[ceph_deploy.cli][INFO  ]  verbose                       : False
[ceph_deploy.cli][INFO  ]  debug                         : False
[ceph_deploy.cli][INFO  ]  overwrite_conf                : False
[ceph_deploy.cli][INFO  ]  subcommand                    : list
[ceph_deploy.cli][INFO  ]  quiet                         : False
[ceph_deploy.cli][INFO  ]  cd_conf                       : <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ceph_deploy.conf.cephdeploy.Conf</span> <span class="token attr-name">instance</span> <span class="token attr-name">at</span> <span class="token attr-name">0x7f8c21ecd518</span><span class="token punctuation">&gt;</span></span>
[ceph_deploy.cli][INFO  ]  cluster                       : ceph
[ceph_deploy.cli][INFO  ]  host                          : [&apos;ceph02&apos;]
[ceph_deploy.cli][INFO  ]  func                          : <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>function</span> <span class="token attr-name">disk</span> <span class="token attr-name">at</span> <span class="token attr-name">0x7f8c22118938</span><span class="token punctuation">&gt;</span></span>
[ceph_deploy.cli][INFO  ]  ceph_conf                     : None
[ceph_deploy.cli][INFO  ]  default_release               : False
[ceph02][DEBUG ] connected to host: ceph02
[ceph02][DEBUG ] detect platform information from remote host
[ceph02][DEBUG ] detect machine type
[ceph02][DEBUG ] find the location of an executable
[ceph02][INFO  ] Running command: fdisk -l
[ceph02][INFO  ] Disk /dev/sdb: 960.2 GB, 960197124096 bytes, 1875385008 sectors
[ceph02][INFO  ] Disk /dev/sdd: 960.2 GB, 960197124096 bytes, 1875385008 sectors
[ceph02][INFO  ] Disk /dev/sda: 960.2 GB, 960197124096 bytes, 1875385008 sectors
[ceph02][INFO  ] Disk /dev/sdf: 960.2 GB, 960197124096 bytes, 1875385008 sectors
[ceph02][INFO  ] Disk /dev/sdc: 480.1 GB, 480103981056 bytes, 937703088 sectors
[ceph02][INFO  ] Disk /dev/sde: 960.2 GB, 960197124096 bytes, 1875385008 sectors
[ceph02][INFO  ] Disk /dev/mapper/centos-root: 460.8 GB, 460773654528 bytes, 899948544 sectors
[ceph02][INFO  ] Disk /dev/mapper/centos-swap: 17.2 GB, 17179869184 bytes, 33554432 sectors
[ceph02][INFO  ] Disk /dev/nvme0n1: 1000.2 GB, 1000204886016 bytes, 1953525168 sectors
[ceph02][INFO  ] Disk /dev/nvme3n1: 1000.2 GB, 1000204886016 bytes, 1953525168 sectors
[ceph02][INFO  ] Disk /dev/nvme1n1: 1000.2 GB, 1000204886016 bytes, 1953525168 sectors
[ceph02][INFO  ] Disk /dev/nvme2n1: 1000.2 GB, 1000204886016 bytes, 1953525168 sectors
...
</code></pre><p>&#x5176;&#x4E2D;<code>/dev/sda-f</code>&#x4E3A;<code>SSD</code>&#x7C7B;&#x578B;&#x78C1;&#x76D8;&#xFF0C;<code>/dev/nvme*</code>&#x4E3A;<code>nvme</code>&#x7C7B;&#x578B;&#x78C1;&#x76D8;&#xFF0C;&#x4E14;<code>/dev/sdc</code>&#x4E3A;&#x7CFB;&#x7EDF;&#x76D8;</p>
<blockquote>
<p>&#x67E5;&#x770B;&#x78C1;&#x76D8;&#x6302;&#x8F7D;&#xFF08;ceph02&#x8282;&#x70B9;&#x6267;&#x884C;&#xFF09;</p>
</blockquote>
<pre class="language-"><code>lsblk
</code></pre><p>&#x8F93;&#x51FA;&#x5982;&#x4E0B;</p>
<pre class="language-"><code>[root@ceph02 ~]# lsblk
NAME            MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
sdf               8:80   0 894.3G  0 disk
nvme0n1         259:0    0 931.5G  0 disk
sdd               8:48   0 894.3G  0 disk
nvme3n1         259:1    0 931.5G  0 disk
sdb               8:16   0 894.3G  0 disk
nvme2n1         259:3    0 931.5G  0 disk
sde               8:64   0 894.3G  0 disk
sdc               8:32   0 447.1G  0 disk
&#x251C;&#x2500;sdc2            8:34   0     1G  0 part /boot
&#x251C;&#x2500;sdc3            8:35   0 445.1G  0 part
&#x2502; &#x251C;&#x2500;centos-swap 253:1    0    16G  0 lvm
&#x2502; &#x2514;&#x2500;centos-root 253:0    0 429.1G  0 lvm  /
&#x2514;&#x2500;sdc1            8:33   0     1G  0 part /boot/efi
nvme1n1         259:2    0 931.5G  0 disk
sda               8:0    0 894.3G  0 disk
</code></pre><p>&#x78C1;&#x76D8;&#x7C7B;&#x578B;&#x8BF4;&#x660E;</p>
<pre class="language-"><code>sda-sdf &#x4E3A;SSD&#x7C7B;&#x578B;
nvme0n1&#x3001;nvme1n1&#x3001;nvme2n1&#x3001;nvme3n1&#x4E3A;nvme&#x7C7B;&#x578B;
&#x7CFB;&#x7EDF;&#x76D8;&#xFF1A;sdc
</code></pre><blockquote>
<p>&#x683C;&#x5F0F;&#x5316;&#x78C1;&#x76D8;&#xFF08;ceph02&#x8282;&#x70B9;&#x6267;&#x884C;&#xFF09;</p>
</blockquote>
<pre class="language-"><code>mkfs.ext4 /dev/sda
mkfs.ext4 /dev/sdb
mkfs.ext4 /dev/sdd
mkfs.ext4 /dev/sde
mkfs.ext4 /dev/sdf
mkfs.ext4 /dev/nvme0n1
mkfs.ext4 /dev/nvme1n1
mkfs.ext4 /dev/nvme2n1
mkfs.ext4 /dev/nvme3n1
</code></pre><blockquote>
<p>&#x64E6;&#x51C0;&#x8282;&#x70B9;<code>SSD</code>&#x7C7B;&#x578B;&#x78C1;&#x76D8;&#xFF08;ceph01&#x8282;&#x70B9;&#x6267;&#x884C;&#xFF09;</p>
</blockquote>
<pre class="language-"><code>cd /etc/ceph/
for i in {a..b};do
ceph-deploy disk zap ceph02 /dev/sd$i
done

cd /etc/ceph/
for i in {d..f};do
ceph-deploy disk zap ceph02 /dev/sd$i
done
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;<code>SSD</code>&#x7C7B;&#x578B;<code>OSD</code>&#x8282;&#x70B9;&#xFF08;ceph01&#x8282;&#x70B9;&#x6267;&#x884C;&#xFF09;</p>
</blockquote>
<pre class="language-"><code>cd /etc/ceph
for i in {a..b};do
ceph-deploy OSD create --data /dev/sd$i ceph02
done

cd /etc/ceph
for i in {d..f};do
ceph-deploy OSD create --data /dev/sd$i ceph02
done
</code></pre><blockquote>
<p>&#x64E6;&#x51C0;&#x8282;&#x70B9;<code>nvme</code>&#x7C7B;&#x578B;&#x78C1;&#x76D8;&#xFF08;ceph01&#x8282;&#x70B9;&#x6267;&#x884C;&#xFF09;</p>
</blockquote>
<pre class="language-"><code>cd /etc/ceph
for i in {0..3};do
ceph-deploy disk zap ceph02 /dev/nvme${i}n1
done
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;<code>nvme</code>&#x7C7B;&#x578B;<code>OSD</code>&#x8282;&#x70B9;&#xFF08;ceph01&#x8282;&#x70B9;&#x6267;&#x884C;&#xFF09;</p>
</blockquote>
<pre class="language-"><code>cd /etc/ceph
for i in {0..3};do
ceph-deploy OSD create --data /dev/nvme${i}n1 ceph02
done
</code></pre><blockquote>
<p>ceph03&#x8282;&#x70B9;&#x6DFB;&#x52A0;OSD</p>
</blockquote>
<p>&#x5217;&#x51FA;&#x8282;&#x70B9;<code>ceph03</code>&#x78C1;&#x76D8;&#x4FE1;&#x606F;&#xFF08;ceph01&#x8282;&#x70B9;&#x6267;&#x884C;&#xFF09;</p>
<pre class="language-"><code>ceph-deploy disk list ceph03
</code></pre><p>&#x8F93;&#x51FA;&#x5982;&#x4E0B;</p>
<pre class="language-"><code>...
[ceph03][INFO  ] Disk /dev/nvme0n1: 1000.2 GB, 1000204886016 bytes, 1953525168 sectors
[ceph03][INFO  ] Disk /dev/nvme2n1: 1000.2 GB, 1000204886016 bytes, 1953525168 sectors
[ceph03][INFO  ] Disk /dev/nvme3n1: 1000.2 GB, 1000204886016 bytes, 1953525168 sectors
[ceph03][INFO  ] Disk /dev/nvme1n1: 1000.2 GB, 1000204886016 bytes, 1953525168 sectors
[ceph03][INFO  ] Disk /dev/sdc: 960.2 GB, 960197124096 bytes, 1875385008 sectors
[ceph03][INFO  ] Disk /dev/sda: 480.1 GB, 480103981056 bytes, 937703088 sectors
[ceph03][INFO  ] Disk /dev/sdb: 960.2 GB, 960197124096 bytes, 1875385008 sectors
[ceph03][INFO  ] Disk /dev/sde: 960.2 GB, 960197124096 bytes, 1875385008 sectors
[ceph03][INFO  ] Disk /dev/sdd: 960.2 GB, 960197124096 bytes, 1875385008 sectors
[ceph03][INFO  ] Disk /dev/sdf: 960.2 GB, 960197124096 bytes, 1875385008 sectors
[ceph03][INFO  ] Disk /dev/mapper/centos-root: 475.7 GB, 475667628032 bytes, 929038336 sectors
...
</code></pre><p>&#x5176;&#x4E2D;<code>/dev/sda-f</code>&#x4E3A;<code>SSD</code>&#x7C7B;&#x578B;&#x78C1;&#x76D8;&#xFF0C;<code>/dev/nvme*</code>&#x4E3A;<code>nvme</code>&#x7C7B;&#x578B;&#x78C1;&#x76D8;&#xFF0C;&#x4E14;<code>/dev/sda</code>&#x4E3A;&#x7CFB;&#x7EDF;&#x76D8;</p>
<blockquote>
<p>&#x67E5;&#x770B;&#x78C1;&#x76D8;&#x6302;&#x8F7D;&#xFF08;ceph03&#x8282;&#x70B9;&#x6267;&#x884C;&#xFF09;</p>
</blockquote>
<pre class="language-"><code>lsblk
</code></pre><p>&#x8F93;&#x51FA;&#x5982;&#x4E0B;</p>
<pre class="language-"><code>[root@ceph03 ~]# lsblk
NAME            MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
sda               8:0    0 447.1G  0 disk
&#x251C;&#x2500;sda1            8:1    0     2G  0 part /boot/efi
&#x251C;&#x2500;sda2            8:2    0     2G  0 part /boot
&#x2514;&#x2500;sda3            8:3    0   443G  0 part
  &#x2514;&#x2500;centos-root 253:0    0   443G  0 lvm  /
sdb               8:16   0 894.3G  0 disk
sdc               8:32   0 894.3G  0 disk
sdd               8:48   0 894.3G  0 disk
sde               8:64   0 894.3G  0 disk
sdf               8:80   0 894.3G  0 disk
nvme0n1         259:0    0 931.5G  0 disk
nvme1n1         259:3    0 931.5G  0 disk
nvme2n1         259:2    0 931.5G  0 disk
nvme3n1         259:1    0 931.5G  0 disk
</code></pre><p>&#x78C1;&#x76D8;&#x7C7B;&#x578B;&#x8BF4;&#x660E;</p>
<pre class="language-"><code>sda-sdf &#x4E3A;SSD&#x7C7B;&#x578B;
nvme0n1&#x3001;nvme1n1&#x3001;nvme2n1&#x3001;nvme3n1&#x4E3A;nvme&#x7C7B;&#x578B;
&#x7CFB;&#x7EDF;&#x76D8;&#xFF1A;nvme0n1
</code></pre><blockquote>
<p>&#x64E6;&#x51C0;&#x8282;&#x70B9;<code>SSD</code>&#x7C7B;&#x578B;&#x78C1;&#x76D8;</p>
</blockquote>
<pre class="language-"><code>cd /etc/ceph/
for i in {b..f};do
ceph-deploy disk zap ceph03 /dev/sd$i
done
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;<code>SSD</code>&#x7C7B;&#x578B;<code>OSD</code>&#x8282;&#x70B9;</p>
</blockquote>
<pre class="language-"><code>cd /etc/ceph
for i in {b..f};do
ceph-deploy OSD create --data /dev/sd$i ceph03
done
</code></pre><blockquote>
<p>&#x64E6;&#x51C0;&#x8282;&#x70B9;<code>nvme</code>&#x7C7B;&#x578B;&#x78C1;&#x76D8;</p>
</blockquote>
<pre class="language-"><code>cd /etc/ceph
for i in {0..3};do
ceph-deploy disk zap ceph03 /dev/nvme${i}n1
done
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;<code>nvme</code>&#x7C7B;&#x578B;<code>OSD</code>&#x8282;&#x70B9;</p>
</blockquote>
<pre class="language-"><code>cd /etc/ceph
for i in {0..3};do
ceph-deploy OSD create --data /dev/nvme${i}n1 ceph03
done
</code></pre><h4 id="&#x5E38;&#x89C1;&#x95EE;&#x9898;&#x89E3;&#x51B3;"><a name="&#x5E38;&#x89C1;&#x95EE;&#x9898;&#x89E3;&#x51B3;" class="anchor-navigation-ex-anchor" href="#&#x5E38;&#x89C1;&#x95EE;&#x9898;&#x89E3;&#x51B3;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5E38;&#x89C1;&#x95EE;&#x9898;&#x89E3;&#x51B3;</h4>
<ul>
<li>Unable to add physical volume &apos;/dev/nvme1n1&apos; to volume group &apos;ceph-e9ba73a1-f31a-4ce7-b0b9-ab16c35a2c49&apos;</li>
</ul>
<pre class="language-"><code>    pvcreate -ff -y /dev/nvme1n1
</code></pre><h3 id="crush-class"><a name="crush-class" class="anchor-navigation-ex-anchor" href="#crush-class"><i class="fa fa-link" aria-hidden="true"></i></a>crush class</h3>
<ul>
<li>&#x8BF4;&#x660E;</li>
</ul>
<p>&#x4ECE;<code>luminous</code>&#x7248;&#x672C;<code>ceph</code>&#x65B0;&#x589E;&#x4E86;&#x4E00;&#x4E2A;&#x529F;&#x80FD;<code>crush class</code>&#xFF0C;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x53C8;&#x53EF;&#x4EE5;&#x79F0;&#x4E3A;&#x78C1;&#x76D8;&#x667A;&#x80FD;&#x5206;&#x7EC4;&#x3002;&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x5C31;&#x662F;&#x6839;&#x636E;&#x78C1;&#x76D8;&#x7C7B;&#x578B;&#x81EA;&#x52A8;&#x7684;&#x8FDB;&#x884C;&#x5C5E;&#x6027;&#x7684;&#x5173;&#x8054;&#xFF0C;&#x7136;&#x540E;&#x8FDB;&#x884C;&#x5206;&#x7C7B;&#x3002;&#x65E0;&#x9700;&#x624B;&#x52A8;&#x4FEE;&#x6539;<code>crushmap</code>&#xFF0C;&#x6781;&#x5927;&#x7684;&#x51CF;&#x5C11;&#x4E86;&#x4EBA;&#x4E3A;&#x7684;&#x64CD;&#x4F5C;&#x3002;</p>
<p><code>ceph</code>&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;<code>OSD</code>&#x8BBE;&#x5907;&#x90FD;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x4E00;&#x4E2A;<code>class</code>&#x7C7B;&#x578B;&#x4E0E;&#x4E4B;&#x5173;&#x8054;&#xFF0C;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5728;&#x521B;&#x5EFA;<code>OSD</code>&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x81EA;&#x52A8;&#x8BC6;&#x522B;&#x8BBE;&#x5907;&#x7C7B;&#x578B;&#xFF0C;&#x7136;&#x540E;&#x8BBE;&#x7F6E;&#x8BE5;&#x8BBE;&#x5907;&#x4E3A;&#x76F8;&#x5E94;&#x7684;&#x7C7B;&#x3002;&#x901A;&#x5E38;&#x6709;&#x4E09;&#x79CD;<code>class</code>&#x7C7B;&#x578B;&#xFF1A;<code>hdd</code>&#xFF0C;<code>ssd</code>&#xFF0C;<code>nvme</code>&#x3002;</p>
<p>&#x67E5;&#x770B;&#x96C6;&#x7FA4;OSD crush tree(ceph01&#x8282;&#x70B9;&#x6267;&#x884C;)</p>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd crush tree --show-shadow
ID CLASS WEIGHT   TYPE NAME
-2   ssd 25.76233 root default~ssd
-4   ssd  9.75183     host ceph01~ssd
 0   ssd  0.87329         OSD.0
 1   ssd  0.87329         OSD.1
 2   ssd  0.87329         OSD.2
 3   ssd  0.87329         OSD.3
 4   ssd  0.87329         OSD.4
 5   ssd  0.87329         OSD.5
 6   ssd  0.87329         OSD.6
 7   ssd  0.90970         OSD.7
 8   ssd  0.90970         OSD.8
 9   ssd  0.90970         OSD.9
10   ssd  0.90970         OSD.10
-6   ssd  8.00525     host ceph02~ssd
11   ssd  0.87329         OSD.11
12   ssd  0.87329         OSD.12
13   ssd  0.87329         OSD.13
14   ssd  0.87329         OSD.14
15   ssd  0.87329         OSD.15
16   ssd  0.90970         OSD.16
17   ssd  0.90970         OSD.17
18   ssd  0.90970         OSD.18
19   ssd  0.90970         OSD.19
-8   ssd  8.00525     host ceph03~ssd
20   ssd  0.87329         OSD.20
21   ssd  0.87329         OSD.21
22   ssd  0.87329         OSD.22
23   ssd  0.87329         OSD.23
24   ssd  0.87329         OSD.24
25   ssd  0.90970         OSD.25
26   ssd  0.90970         OSD.26
27   ssd  0.90970         OSD.27
28   ssd  0.90970         OSD.28
</code></pre><ul>
<li>&#x914D;&#x7F6E;</li>
</ul>
<p>&#x4FEE;&#x6539;nvme&#x7C7B;&#x578B;class</p>
<pre class="language-"><code>ceph osd crush rm-device-class 7
ceph osd crush set-device-class nvme OSD.7
ceph osd crush rm-device-class 8
ceph osd crush set-device-class nvme OSD.8
ceph osd crush rm-device-class 9
ceph osd crush set-device-class nvme OSD.9
ceph osd crush rm-device-class 10
ceph osd crush set-device-class nvme OSD.10

ceph osd crush rm-device-class 16
ceph osd crush set-device-class nvme OSD.16
ceph osd crush rm-device-class 17
ceph osd crush set-device-class nvme OSD.17
ceph osd crush rm-device-class 18
ceph osd crush set-device-class nvme OSD.18
ceph osd crush rm-device-class 19
ceph osd crush set-device-class nvme OSD.19

ceph osd crush rm-device-class 25
ceph osd crush set-device-class nvme OSD.25
ceph osd crush rm-device-class 26
ceph osd crush set-device-class nvme OSD.26
ceph osd crush rm-device-class 27
ceph osd crush set-device-class nvme OSD.27
ceph osd crush rm-device-class 28
ceph osd crush set-device-class nvme OSD.28
</code></pre><blockquote>
<p>&#x67E5;&#x770B;&#x96C6;&#x7FA4;OSD crush tree</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd crush tree --show-shadow
ID  CLASS WEIGHT   TYPE NAME
-12  nvme 10.91638 root default~nvme
 -9  nvme  3.63879     host ceph01~nvme
  7  nvme  0.90970         OSD.7
  8  nvme  0.90970         OSD.8
  9  nvme  0.90970         OSD.9
 10  nvme  0.90970         OSD.10
-10  nvme  3.63879     host ceph02~nvme
 16  nvme  0.90970         OSD.16
 17  nvme  0.90970         OSD.17
 18  nvme  0.90970         OSD.18
 19  nvme  0.90970         OSD.19
-11  nvme  3.63879     host ceph03~nvme
 25  nvme  0.90970         OSD.25
 26  nvme  0.90970         OSD.26
 27  nvme  0.90970         OSD.27
 28  nvme  0.90970         OSD.28
 -2   ssd 14.84595 root default~ssd
 -4   ssd  6.11304     host ceph01~ssd
  0   ssd  0.87329         OSD.0
  1   ssd  0.87329         OSD.1
  2   ssd  0.87329         OSD.2
  3   ssd  0.87329         OSD.3
  4   ssd  0.87329         OSD.4
  5   ssd  0.87329         OSD.5
  6   ssd  0.87329         OSD.6
 -6   ssd  4.36646     host ceph02~ssd
 11   ssd  0.87329         OSD.11
 12   ssd  0.87329         OSD.12
 13   ssd  0.87329         OSD.13
 14   ssd  0.87329         OSD.14
 15   ssd  0.87329         OSD.15
 -8   ssd  4.36646     host ceph03~ssd
 20   ssd  0.87329         OSD.20
 21   ssd  0.87329         OSD.21
 22   ssd  0.87329         OSD.22
 23   ssd  0.87329         OSD.23
 24   ssd  0.87329         OSD.24
</code></pre><h3 id="crush-pool"><a name="crush-pool" class="anchor-navigation-ex-anchor" href="#crush-pool"><i class="fa fa-link" aria-hidden="true"></i></a>crush pool</h3>
<h4 id="ssd-crush-rule"><a name="ssd-crush-rule" class="anchor-navigation-ex-anchor" href="#ssd-crush-rule"><i class="fa fa-link" aria-hidden="true"></i></a>ssd crush rule</h4>
<blockquote>
<p>&#x521B;&#x5EFA;crush rule</p>
</blockquote>
<pre class="language-"><code>#ceph osd crush rule create-replicated <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule-name</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>failure-domain</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>class</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>&#x521B;&#x5EFA;<code>class</code> &#x4E3A;<code>SSD</code>&#x7684;rule</p>
<pre class="language-"><code>ceph osd crush rule create-replicated SSD_rule default host ssd
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;&#x8D44;&#x6E90;&#x6C60;</p>
</blockquote>
<pre class="language-"><code>#ceph osd pool create {pool_name} {pg_num} [{pgp_num}]
ceph osd pool create ssd-pool 256 256
</code></pre><blockquote>
<p>&#x67E5;&#x770B;<code>ssd-pool</code>crush rule</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd pool get ssd-pool crush_rule
crush_rule: replicated_rule
</code></pre><blockquote>
<p>&#x8BBE;&#x7F6E;<code>ssd-pool</code>crush rule&#x4E3A;<code>SSD_rule</code></p>
</blockquote>
<pre class="language-"><code>#ceph osd pool set <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pool-name</span><span class="token punctuation">&gt;</span></span> crush_rule <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule-name</span><span class="token punctuation">&gt;</span></span>
ceph osd pool set ssd-pool crush_rule SSD_rule
</code></pre><blockquote>
<p>&#x67E5;&#x770B;<code>ssd-pool</code>crush rule</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd pool get ssd-pool crush_rule
crush_rule: SSD_rule
</code></pre><blockquote>
<p>&#x8BBE;&#x7F6E;<code>ssd-pool</code>&#x914D;&#x989D;</p>
</blockquote>
<pre class="language-"><code>#osd pool set-quota <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> max_objects|max_bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>val</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>&#x8BBE;&#x7F6E;&#x6700;&#x5927;&#x5BF9;&#x8C61;&#x6570;10</p>
<pre class="language-"><code>ceph osd pool set-quota ssd-pool max_objects 10
</code></pre><p>&#x8BBE;&#x7F6E;&#x5B58;&#x50A8;&#x5927;&#x5C0F;&#x4E3A;1G</p>
<pre class="language-"><code>ceph osd pool set-quota ssd-pool max_bytes 1G
</code></pre><blockquote>
<p>&#x6269;&#x5BB9;<code>ssd-pool</code>&#x914D;&#x989D;</p>
</blockquote>
<pre class="language-"><code>#osd pool set-quota <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> max_objects|max_bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>val</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>&#x8BBE;&#x7F6E;&#x6700;&#x5927;&#x5BF9;&#x8C61;&#x6570;20</p>
<pre class="language-"><code>ceph osd pool set-quota ssd-pool max_objects 20
</code></pre><p>&#x8BBE;&#x7F6E;&#x5B58;&#x50A8;&#x5927;&#x5C0F;&#x4E3A;2G</p>
<pre class="language-"><code>ceph osd pool set-quota ssd-pool max_bytes 2G
</code></pre><blockquote>
<p>&#x4FEE;&#x6539;<code>ssd-pool</code>&#x4E3A;<code>ssd-demo-pool</code></p>
</blockquote>
<pre class="language-"><code> ceph osd pool rename ssd-pool ssd-demo-pool
</code></pre><h4 id="nvme-crush-rule"><a name="nvme-crush-rule" class="anchor-navigation-ex-anchor" href="#nvme-crush-rule"><i class="fa fa-link" aria-hidden="true"></i></a>nvme crush rule</h4>
<blockquote>
<p>&#x521B;&#x5EFA;crush rule</p>
</blockquote>
<pre class="language-"><code>#ceph osd crush rule create-replicated <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule-name</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>failure-domain</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>class</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>&#x521B;&#x5EFA;<code>class</code> &#x4E3A;<code>nvme</code>&#x7684;rule</p>
<pre class="language-"><code>ceph osd crush rule create-replicated nvme_rule default host nvme
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;&#x8D44;&#x6E90;&#x6C60;</p>
</blockquote>
<pre class="language-"><code>#ceph osd pool create {pool_name} {pg_num} [{pgp_num}]
ceph osd pool create nvme-pool 256 256
</code></pre><blockquote>
<p>&#x67E5;&#x770B;<code>nvme-pool</code>crush rule</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd pool get nvme-pool crush_rule
crush_rule: replicated_rule
</code></pre><blockquote>
<p>&#x8BBE;&#x7F6E;<code>nvme-pool</code>crush rule&#x4E3A;<code>nvme_rule</code></p>
</blockquote>
<pre class="language-"><code>#ceph osd pool set <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pool-name</span><span class="token punctuation">&gt;</span></span> crush_rule <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule-name</span><span class="token punctuation">&gt;</span></span>
ceph osd pool set nvme-pool crush_rule nvme_rule
</code></pre><blockquote>
<p>&#x67E5;&#x770B;<code>nvme-pool</code>crush rule</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd pool get nvme-pool crush_rule
crush_rule: nvme_rule
</code></pre><blockquote>
<p>&#x8BBE;&#x7F6E;<code>nvme-pool</code>&#x914D;&#x989D;</p>
</blockquote>
<pre class="language-"><code>#osd pool set-quota <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> max_objects|max_bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>val</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>&#x8BBE;&#x7F6E;&#x6700;&#x5927;&#x5BF9;&#x8C61;&#x6570;10</p>
<pre class="language-"><code>ceph osd pool set-quota nvme-pool max_objects 10
</code></pre><p>&#x8BBE;&#x7F6E;&#x5B58;&#x50A8;&#x5927;&#x5C0F;&#x4E3A;1G</p>
<pre class="language-"><code>ceph osd pool set-quota nvme-pool max_bytes 1G
</code></pre><blockquote>
<p>&#x6269;&#x5BB9;<code>ssd-pool</code>&#x914D;&#x989D;</p>
</blockquote>
<pre class="language-"><code>#osd pool set-quota <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> max_objects|max_bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>val</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>&#x8BBE;&#x7F6E;&#x6700;&#x5927;&#x5BF9;&#x8C61;&#x6570;20</p>
<pre class="language-"><code>ceph osd pool set-quota nvme-pool max_objects 20
</code></pre><p>&#x8BBE;&#x7F6E;&#x5B58;&#x50A8;&#x5927;&#x5C0F;&#x4E3A;2G</p>
<pre class="language-"><code>ceph osd pool set-quota nvme-pool max_bytes 2G
</code></pre><blockquote>
<p>&#x4FEE;&#x6539;<code>nvme-pool</code>&#x4E3A;<code>nvme-demo-pool</code></p>
</blockquote>
<pre class="language-"><code> ceph osd pool rename nvme-pool nvme-demo-pool
</code></pre><h4 id="&#x6D4B;&#x8BD5;crush-rule"><a name="&#x6D4B;&#x8BD5;crush-rule" class="anchor-navigation-ex-anchor" href="#&#x6D4B;&#x8BD5;crush-rule"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6D4B;&#x8BD5;crush rule</h4>
<blockquote>
<p>&#x67E5;&#x770B;<code>crush class</code></p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd crush class ls
[
    &quot;ssd&quot;,
    &quot;nvme&quot;
]
</code></pre><blockquote>
<p>&#x67E5;&#x770B;<code>crush rule</code></p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd crush rule ls
replicated_rule
SSD_rule
nvme_rule
</code></pre><blockquote>
<p>&#x67E5;&#x770B;&#x6C60;<code>cursh rule</code></p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd pool ls detail
pool 1 &apos;ssd-demo-pool&apos; replicated size 3 min_size 2 crush_rule 1 object_hash rjenkins pg_num 256 pgp_num 256 autoscale_mode warn last_change 256 flags hashpspool max_bytes 2147483648 max_objects 20 stripe_width 0
pool 2 &apos;nvme-demo-pool&apos; replicated size 3 min_size 2 crush_rule 2 object_hash rjenkins pg_num 256 pgp_num 256 autoscale_mode warn last_change 266 flags hashpspool max_bytes 2147483648 max_objects 20 stripe_width 0
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;<code>object-ssd</code>&#x5E76;&#x653E;&#x5230;<code>ssd-demo-pool</code>&#x4E2D;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# rados -p ssd-demo-pool ls
[root@ceph01 ~]# echo &quot;000000&quot; &gt; object-ssd.txt
[root@ceph01 ~]# rados -p ssd-demo-pool put object-ssd object-ssd.txt 
[root@ceph01 ~]# rados -p ssd-demo-pool ls
object-ssd
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;<code>object-nvme</code>&#x5E76;&#x653E;&#x5230;<code>nvme-demo-pool</code>&#x4E2D;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# rados -p nvme-demo-pool ls
[root@ceph01 ~]# echo &quot;111111&quot; &gt; object-nvme.txt
[root@ceph01 ~]# rados -p nvme-demo-pool put object-nvme object-nvme.txt 
[root@ceph01 ~]# rados -p nvme-demo-pool ls
object-nvme
</code></pre><blockquote>
<p>&#x67E5;&#x770B;<code>object-ssd</code>&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x60C5;&#x51B5;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd map ssd-demo-pool object-ssd
OSDmap e267 pool &apos;ssd-demo-pool&apos; (1) object &apos;object-ssd&apos; -&gt; pg 1.cffcc003 (1.3) -&gt; up ([13,1,21], p13) acting ([13,1,21], p13)
</code></pre><blockquote>
<p>&#x67E5;&#x770B;<code>object-nvme</code>&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x60C5;&#x51B5;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd map nvme-demo-pool object-nvme
OSDmap e267 pool &apos;nvme-demo-pool&apos; (2) object &apos;object-nvme&apos; -&gt; pg 2.2d6e9780 (2.80) -&gt; up ([28,19,8], p28) acting ([28,19,8], p28)
</code></pre><blockquote>
<p>&#x786E;&#x8BA4;&#x5B58;&#x50A8;<code>OSD</code></p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd tree
ID CLASS WEIGHT   TYPE NAME       STATUS REWEIGHT PRI-AFF
-1       25.76233 root default
-3        9.75183     host ceph01
 7  nvme  0.90970         OSD.7       up  1.00000 1.00000
 8  nvme  0.90970         OSD.8       up  1.00000 1.00000
 9  nvme  0.90970         OSD.9       up  1.00000 1.00000
10  nvme  0.90970         OSD.10      up  1.00000 1.00000
 0   ssd  0.87329         OSD.0       up  1.00000 1.00000
 1   ssd  0.87329         OSD.1       up  1.00000 1.00000
 2   ssd  0.87329         OSD.2       up  1.00000 1.00000
 3   ssd  0.87329         OSD.3       up  1.00000 1.00000
 4   ssd  0.87329         OSD.4       up  1.00000 1.00000
 5   ssd  0.87329         OSD.5       up  1.00000 1.00000
 6   ssd  0.87329         OSD.6       up  1.00000 1.00000
-5        8.00525     host ceph02
16  nvme  0.90970         OSD.16      up  1.00000 1.00000
17  nvme  0.90970         OSD.17      up  1.00000 1.00000
18  nvme  0.90970         OSD.18      up  1.00000 1.00000
19  nvme  0.90970         OSD.19      up  1.00000 1.00000
11   ssd  0.87329         OSD.11      up  1.00000 1.00000
12   ssd  0.87329         OSD.12      up  1.00000 1.00000
13   ssd  0.87329         OSD.13      up  1.00000 1.00000
14   ssd  0.87329         OSD.14      up  1.00000 1.00000
15   ssd  0.87329         OSD.15      up  1.00000 1.00000
-7        8.00525     host ceph03
25  nvme  0.90970         OSD.25      up  1.00000 1.00000
26  nvme  0.90970         OSD.26      up  1.00000 1.00000
27  nvme  0.90970         OSD.27      up  1.00000 1.00000
28  nvme  0.90970         OSD.28      up  1.00000 1.00000
20   ssd  0.87329         OSD.20      up  1.00000 1.00000
21   ssd  0.87329         OSD.21      up  1.00000 1.00000
22   ssd  0.87329         OSD.22      up  1.00000 1.00000
23   ssd  0.87329         OSD.23      up  1.00000 1.00000
24   ssd  0.87329         OSD.24      up  1.00000 1.00000
</code></pre><p><code>object-ssd</code>&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x4E8E;<code>OSD.13</code>&#x3001;<code>OSD.1</code>&#x3001;<code>OSD.21</code>&#xFF0C;&#x5373;<code>ssd class</code>&#xFF0C;&#x5BF9;&#x5E94;<code>ssd</code>&#x7C7B;&#x578B;&#x78C1;&#x76D8;</p>
<p><code>object-nvme</code>&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x4E8E;<code>OSD.28</code>&#x3001;<code>OSD.19</code>&#x3001;<code>OSD.8</code>&#xFF0C;&#x5373;<code>nvme class</code>&#xFF0C;&#x5BF9;&#x5E94;<code>nvme</code>&#x7C7B;&#x578B;&#x78C1;&#x76D8;</p>
<p><strong>&#x6700;&#x4F73;&#x5B9E;&#x8DF5;&#xFF1A;&#x521B;&#x5EFA;&#x4E0D;&#x540C;&#x7C7B;&#x578B;&#x5B58;&#x50A8;&#x6C60;&#xFF08;&#x57FA;&#x4E8E;HDD&#x3001;SSD&#xFF0C;&#x63D0;&#x4F9B;&#x4E0D;&#x540C;&#x573A;&#x666F;&#x4F7F;&#x7528;&#xFF09;</strong></p>
<h3 id="&#x5B89;&#x88C5;dashboard"><a name="&#x5B89;&#x88C5;dashboard" class="anchor-navigation-ex-anchor" href="#&#x5B89;&#x88C5;dashboard"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5B89;&#x88C5;dashboard</h3>
<ul>
<li><a href="http://download.ceph.com/rpm-nautilus/el7/noarch/" target="_blank">rpm</a></li>
</ul>
<blockquote>
<p>&#x5B89;&#x88C5;</p>
</blockquote>
<pre class="language-"><code>ceph-deploy mgr create ceph01
</code></pre><blockquote>
<p>&#x542F;&#x7528;<code>Dashboard</code></p>
</blockquote>
<pre class="language-"><code>ceph mgr module enable dashboard
</code></pre><blockquote>
<p>&#x542F;&#x7528;&#x5FC5;&#x8981;&#x6A21;&#x5757;</p>
</blockquote>
<pre class="language-"><code>ceph mgr module enable pg_autoscaler
</code></pre><blockquote>
<p>&#x7528;&#x6237;&#x3001;&#x5BC6;&#x7801;&#x3001;&#x6743;&#x9650;</p>
</blockquote>
<pre class="language-"><code># &#x521B;&#x5EFA;&#x7528;&#x6237;
#ceph dashboard ac-user-create <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>username</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">&gt;</span></span> administrator
ceph dashboard ac-user-create admin Ceph-12345 administrator
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;&#x81EA;&#x7B7E;&#x8BC1;&#x4E66;</p>
</blockquote>
<pre class="language-"><code>ceph dashboard create-self-signed-cert
</code></pre><blockquote>
<p>&#x67E5;&#x770B;<code>Dashboard</code>&#x5730;&#x5740;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph mgr services
{
    &quot;dashboard&quot;: &quot;https://ceph01:8443/&quot;
}
</code></pre><blockquote>
<p>&#x767B;&#x5F55;&#x8BBF;&#x95EE;</p>
</blockquote>
<p><img src="images/ceph-ui.png" alt=""></p>
<blockquote>
<p>&#x4FEE;&#x6539;&#x7AEF;&#x53E3;</p>
</blockquote>
<p>&#x786E;&#x8BA4;&#x914D;&#x7F6E;</p>
<pre class="language-"><code>[root@ceph01 ~]# ceph config-key  ls
[
    &quot;config-history/1/&quot;,
    &quot;config-history/2/&quot;,
    &quot;config-history/2/+global/osd_pool_default_pg_autoscale_mode&quot;,
    &quot;config/global/osd_pool_default_pg_autoscale_mode&quot;,
    &quot;mgr/dashboard/accessdb_v1&quot;,
    &quot;mgr/dashboard/crt&quot;,
    &quot;mgr/dashboard/jwt_secret&quot;,
    &quot;mgr/dashboard/key&quot;
]
</code></pre><p>&#x4FEE;&#x6539;&#x7AEF;&#x53E3;</p>
<pre class="language-"><code>ceph config set mgr mgr/dashboard/ssl_server_port 7000
</code></pre><p>&#x4F7F;&#x53D8;&#x66F4;&#x7684;&#x914D;&#x7F6E;&#x751F;&#x6548;</p>
<pre class="language-"><code>ceph mgr module disable dashboard
ceph mgr module enable dashboard
</code></pre><blockquote>
<p>&#x914D;&#x7F6E;&#x8BBF;&#x95EE;&#x524D;&#x7F00;</p>
</blockquote>
<pre class="language-"><code>ceph config set mgr mgr/dashboard/url_prefix /ceph-ui
</code></pre><p>&#x91CD;&#x542F;<code>mgr</code></p>
<pre class="language-"><code>systemctl restart ceph-mgr@ceph01
</code></pre><h1 id="ceph&#x5B58;&#x50A8;&#x5B9E;&#x8DF5;"><a name="ceph&#x5B58;&#x50A8;&#x5B9E;&#x8DF5;" class="anchor-navigation-ex-anchor" href="#ceph&#x5B58;&#x50A8;&#x5B9E;&#x8DF5;"><i class="fa fa-link" aria-hidden="true"></i></a>ceph&#x5B58;&#x50A8;&#x5B9E;&#x8DF5;</h1>
<h2 id="&#x5757;&#x8BBE;&#x5907;&#x4F7F;&#x7528;"><a name="&#x5757;&#x8BBE;&#x5907;&#x4F7F;&#x7528;" class="anchor-navigation-ex-anchor" href="#&#x5757;&#x8BBE;&#x5907;&#x4F7F;&#x7528;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5757;&#x8BBE;&#x5907;&#x4F7F;&#x7528;</h2>
<h3 id="ceph&#x7BA1;&#x7406;&#x8282;&#x70B9;"><a name="ceph&#x7BA1;&#x7406;&#x8282;&#x70B9;" class="anchor-navigation-ex-anchor" href="#ceph&#x7BA1;&#x7406;&#x8282;&#x70B9;"><i class="fa fa-link" aria-hidden="true"></i></a>ceph&#x7BA1;&#x7406;&#x8282;&#x70B9;</h3>
<blockquote>
<p>&#x521B;&#x5EFA;&#x6C60;&#xFF08;SSD_rule&#x4E3A;crush&#x89C4;&#x5219;&#xFF09;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd pool create rbd-demo-pool 64 64 
pool &apos;rbd-demo-pool&apos; created
</code></pre><blockquote>
<p>&#x8BBE;&#x7F6E;&#x914D;&#x989D;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd pool set-quota rbd-demo-pool max_bytes 1G
set-quota max_bytes = 1073741824 for pool rbd-demo-pool
</code></pre><blockquote>
<p>&#x5173;&#x8054;&#x5E94;&#x7528;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd pool application enable rbd-demo-pool rbd
enabled application &apos;rbd&apos; on pool &apos;rbd-demo-pool&apos;
</code></pre><blockquote>
<p>&#x521D;&#x59CB;&#x5316;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# rbd pool init rbd-demo-pool
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;rbd&#x7528;&#x6237;</p>
</blockquote>
<pre class="language-"><code>ceph auth get-or-create client.qemu mon &apos;profile rbd&apos; osd &apos;profile rbd pool=rbd-demo-pool&apos; mgr &apos;profile rbd pool=rbd-demo-pool&apos; -o /etc/ceph/ceph.client.qemu.keyring
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;rbd&#x6620;&#x50CF;</p>
</blockquote>
<p>&#x5728;&#x5C06;&#x5757;&#x8BBE;&#x5907;&#x6DFB;&#x52A0;&#x5230;&#x8282;&#x70B9;&#x4E4B;&#x524D;&#xFF0C;&#x5FC5;&#x987B;&#x5148;&#x5728;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x4E2D;&#x4E3A;&#x5176;&#x521B;&#x5EFA;&#x6620;&#x50CF;&#x3002;&#x8981;&#x521B;&#x5EFA;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;&#xFF0C;&#x8BF7;&#x6267;&#x884C;&#x4EE5;&#x4E0B;&#x64CD;&#x4F5C;&#xFF1A;</p>
<pre class="language-"><code>rbd create --size 1G rbd-demo-pool/rbd-demo-image
</code></pre><blockquote>
<p>&#x67E5;&#x770B;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;</p>
</blockquote>
<pre class="language-"><code># rbd ls {poolname}
[root@ceph01 ~]# rbd ls rbd-demo-pool
rbd-demo-image
</code></pre><blockquote>
<p>&#x67E5;&#x770B;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;&#x4FE1;&#x606F;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# rbd info rbd-demo-pool/rbd-demo-image
rbd image &apos;rbd-demo-image&apos;:
        size 1 GiB in 256 objects
        order 22 (4 MiB objects)
        snapshot_count: 0
        id: 3d92a06e59b5
        block_name_prefix: rbd_data.3d92a06e59b5
        format: 2
        features: layering, exclusive-lock, object-map, fast-diff, deep-flatten
        op_features:
        flags:
        create_timestamp: Fri Mar 19 15:45:58 2021
        access_timestamp: Fri Mar 19 15:45:58 2021
        modify_timestamp: Fri Mar 19 15:45:58 2021
</code></pre><h3 id="&#x5BA2;&#x6237;&#x7AEF;"><a name="&#x5BA2;&#x6237;&#x7AEF;" class="anchor-navigation-ex-anchor" href="#&#x5BA2;&#x6237;&#x7AEF;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5BA2;&#x6237;&#x7AEF;</h3>
<blockquote>
<p>&#x5220;&#x9664;&#x539F;&#x6709;yum&#x6E90;repo&#x6587;&#x4EF6;</p>
</blockquote>
<pre class="language-"><code>rm -f /etc/yum.repos.d/*.repo
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;yum&#x6E90;&#x6587;&#x4EF6;&#xFF08;&#x5BA2;&#x6237;&#x7AEF;&#xFF09;</p>
</blockquote>
<p><strong>online</strong></p>
<pre class="language-"><code>curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo
curl -o /etc/yum.repos.d/epel-7.repo http://mirrors.aliyun.com/repo/epel-7.repo
</code></pre><p><strong>offline</strong></p>
<p>&#x4E0B;&#x8F7D;&#x4EE5;&#x4E0B;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x81F3;<code>/etc/yum.repos.d/</code></p>
<ul>
<li><a href="http://mirrors.aliyun.com/repo/Centos-7.repo" target="_blank">Centos-7.repo</a></li>
<li><a href="http://mirrors.aliyun.com/repo/epel-7.repo" target="_blank">epel-7.repo</a></li>
</ul>
<blockquote>
<p>&#x914D;&#x7F6E;<code>ceph</code>&#x955C;&#x50CF;&#x6E90;&#x4ED3;&#x5E93;</p>
</blockquote>
<pre class="language-"><code>cat &gt; /etc/yum.repos.d/ceph.repo &lt;&lt;EOF
[Ceph]
name=Ceph \$basearch
baseurl=https://mirrors.aliyun.com/ceph/rpm-nautilus/el7/\$basearch
enabled=1
gpgcheck=1
gpgkey=https://mirrors.aliyun.com/ceph/keys/release.asc

[Ceph-noarch]
name=Ceph noarch
baseurl=https://mirrors.aliyun.com/ceph/rpm-nautilus/el7/noarch
enabled=1
gpgcheck=1
gpgkey=https://mirrors.aliyun.com/ceph/keys/release.asc

[Ceph-source]
name=Ceph SRPMS
baseurl=https://mirrors.aliyun.com/ceph/rpm-nautilus/el7/SRPMS
enabled=1
gpgcheck=1
gpgkey=https://mirrors.aliyun.com/ceph/keys/release.asc
EOF
</code></pre><blockquote>
<p>&#x914D;&#x7F6E;<code>yum</code>&#x4EE3;&#x7406;</p>
</blockquote>
<p><strong>&#x9002;&#x7528;&#x4E8E;&#x4E3B;&#x673A;&#x901A;&#x8FC7;&#x4EE3;&#x7406;&#x8BBF;&#x95EE;&#x4E92;&#x8054;&#x7F51;&#x573A;&#x666F;</strong></p>
<p>&#x4EE5;&#x4E0B;&#x53D8;&#x91CF;&#x6CE8;&#x610F;&#x66FF;&#x6362;</p>
<ul>
<li>username: &#x4EE3;&#x7406;&#x7528;&#x6237;&#x540D;</li>
<li>password: &#x4EE3;&#x7406;&#x7528;&#x6237;&#x5BC6;&#x7801;</li>
<li>proxy_host: &#x4EE3;&#x7406;IP&#x5730;&#x5740;</li>
<li>proxy_port: &#x4EE3;&#x7406;&#x7AEF;&#x53E3;</li>
</ul>
<pre class="language-"><code>echo &quot;proxy=http://username:password@proxy_host:proxy_port&quot; &gt;&gt; /etc/yum.conf
</code></pre><blockquote>
<p>&#x5B89;&#x88C5;<code>ceph-common</code></p>
</blockquote>
<pre class="language-"><code>yum install -y ceph-common
</code></pre><blockquote>
<p>&#x62F7;&#x8D1D;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</p>
</blockquote>
<pre class="language-"><code>mkdir -p /etc/ceph
</code></pre><p>&#x5BA2;&#x6237;&#x7AEF;&#x521B;&#x5EFA;&#x6302;&#x8F7D;&#x76EE;&#x5F55;</p>
<pre class="language-"><code>mkdir -p /ceph
chmod 777 /ceph
</code></pre><p>&#x4ECE;&#x670D;&#x52A1;&#x7AEF;<code>scp</code>&#x4EE5;&#x4E0B;&#x6587;&#x4EF6;&#x81F3;&#x5BA2;&#x6237;&#x7AEF;<code>/etc/ceph</code>&#x4E0B;</p>
<ul>
<li><code>/etc/ceph/ceph.client.qemu.keyring</code></li>
<li><code>/etc/ceph/ceph.conf</code></li>
</ul>
<pre class="language-"><code>scp /etc/ceph/{ceph.conf,ceph.client.admin.keyring} ip:/etc/ceph/
</code></pre><blockquote>
<p>&#x6620;&#x5C04;&#x5757;&#x8BBE;&#x5907;</p>
</blockquote>
<pre class="language-"><code>[root@localhost ~]# rbd map rbd-demo-pool/rbd-demo-image --name client.qemu
/dev/rbd0
[root@localhost ~]# echo &quot;rbd-demo-pool/rbd-demo-image id=qemu,keyring=/etc/ceph/ceph.client.qemu.keyring&quot; &gt;&gt; /etc/ceph/rbdmap
</code></pre><blockquote>
<p>&#x683C;&#x5F0F;&#x5316;&#x5757;&#x8BBE;&#x5907;</p>
</blockquote>
<pre class="language-"><code> mkfs.ext4 -q /dev/rbd0
</code></pre><blockquote>
<p>&#x6302;&#x8F7D;&#x4F7F;&#x7528;</p>
</blockquote>
<pre class="language-"><code>mount /dev/rbd0 /ceph
</code></pre><blockquote>
<p>&#x67E5;&#x770B;&#x6302;&#x8F7D;</p>
</blockquote>
<pre class="language-"><code>lsblk
</code></pre><blockquote>
<p>&#x67E5;&#x770B;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x5C04;</p>
</blockquote>
<pre class="language-"><code>[root@localhost ~]# rbd device list
id pool          namespace image          snap device
0  rbd-demo-pool           rbd-demo-image -    /dev/rbd0
</code></pre><blockquote>
<p>&#x4FEE;&#x6539;<code>fstab</code>&#xFF0C;&#x8BBE;&#x7F6E;&#x5F00;&#x673A;&#x6302;&#x8F7D;</p>
</blockquote>
<pre class="language-"><code>echo &quot;/dev/rbd0 /ceph ext4 defaults,noatime,_netdev 0 0&quot; &gt;&gt; /etc/fstab
</code></pre><blockquote>
<p>&#x914D;&#x7F6E;&#x5F00;&#x673A;&#x81EA;&#x542F;&#x52A8;</p>
</blockquote>
<pre class="language-"><code>vim /etc/init.d/rbdmap

#!/bin/bash
#chkconfig: 2345 80 60
#description: start/stop rbdmap
### BEGIN INIT INFO
# Provides:          rbdmap
# Required-Start:    $network
# Required-Stop:     $network
# Default-Start:     2 3 4 5
# Default-Stop:      0 1 6
# Short-Description: Ceph RBD Mapping
# Description:       Ceph RBD Mapping
### END INIT INFO

DESC=&quot;RBD Mapping&quot;
RBDMAPFILE=&quot;/etc/ceph/rbdmap&quot;

. /lib/lsb/init-functions
#. /etc/redhat-lsb/lsb_log_message&#xFF0C;&#x52A0;&#x5165;&#x6B64;&#x884C;&#x540E;&#x4E0D;&#x6B63;&#x957F;
do_map() {
    if [ ! -f &quot;$RBDMAPFILE&quot; ]; then
        echo &quot;$DESC : No $RBDMAPFILE found.&quot;
        exit 0
    fi

    echo &quot;Starting $DESC&quot;
    # Read /etc/rbdtab to create non-existant mapping
    newrbd=
    RET=0
    while read DEV PARAMS; do
        case &quot;$DEV&quot; in
          &quot;&quot;|\#*)
            continue
            ;;
          */*)
            ;;
          *)
            DEV=rbd/$DEV
            ;;
        esac
        OIFS=$IFS
        IFS=&apos;,&apos;
        for PARAM in ${PARAMS[@]}; do
            CMDPARAMS=&quot;$CMDPARAMS --$(echo $PARAM | tr &apos;=&apos; &apos; &apos;)&quot;
        done
        IFS=$OIFS
        if [ ! -b /dev/rbd/$DEV ]; then
            echo $DEV
            rbd map $DEV $CMDPARAMS
            [ $? -ne &quot;0&quot; ] &amp;&amp; RET=1
            newrbd=&quot;yes&quot;
        fi
    done &lt; $RBDMAPFILE
    echo $RET

    # Mount new rbd
    if [ &quot;$newrbd&quot; ]; then
                echo &quot;Mounting all filesystems&quot;
        mount -a
        echo $?
    fi
}

do_unmap() {
    echo &quot;Stopping $DESC&quot;
    RET=0
    # Unmap all rbd device
    for DEV in /dev/rbd[0-9]*; do
        echo $DEV
        # Umount before unmap
        MNTDEP=$(findmnt --mtab --source $DEV --output TARGET | sed 1,1d | sort -r)
        for MNT in $MNTDEP; do
            umount $MNT || sleep 1 &amp;&amp; umount -l $DEV
        done
        rbd unmap $DEV
        [ $? -ne &quot;0&quot; ] &amp;&amp; RET=1
    done
    echo $RET
}


case &quot;$1&quot; in
  start)
    do_map
    ;;

  stop)
    do_unmap
    ;;

  reload)
    do_map
    ;;

  status)
    rbd showmapped
    ;;

  *)
    echo &quot;Usage: rbdmap {start|stop|reload|status}&quot;
    exit 1
    ;;
esac

exit 0
</code></pre><p>&#x8D4B;&#x6743;</p>
<pre class="language-"><code>yum install redhat-lsb -y
chmod +x /etc/init.d/rbdmap
service rbdmap start 
chkconfig rbdmap on
</code></pre><h3 id="&#x9002;&#x7528;&#x573A;&#x666F;"><a name="&#x9002;&#x7528;&#x573A;&#x666F;" class="anchor-navigation-ex-anchor" href="#&#x9002;&#x7528;&#x573A;&#x666F;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x9002;&#x7528;&#x573A;&#x666F;</h3>
<p><strong>&#x53EF;&#x4EE5;&#x5F53;&#x6210;&#x672C;&#x5730;&#x76D8;&#x6765;&#x7528;&#xFF1A;</strong></p>
<ul>
<li>&#x865A;&#x673A;&#x5B58;&#x50A8;</li>
<li>&#x5F00;&#x53D1;&#x6570;&#x636E;&#x5E93;&#x5B58;&#x50A8;</li>
<li>&#x5B58;&#x50A8;&#x65E5;&#x5FD7;</li>
</ul>
<h2 id="ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4F7F;&#x7528;"><a name="ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4F7F;&#x7528;" class="anchor-navigation-ex-anchor" href="#ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4F7F;&#x7528;"><i class="fa fa-link" aria-hidden="true"></i></a>ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4F7F;&#x7528;</h2>
<h3 id="&#x670D;&#x52A1;&#x7AEF;"><a name="&#x670D;&#x52A1;&#x7AEF;" class="anchor-navigation-ex-anchor" href="#&#x670D;&#x52A1;&#x7AEF;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x670D;&#x52A1;&#x7AEF;</h3>
<blockquote>
<p>&#x5B89;&#x88C5;<code>mds</code>&#xFF08;ceph&#x8282;&#x70B9;&#x5B89;&#x88C5;&#xFF0C;&#x5EFA;&#x8BAE;3&#x4E2A;<code>mds</code>&#xFF09;</p>
</blockquote>
<pre class="language-"><code>ceph-deploy mds create ceph01 ceph02 ceph03  
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;<code>cephfs</code>&#x5B58;&#x50A8;&#x6C60;&#x4E0E;&#x5143;&#x6570;&#x636E;&#x6C60;</p>
</blockquote>
<pre class="language-"><code>ceph osd pool create cephfs_data 64
ceph osd pool create cephfs_metadata 64
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</p>
</blockquote>
<pre class="language-"><code>ceph fs new cephfs cephfs_metadata cephfs_data
</code></pre><blockquote>
<p>&#x5173;&#x8054;&#x5E94;&#x7528;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd pool application enable cephfs_data cephfs
enabled application &apos;cephfs&apos; on pool &apos;cephfs_data&apos;
</code></pre><blockquote>
<p>&#x8BBE;&#x7F6E;&#x914D;&#x989D;</p>
</blockquote>
<pre class="language-"><code>ceph osd pool set-quota cephfs_data max_bytes 100G
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;&#x7528;&#x6237;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]#  ceph auth get-or-create client.cephfs mon &apos;allow r&apos; mds &apos;allow r, allow rw path=/&apos; osd &apos;allow rw pool=cephfs_data&apos;
[client.cephfs]
        key = AQCHWlRg46I6EBAAg+xBZnFsqOYIGluPd5h1QA==
</code></pre><h3 id="&#x5BA2;&#x6237;&#x7AEF;_1"><a name="&#x5BA2;&#x6237;&#x7AEF;_1" class="anchor-navigation-ex-anchor" href="#&#x5BA2;&#x6237;&#x7AEF;_1"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5BA2;&#x6237;&#x7AEF;</h3>
<p><strong>&#x5185;&#x6838;&#x9700;4.x</strong></p>
<blockquote>
<p>&#x5220;&#x9664;&#x539F;&#x6709;yum&#x6E90;repo&#x6587;&#x4EF6;</p>
</blockquote>
<pre class="language-"><code>rm -f /etc/yum.repos.d/*.repo
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;yum&#x6E90;&#x6587;&#x4EF6;&#xFF08;&#x5BA2;&#x6237;&#x7AEF;&#xFF09;</p>
</blockquote>
<p><strong>online</strong></p>
<pre class="language-"><code>curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo
curl -o /etc/yum.repos.d/epel-7.repo http://mirrors.aliyun.com/repo/epel-7.repo
</code></pre><p><strong>offline</strong></p>
<p>&#x4E0B;&#x8F7D;&#x4EE5;&#x4E0B;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x81F3;<code>/etc/yum.repos.d/</code></p>
<ul>
<li><a href="http://mirrors.aliyun.com/repo/Centos-7.repo" target="_blank">Centos-7.repo</a></li>
<li><a href="http://mirrors.aliyun.com/repo/epel-7.repo" target="_blank">epel-7.repo</a></li>
</ul>
<blockquote>
<p>&#x914D;&#x7F6E;<code>ceph</code>&#x955C;&#x50CF;&#x6E90;&#x4ED3;&#x5E93;</p>
</blockquote>
<pre class="language-"><code>cat &gt; /etc/yum.repos.d/ceph.repo &lt;&lt;EOF
[Ceph]
name=Ceph \$basearch
baseurl=https://mirrors.aliyun.com/ceph/rpm-nautilus/el7/\$basearch
enabled=1
gpgcheck=1
gpgkey=https://mirrors.aliyun.com/ceph/keys/release.asc

[Ceph-noarch]
name=Ceph noarch
baseurl=https://mirrors.aliyun.com/ceph/rpm-nautilus/el7/noarch
enabled=1
gpgcheck=1
gpgkey=https://mirrors.aliyun.com/ceph/keys/release.asc

[Ceph-source]
name=Ceph SRPMS
baseurl=https://mirrors.aliyun.com/ceph/rpm-nautilus/el7/SRPMS
enabled=1
gpgcheck=1
gpgkey=https://mirrors.aliyun.com/ceph/keys/release.asc
EOF
</code></pre><blockquote>
<p>&#x914D;&#x7F6E;<code>yum</code>&#x4EE3;&#x7406;</p>
</blockquote>
<p><strong>&#x9002;&#x7528;&#x4E8E;&#x4E3B;&#x673A;&#x901A;&#x8FC7;&#x4EE3;&#x7406;&#x8BBF;&#x95EE;&#x4E92;&#x8054;&#x7F51;&#x573A;&#x666F;</strong></p>
<p>&#x4EE5;&#x4E0B;&#x53D8;&#x91CF;&#x6CE8;&#x610F;&#x66FF;&#x6362;</p>
<ul>
<li>username: &#x4EE3;&#x7406;&#x7528;&#x6237;&#x540D;</li>
<li>password: &#x4EE3;&#x7406;&#x7528;&#x6237;&#x5BC6;&#x7801;</li>
<li>proxy_host: &#x4EE3;&#x7406;IP&#x5730;&#x5740;</li>
<li>proxy_port: &#x4EE3;&#x7406;&#x7AEF;&#x53E3;</li>
</ul>
<pre class="language-"><code>echo &quot;proxy=http://username:password@proxy_host:proxy_port&quot; &gt;&gt; /etc/yum.conf
</code></pre><blockquote>
<p>&#x5B89;&#x88C5;<code>ceph-common</code></p>
</blockquote>
<pre class="language-"><code>yum install -y ceph-common
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;&#x76EE;&#x5F55;</p>
</blockquote>
<p>&#x914D;&#x7F6E;&#x76EE;&#x5F55;</p>
<pre class="language-"><code>mkdir -p /etc/ceph
</code></pre><p>&#x6302;&#x8F7D;<code>cephfs</code>&#x76EE;&#x5F55;</p>
<pre class="language-"><code>mkdir -p /cephfs
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;&#x8BA4;&#x8BC1;&#x6587;&#x4EF6;</p>
</blockquote>
<p><strong>&#x670D;&#x52A1;&#x7AEF;&#x6267;&#x884C;&#x4EE5;&#x4E0B;&#x547D;&#x4EE4;&#x83B7;&#x53D6;cephfs&#x7528;&#x6237;&#x8BA4;&#x8BC1;&#x4FE1;&#x606F;</strong></p>
<pre class="language-"><code>[root@ceph01 ~]# ceph auth get client.cephfs
exported keyring for client.cephfs
[client.cephfs]
        key = AQCHWlRg46I6EBAAg+xBZnFsqOYIGluPd5h1QA==
        caps mds = &quot;allow r, allow rw path=/&quot;
        caps mon = &quot;allow r&quot;
        caps osd = &quot;allow rw pool=cephfs_data&quot;
</code></pre><p>&#x5BA2;&#x6237;&#x7AEF;&#x521B;&#x5EFA;&#x8BA4;&#x8BC1;&#x6587;&#x4EF6;</p>
<pre class="language-"><code>cat &lt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>EOF</span> <span class="token punctuation">&gt;</span></span> /etc/ceph/cephfs.key
AQCHWlRg46I6EBAAg+xBZnFsqOYIGluPd5h1QA==
EOF
</code></pre><blockquote>
<p>&#x6302;&#x8F7D;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</p>
</blockquote>
<pre class="language-"><code>mount -t ceph 192.168.1.69:6789,192.168.1.70:6789,192.168.1.71:6789:/ /cephfs -o name=cephfs,secretfile=/etc/ceph/cephfs.key
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;&#x6D4B;&#x8BD5;&#x6587;&#x4EF6;</p>
</blockquote>
<pre class="language-"><code>touch /cephfs/123
</code></pre><blockquote>
<p>&#x914D;&#x7F6E;&#x5F00;&#x673A;&#x6302;&#x8F7D;</p>
</blockquote>
<pre class="language-"><code>cat &lt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>EOF</span> <span class="token punctuation">&gt;</span></span>&gt; /etc/fstab
192.168.1.69:6789,192.168.1.70:6789,192.168.1.71:6789:/     /cephfs    ceph    name=cephfs,secretfile=/etc/ceph/cephfs.key,noatime,_netdev    0       2
EOF
</code></pre><blockquote>
<p>&#x91CD;&#x542F;&#x4E3B;&#x673A;&#x9A8C;&#x8BC1;</p>
</blockquote>
<pre class="language-"><code>reboot
</code></pre><h3 id="&#x9002;&#x7528;&#x573A;&#x666F;_1"><a name="&#x9002;&#x7528;&#x573A;&#x666F;_1" class="anchor-navigation-ex-anchor" href="#&#x9002;&#x7528;&#x573A;&#x666F;_1"><i class="fa fa-link" aria-hidden="true"></i></a>&#x9002;&#x7528;&#x573A;&#x666F;</h3>
<ul>
<li>&#x6587;&#x4EF6;&#x5171;&#x4EAB;</li>
<li>&#x7F51;&#x7AD9;&#x6587;&#x4EF6;&#x3001;&#x4EE3;&#x7801;&#x5B58;&#x50A8;</li>
<li>&#x6570;&#x636E;&#x5907;&#x4EFD;</li>
<li>&#x65E5;&#x5FD7;&#x5B58;&#x50A8;</li>
<li>&#x6570;&#x636E;&#x5206;&#x6790;</li>
</ul>
<h1 id="k8s&#x5BF9;&#x63A5;ceph"><a name="k8s&#x5BF9;&#x63A5;ceph" class="anchor-navigation-ex-anchor" href="#k8s&#x5BF9;&#x63A5;ceph"><i class="fa fa-link" aria-hidden="true"></i></a>k8s&#x5BF9;&#x63A5;ceph</h1>
<h2 id="k8s-csi"><a name="k8s-csi" class="anchor-navigation-ex-anchor" href="#k8s-csi"><i class="fa fa-link" aria-hidden="true"></i></a>k8s-csi</h2>
<h3 id="csi&#x7B80;&#x4ECB;"><a name="csi&#x7B80;&#x4ECB;" class="anchor-navigation-ex-anchor" href="#csi&#x7B80;&#x4ECB;"><i class="fa fa-link" aria-hidden="true"></i></a>csi&#x7B80;&#x4ECB;</h3>
<p><code>Kubernetes</code>&#x4ECE;<code>1.9</code>&#x7248;&#x672C;&#x5F00;&#x59CB;&#x5F15;&#x5165;&#x5BB9;&#x5668;&#x5B58;&#x50A8;&#x63A5;&#x53E3;<code>Container Storage Interface</code>&#xFF08;CSI&#xFF09;&#x673A;&#x5236;&#xFF0C;&#x7528;&#x4E8E;&#x5728;<code>Kubernetes</code>&#x548C;&#x5916;&#x90E8;&#x5B58;&#x50A8;&#x7CFB;&#x7EDF;&#x4E4B;&#x95F4;&#x5EFA;&#x7ACB;&#x4E00;&#x5957;&#x6807;&#x51C6;&#x7684;&#x5B58;&#x50A8;&#x7BA1;&#x7406;&#x63A5;&#x53E3;&#xFF0C;&#x901A;&#x8FC7;&#x8BE5;&#x63A5;&#x53E3;&#x4E3A;&#x5BB9;&#x5668;&#x63D0;&#x4F9B;&#x5B58;&#x50A8;&#x670D;&#x52A1;&#x3002;</p>
<h3 id="csi&#x8BBE;&#x8BA1;&#x80CC;&#x666F;"><a name="csi&#x8BBE;&#x8BA1;&#x80CC;&#x666F;" class="anchor-navigation-ex-anchor" href="#csi&#x8BBE;&#x8BA1;&#x80CC;&#x666F;"><i class="fa fa-link" aria-hidden="true"></i></a>csi&#x8BBE;&#x8BA1;&#x80CC;&#x666F;</h3>
<p><code>Kubernetes</code>&#x901A;&#x8FC7;<code>PV</code>&#x3001;<code>PVC</code>&#x3001;<code>Storageclass</code>&#x5DF2;&#x7ECF;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&#x5F3A;&#x5927;&#x7684;&#x57FA;&#x4E8E;&#x63D2;&#x4EF6;&#x7684;&#x5B58;&#x50A8;&#x7BA1;&#x7406;&#x673A;&#x5236;&#xFF0C;
&#x4F46;&#x662F;&#x5404;&#x79CD;&#x5B58;&#x50A8;&#x63D2;&#x4EF6;&#x63D0;&#x4F9B;&#x7684;&#x5B58;&#x50A8;&#x670D;&#x52A1;&#x90FD;&#x662F;&#x57FA;&#x4E8E;&#x4E00;&#x79CD;&#x88AB;&#x79F0;&#x4E3A;<code>in-true</code>&#xFF08;&#x6811;&#x5185;&#xFF09;&#x7684;&#x65B9;&#x5F0F;&#x63D0;&#x4F9B;&#x7684;&#xFF0C;
&#x8FD9;&#x8981;&#x6C42;&#x5B58;&#x50A8;&#x63D2;&#x4EF6;&#x7684;&#x4EE3;&#x7801;&#x5FC5;&#x987B;&#x88AB;&#x653E;&#x8FDB;<code>Kubernetes</code>&#x7684;&#x4E3B;&#x5E72;&#x4EE3;&#x7801;&#x5E93;&#x4E2D;&#x624D;&#x80FD;&#x88AB;<code>Kubernetes</code>&#x8C03;&#x7528;&#xFF0C;
&#x5C5E;&#x4E8E;&#x7D27;&#x8026;&#x5408;&#x7684;&#x5F00;&#x53D1;&#x6A21;&#x5F0F;&#x3002;&#x8FD9;&#x79CD;<code>in-tree</code>&#x65B9;&#x5F0F;&#x4F1A;&#x5E26;&#x6765;&#x4E00;&#x4E9B;&#x95EE;&#x9898;&#xFF1A;</p>
<ul>
<li>&#x5B58;&#x50A8;&#x63D2;&#x4EF6;&#x7684;&#x4EE3;&#x7801;&#x9700;&#x8981;&#x4E0E;<code>Kubernetes</code>&#x7684;&#x4EE3;&#x7801;&#x653E;&#x5728;&#x540C;&#x4E00;&#x4EE3;&#x7801;&#x5E93;&#x4E2D;&#xFF0C;&#x5E76;&#x4E0E;<code>Kubernetes</code>&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x6587;&#x4EF6;&#x5171;&#x540C;&#x53D1;&#x5E03;</li>
<li>&#x5B58;&#x50A8;&#x63D2;&#x4EF6;&#x4EE3;&#x7801;&#x7684;&#x5F00;&#x53D1;&#x8005;&#x5FC5;&#x987B;&#x9075;&#x5FAA;<code>Kubernetes</code>&#x7684;&#x4EE3;&#x7801;&#x5F00;&#x53D1;&#x89C4;&#x8303;</li>
<li>&#x5B58;&#x50A8;&#x63D2;&#x4EF6;&#x4EE3;&#x7801;&#x7684;&#x5F00;&#x53D1;&#x8005;&#x5FC5;&#x987B;&#x9075;&#x5FAA;<code>Kubernetes</code>&#x7684;&#x53D1;&#x5E03;&#x6D41;&#x7A0B;&#xFF0C;&#x5305;&#x62EC;&#x6DFB;&#x52A0;&#x5BF9;<code>Kubernetes</code>&#x5B58;&#x50A8;&#x7CFB;&#x7EDF;&#x7684;&#x652F;&#x6301;&#x548C;&#x9519;&#x8BEF;&#x4FEE;&#x590D;</li>
<li><code>Kubernetes</code>&#x793E;&#x533A;&#x9700;&#x8981;&#x5BF9;&#x5B58;&#x50A8;&#x63D2;&#x4EF6;&#x7684;&#x4EE3;&#x7801;&#x8FDB;&#x884C;&#x7EF4;&#x62A4;&#xFF0C;&#x5305;&#x62EC;&#x5BA1;&#x6838;&#x3001;&#x6D4B;&#x8BD5;&#x7B49;&#x5DE5;&#x4F5C;</li>
<li>&#x5B58;&#x50A8;&#x63D2;&#x4EF6;&#x4EE3;&#x7801;&#x4E2D;&#x7684;&#x95EE;&#x9898;&#x53EF;&#x80FD;&#x4F1A;&#x5F71;&#x54CD;<code>Kubernetes</code>&#x7EC4;&#x4EF6;&#x7684;&#x8FD0;&#x884C;&#xFF0C;&#x5E76;&#x4E14;&#x5F88;&#x96BE;&#x6392;&#x67E5;&#x95EE;&#x9898;</li>
<li>&#x5B58;&#x50A8;&#x63D2;&#x4EF6;&#x4EE3;&#x7801;&#x4E0E;<code>Kubernetes</code>&#x7684;&#x6838;&#x5FC3;&#x7EC4;&#x4EF6;&#xFF08;kubelet&#x548C;kubecontroller-manager&#xFF09;&#x4EAB;&#x6709;&#x76F8;&#x540C;&#x7684;&#x7CFB;&#x7EDF;&#x7279;&#x6743;&#x6743;&#x9650;&#xFF0C;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x53EF;&#x9760;&#x6027;&#x548C;&#x5B89;&#x5168;&#x6027;&#x95EE;&#x9898;&#x3002;</li>
<li>&#x90E8;&#x7F72;&#x7B2C;&#x4E09;&#x65B9;&#x9A71;&#x52A8;&#x7684;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4ECD;&#x7136;&#x9700;&#x8981;&#x5BBF;&#x4E3B;&#x673A;&#x7684;<code>root</code>&#x6743;&#x9650;&#xFF0C;&#x5B58;&#x5728;&#x5B89;&#x5168;&#x9690;&#x60A3;</li>
<li>&#x5B58;&#x50A8;&#x63D2;&#x4EF6;&#x5728;&#x6267;&#x884C;<code>mount</code>&#x3001;<code>attach</code>&#x8FD9;&#x4E9B;&#x64CD;&#x4F5C;&#x65F6;&#xFF0C;&#x901A;&#x5E38;&#x9700;&#x8981;&#x5728;&#x5BBF;&#x4E3B;&#x673A;&#x4E0A;&#x5B89;&#x88C5;&#x4E00;&#x4E9B;&#x7B2C;&#x4E09;&#x65B9;&#x5DE5;&#x5177;&#x5305;&#x548C;&#x4F9D;&#x8D56;&#x5E93;&#xFF0C;
&#x4F7F;&#x5F97;&#x90E8;&#x7F72;&#x8FC7;&#x7A0B;&#x66F4;&#x52A0;&#x590D;&#x6742;&#xFF0C;&#x4F8B;&#x5982;&#x90E8;&#x7F72;<code>Ceph</code>&#x65F6;&#x9700;&#x8981;&#x5B89;&#x88C5;<code>rbd</code>&#x5E93;&#xFF0C;&#x90E8;&#x7F72;<code>GlusterFS</code>&#x65F6;&#x9700;&#x8981;&#x5B89;&#x88C5;<code>mount.glusterfs</code>&#x5E93;&#xFF0C;&#x7B49;&#x7B49;</li>
</ul>
<p>&#x57FA;&#x4E8E;&#x4EE5;&#x4E0A;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#x548C;&#x8003;&#x8651;&#xFF0C;<code>Kubernetes</code>&#x9010;&#x6B65;&#x63A8;&#x51FA;&#x4E0E;&#x5BB9;&#x5668;&#x5BF9;&#x63A5;&#x7684;&#x5B58;&#x50A8;&#x63A5;&#x53E3;&#x6807;&#x51C6;&#xFF0C;&#x5B58;&#x50A8;&#x63D0;&#x4F9B;&#x65B9;&#x53EA;&#x9700;&#x8981;&#x57FA;&#x4E8E;&#x6807;&#x51C6;&#x63A5;&#x53E3;&#x8FDB;&#x884C;&#x5B58;&#x50A8;&#x63D2;&#x4EF6;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x5C31;&#x80FD;&#x4F7F;&#x7528;<code>Kubernetes</code>&#x7684;&#x539F;&#x751F;&#x5B58;&#x50A8;&#x673A;&#x5236;&#x4E3A;&#x5BB9;&#x5668;&#x63D0;&#x4F9B;&#x5B58;&#x50A8;&#x670D;&#x52A1;&#x3002;&#x8FD9;&#x5957;&#x6807;&#x51C6;&#x88AB;&#x79F0;&#x4E3A;<code>CSI</code>&#xFF08;&#x5BB9;&#x5668;&#x5B58;&#x50A8;&#x63A5;&#x53E3;&#xFF09;&#x3002;</p>
<p>&#x5728;<code>CSI</code>&#x6210;&#x4E3A;<code>Kubernetes</code>&#x7684;&#x5B58;&#x50A8;&#x4F9B;&#x5E94;&#x6807;&#x51C6;&#x4E4B;&#x540E;&#xFF0C;&#x5B58;&#x50A8;&#x63D0;&#x4F9B;&#x65B9;&#x7684;&#x4EE3;&#x7801;&#x5C31;&#x80FD;&#x548C;<code>Kubernetes</code>&#x4EE3;&#x7801;&#x5F7B;&#x5E95;&#x89E3;&#x8026;&#xFF0C;&#x90E8;&#x7F72;&#x4E5F;&#x4E0E;<code>Kubernetes</code>&#x6838;&#x5FC3;&#x7EC4;&#x4EF6;&#x5206;&#x79BB;&#xFF0C;&#x663E;&#x7136;&#xFF0C;&#x5B58;&#x50A8;&#x63D2;&#x4EF6;&#x7684;&#x5F00;&#x53D1;&#x7531;&#x63D0;&#x4F9B;&#x65B9;&#x81EA;&#x884C;&#x7EF4;&#x62A4;&#xFF0C;&#x5C31;&#x80FD;&#x4E3A;<code>Kubernetes</code>&#x7528;&#x6237;&#x63D0;&#x4F9B;&#x66F4;&#x591A;&#x7684;&#x5B58;&#x50A8;&#x529F;&#x80FD;&#xFF0C;&#x4E5F;&#x66F4;&#x52A0;&#x5B89;&#x5168;&#x53EF;&#x9760;&#x3002;</p>
<p>&#x57FA;&#x4E8E;<code>CSI</code>&#x7684;&#x5B58;&#x50A8;&#x63D2;&#x4EF6;&#x673A;&#x5236;&#x4E5F;&#x88AB;&#x79F0;&#x4E3A;<code>out-of-tree</code>&#xFF08;&#x6811;&#x5916;&#xFF09;&#x7684;&#x670D;&#x52A1;&#x63D0;&#x4F9B;&#x65B9;&#x5F0F;&#xFF0C;&#x662F;&#x672A;&#x6765;<code>Kubernetes</code>&#x7B2C;&#x4E09;&#x65B9;&#x5B58;&#x50A8;&#x63D2;&#x4EF6;&#x7684;&#x6807;&#x51C6;&#x65B9;&#x6848;&#x3002;</p>
<h3 id="csi&#x67B6;&#x6784;"><a name="csi&#x67B6;&#x6784;" class="anchor-navigation-ex-anchor" href="#csi&#x67B6;&#x6784;"><i class="fa fa-link" aria-hidden="true"></i></a>csi&#x67B6;&#x6784;</h3>
<p><code>KubernetesCSI</code>&#x5B58;&#x50A8;&#x63D2;&#x4EF6;&#x7684;&#x5173;&#x952E;&#x7EC4;&#x4EF6;&#x548C;&#x63A8;&#x8350;&#x7684;&#x5BB9;&#x5668;&#x5316;&#x90E8;&#x7F72;&#x67B6;&#x6784;&#xFF1A;</p>
<p><img src="images/csi-artitechture.png" alt=""></p>
<h4 id="csi-controller"><a name="csi-controller" class="anchor-navigation-ex-anchor" href="#csi-controller"><i class="fa fa-link" aria-hidden="true"></i></a>CSI Controller</h4>
<p><code>CSI Controller</code>&#x7684;&#x4E3B;&#x8981;&#x529F;&#x80FD;&#x662F;&#x63D0;&#x4F9B;&#x5B58;&#x50A8;&#x670D;&#x52A1;&#x89C6;&#x89D2;&#x5BF9;&#x5B58;&#x50A8;&#x8D44;&#x6E90;&#x548C;&#x5B58;&#x50A8;&#x5377;&#x8FDB;&#x884C;&#x7BA1;&#x7406;&#x548C;&#x64CD;&#x4F5C;&#x3002;
&#x5728;<code>Kubernetes</code>&#x4E2D;&#x5EFA;&#x8BAE;&#x5C06;&#x5176;&#x90E8;&#x7F72;&#x4E3A;&#x5355;&#x5B9E;&#x4F8B;<code>Pod</code>&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>StatefulSet</code>&#x6216;<code>Deployment</code>&#x63A7;&#x5236;&#x5668;&#x8FDB;&#x884C;&#x90E8;&#x7F72;&#xFF0C;&#x8BBE;&#x7F6E;&#x526F;&#x672C;&#x6570;&#x91CF;&#x4E3A;1&#xFF0C;&#x4FDD;&#x8BC1;&#x4E3A;&#x4E00;&#x79CD;&#x5B58;&#x50A8;&#x63D2;&#x4EF6;&#x53EA;&#x8FD0;&#x884C;&#x4E00;&#x4E2A;&#x63A7;&#x5236;&#x5668;&#x5B9E;&#x4F8B;&#x3002;
&#x5728;&#x8FD9;&#x4E2A;<code>Pod</code>&#x5185;&#x90E8;&#x7F72;&#x4E24;&#x4E2A;&#x5BB9;&#x5668;&#xFF1A;</p>
<ul>
<li>&#x4E0E;<code>Master</code>&#xFF08;kube-controller-manager&#xFF09;&#x901A;&#x4FE1;&#x7684;&#x8F85;&#x52A9;<code>sidecar</code>&#x5BB9;&#x5668;&#x3002;&#x5728;<code>sidecar</code>&#x5BB9;&#x5668;&#x5185;&#x53C8;&#x53EF;&#x4EE5;&#x5305;&#x542B;<code>external-attacher</code>&#x548C;<code>external-provisioner</code>&#x4E24;&#x4E2A;&#x5BB9;&#x5668;&#xFF0C;&#x5B83;&#x4EEC;&#x7684;&#x529F;&#x80FD;&#x5206;&#x522B;&#x5982;&#x4E0B;:<ul>
<li><code>external-attacher</code>&#xFF1A;&#x76D1;&#x63A7;<code>VolumeAttachment</code>&#x8D44;&#x6E90;&#x5BF9;&#x8C61;&#x7684;&#x53D8;&#x66F4;&#xFF0C;&#x89E6;&#x53D1;&#x9488;&#x5BF9;<code>CSI</code>&#x7AEF;&#x70B9;&#x7684;<code>ControllerPublish</code>&#x548C;<code>ControllerUnpublish</code>&#x64CD;&#x4F5C;&#x3002;</li>
<li><code>external-provisioner</code>&#xFF1A;&#x76D1;&#x63A7;<code>PersistentVolumeClaim</code>&#x8D44;&#x6E90;&#x5BF9;&#x8C61;&#x7684;&#x53D8;&#x66F4;&#xFF0C;&#x89E6;&#x53D1;&#x9488;&#x5BF9;<code>CSI</code>&#x7AEF;&#x70B9;&#x7684;<code>CreateVolume</code>&#x548C;<code>DeleteVolume</code>&#x64CD;&#x4F5C;&#x3002;</li>
</ul>
</li>
<li><code>CSI Driver</code>&#x5B58;&#x50A8;&#x9A71;&#x52A8;&#x5BB9;&#x5668;&#xFF0C;&#x7531;&#x7B2C;&#x4E09;&#x65B9;&#x5B58;&#x50A8;&#x63D0;&#x4F9B;&#x5546;&#x63D0;&#x4F9B;&#xFF0C;&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x4E0A;&#x8FF0;&#x63A5;&#x53E3;&#x3002;</li>
</ul>
<p>&#x8FD9;&#x4E24;&#x4E2A;&#x5BB9;&#x5668;&#x901A;&#x8FC7;&#x672C;&#x5730;<code>Socket</code>&#xFF08;Unix DomainSocket&#xFF0C;UDS&#xFF09;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;<code>gPRC</code>&#x534F;&#x8BAE;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x3002;
<code>sidecar</code>&#x5BB9;&#x5668;&#x901A;&#x8FC7;<code>Socket</code>&#x8C03;&#x7528;<code>CSI Driver</code>&#x5BB9;&#x5668;&#x7684;<code>CSI</code>&#x63A5;&#x53E3;&#xFF0C;<code>CSI Driver</code>&#x5BB9;&#x5668;&#x8D1F;&#x8D23;&#x5177;&#x4F53;&#x7684;&#x5B58;&#x50A8;&#x5377;&#x64CD;&#x4F5C;&#x3002;</p>
<h4 id="csi-node"><a name="csi-node" class="anchor-navigation-ex-anchor" href="#csi-node"><i class="fa fa-link" aria-hidden="true"></i></a>CSI Node</h4>
<p><code>CSI Node</code>&#x7684;&#x4E3B;&#x8981;&#x529F;&#x80FD;&#x662F;&#x5BF9;&#x4E3B;&#x673A;&#xFF08;Node&#xFF09;&#x4E0A;&#x7684;<code>Volume</code>&#x8FDB;&#x884C;&#x7BA1;&#x7406;&#x548C;&#x64CD;&#x4F5C;&#x3002;&#x5728;<code>Kubernetes</code>&#x4E2D;&#x5EFA;&#x8BAE;&#x5C06;&#x5176;&#x90E8;&#x7F72;&#x4E3A;<code>DaemonSet</code>&#xFF0C;&#x5728;&#x6BCF;&#x4E2A;<code>Node</code>&#x4E0A;&#x90FD;&#x8FD0;&#x884C;&#x4E00;&#x4E2A;<code>Pod</code>&#x3002;
&#x5728;&#x8FD9;&#x4E2A;<code>Pod</code>&#x4E2D;&#x90E8;&#x7F72;&#x4EE5;&#x4E0B;&#x4E24;&#x4E2A;&#x5BB9;&#x5668;&#xFF1A;</p>
<ul>
<li>&#x4E0E;<code>kubelet</code>&#x901A;&#x4FE1;&#x7684;&#x8F85;&#x52A9;<code>sidecar</code>&#x5BB9;&#x5668;<code>node-driver-registrar</code>&#xFF0C;&#x4E3B;&#x8981;&#x529F;&#x80FD;&#x662F;&#x5C06;&#x5B58;&#x50A8;&#x9A71;&#x52A8;&#x6CE8;&#x518C;&#x5230;<code>kubelet</code>&#x4E2D;</li>
<li><code>CSI Driver</code>&#x5B58;&#x50A8;&#x9A71;&#x52A8;&#x5BB9;&#x5668;&#xFF0C;&#x7531;&#x7B2C;&#x4E09;&#x65B9;&#x5B58;&#x50A8;&#x63D0;&#x4F9B;&#x5546;&#x63D0;&#x4F9B;&#xFF0C;&#x4E3B;&#x8981;&#x529F;&#x80FD;&#x662F;&#x63A5;&#x6536;<code>kubelet</code>&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x4E00;&#x7CFB;&#x5217;&#x4E0E;<code>Node</code>&#x76F8;&#x5173;&#x7684;<code>CSI</code>&#x63A5;&#x53E3;&#xFF0C;&#x4F8B;&#x5982;<code>NodePublishVolume</code>&#x63A5;&#x53E3;&#xFF08;&#x7528;&#x4E8E;&#x5C06;Volume&#x6302;&#x8F7D;&#x5230;&#x5BB9;&#x5668;&#x5185;&#x7684;&#x76EE;&#x6807;&#x8DEF;&#x5F84;&#xFF09;&#x3001;<code>NodeUnpublishVolume</code>&#x63A5;&#x53E3;&#xFF08;&#x7528;&#x4E8E;&#x4ECE;&#x5BB9;&#x5668;&#x4E2D;&#x5378;&#x8F7D;Volume&#xFF09;&#xFF0C;&#x7B49;&#x7B49;&#x3002;</li>
</ul>
<p><code>node-driver-registrar</code>&#x5BB9;&#x5668;&#x4E0E;<code>kubelet</code>&#x901A;&#x8FC7;<code>Node</code>&#x4E3B;&#x673A;&#x7684;&#x4E00;&#x4E2A;<code>hostPath</code>&#x76EE;&#x5F55;&#x4E0B;&#x7684;<code>unixsocket</code>&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x3002;<code>CSI Driver</code>&#x5BB9;&#x5668;&#x4E0E;<code>kubelet</code>&#x901A;&#x8FC7;<code>Node</code>&#x4E3B;&#x673A;&#x7684;&#x53E6;&#x4E00;&#x4E2A;<code>hostPath</code>&#x76EE;&#x5F55;&#x4E0B;&#x7684;<code>unixsocket</code>&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#xFF0C;&#x540C;&#x65F6;&#x9700;&#x8981;&#x5C06;<code>kubelet</code>&#x7684;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#xFF08;&#x9ED8;&#x8BA4;&#x4E3A;/var/lib/kubelet&#xFF09;&#x6302;&#x8F7D;&#x7ED9;<code>CSIDriver</code>&#x5BB9;&#x5668;&#xFF0C;&#x7528;&#x4E8E;&#x4E3A;<code>Pod</code>&#x8FDB;&#x884C;<code>Volume</code>&#x7684;&#x7BA1;&#x7406;&#x64CD;&#x4F5C;&#xFF08;&#x5305;&#x62EC;mount&#x3001;umount&#x7B49;&#xFF09;&#x3002;</p>
<h2 id="k8s&#x63A5;&#x5165;ceph&#x5757;&#x5B58;&#x50A8;"><a name="k8s&#x63A5;&#x5165;ceph&#x5757;&#x5B58;&#x50A8;" class="anchor-navigation-ex-anchor" href="#k8s&#x63A5;&#x5165;ceph&#x5757;&#x5B58;&#x50A8;"><i class="fa fa-link" aria-hidden="true"></i></a>k8s&#x63A5;&#x5165;ceph&#x5757;&#x5B58;&#x50A8;</h2>
<p>&#x4F7F;&#x7528;<a href="https://github.com/ceph/ceph-csi" target="_blank">ceph-csi</a> &#x5B9E;&#x73B0;</p>
<h3 id="ceph&#x670D;&#x52A1;&#x7AEF;"><a name="ceph&#x670D;&#x52A1;&#x7AEF;" class="anchor-navigation-ex-anchor" href="#ceph&#x670D;&#x52A1;&#x7AEF;"><i class="fa fa-link" aria-hidden="true"></i></a>ceph&#x670D;&#x52A1;&#x7AEF;</h3>
<blockquote>
<p>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6C60;&#xFF0C;&#x7528;&#x4EE5;&#x4E3A;<code>k8s</code>&#x63D0;&#x4F9B;&#x5757;&#x5B58;&#x50A8;&#x670D;&#x52A1;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd pool create rbd-k8s-pool 256 256 SSD_rule
pool &apos;rbd-k8s-pool&apos; created
</code></pre><blockquote>
<p>&#x8BBE;&#x7F6E;&#x914D;&#x989D;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd pool set-quota rbd-k8s-pool max_bytes 100G
set-quota max_bytes = 107374182400 for pool rbd-k8s-pool
</code></pre><blockquote>
<p>&#x5173;&#x8054;&#x5E94;&#x7528;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd pool application enable rbd-k8s-pool rbd
enabled application &apos;rbd&apos; on pool &apos;rbd-k8s-pool&apos;
</code></pre><blockquote>
<p>&#x521D;&#x59CB;&#x5316;</p>
</blockquote>
<pre class="language-"><code>rbd pool init rbd-k8s-pool
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;&#x7528;&#x6237;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph auth get-or-create client.kubernetes mon &apos;profile rbd&apos; osd &apos;profile rbd pool=rbd-k8s-pool&apos; mgr &apos;profile rbd pool=rbd-k8s-pool&apos;
[client.kubernetes]
        key = AQCS6kFg0NRDIBAAorr8r5Oxiz1eYH61VvLVYA==     
</code></pre><h3 id="k8s&#x8282;&#x70B9;"><a name="k8s&#x8282;&#x70B9;" class="anchor-navigation-ex-anchor" href="#k8s&#x8282;&#x70B9;"><i class="fa fa-link" aria-hidden="true"></i></a>k8s&#x8282;&#x70B9;</h3>
<blockquote>
<p>&#x4E0B;&#x8F7D;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</p>
</blockquote>
<ul>
<li><a href="https://github.com/ceph/ceph-csi/archive/v3.2.0.zip" target="_blank">ceph-csi-3.2.0.zip</a></li>
</ul>
<blockquote>
<p>&#x4E0A;&#x4F20;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x89E3;&#x538B;</p>
</blockquote>
<pre class="language-"><code>unzip ceph-csi-3.2.0.zip
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#xFF0C;&#x7528;&#x4E8E;&#x7BA1;&#x7406;<code>ceph-csi</code></p>
</blockquote>
<pre class="language-"><code>kubectl create ns ceph-csi
</code></pre><blockquote>
<p>&#x66F4;&#x6539;<code>ceph-csi-3.2.0/deploy/rbd/kubernetes/csi-config-map.yaml</code></p>
</blockquote>
<p>&#x83B7;&#x53D6;&#x96C6;&#x7FA4;&#x4FE1;&#x606F;(<code>ceph</code>&#x7BA1;&#x7406;&#x8282;&#x70B9;&#x6267;&#x884C;)</p>
<pre class="language-"><code>[root@ceph01 ~]# ceph mon dump
dumped monmap epoch 2
epoch 2
fsid b1c2511e-a1a5-4d6d-a4be-0e7f0d6d4294
last_changed 2021-02-22 14:36:08.199609
created 2021-02-22 14:27:26.357269
min_mon_release 14 (nautilus)
0: [v2:192.168.1.69:3300/0,v1:192.168.1.69:6789/0] mon.ceph01
1: [v2:192.168.1.70:3300/0,v1:192.168.1.70:6789/0] mon.ceph02
2: [v2:192.168.1.71:3300/0,v1:192.168.1.71:6789/0] mon.ceph03
</code></pre><ul>
<li><code>b1c2511e-a1a5-4d6d-a4be-0e7f0d6d4294</code>&#x4E3A;&#x96C6;&#x7FA4;<code>ID</code></li>
<li>&#x76D1;&#x63A7;&#x8282;&#x70B9;&#x5730;&#x5740;&#xFF1A;<code>192.168.1.69:6789,192.168.1.70:6789,192.168.1.71:6789</code></li>
</ul>
<p>&#x66F4;&#x6539;&#x540E;<code>csi-config-map.yaml</code>&#x5185;&#x5BB9;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="language-"><code>vim ceph-csi-3.2.0/deploy/rbd/kubernetes/csi-config-map.yaml

---
apiVersion: v1
kind: ConfigMap
data:
  config.json: |-
    [
      {
        &quot;clusterID&quot;: &quot;b1c2511e-a1a5-4d6d-a4be-0e7f0d6d4294&quot;,
        &quot;monitors&quot;: [
          &quot;192.168.1.69:6789&quot;,
          &quot;192.168.1.70:6789&quot;,
          &quot;192.168.1.71:6789&quot;
        ]
      }
    ]
metadata:
  name: ceph-csi-config
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;<code>csi-config-map</code></p>
</blockquote>
<pre class="language-"><code>kubectl -n ceph-csi apply -f ceph-csi-3.2.0/deploy/rbd/kubernetes/csi-config-map.yaml
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;<code>csi-rbd-secret</code></p>
</blockquote>
<p>&#x521B;&#x5EFA;</p>
<pre class="language-"><code>cat &lt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>EOF</span> <span class="token punctuation">&gt;</span></span> ceph-csi-3.2.0/deploy/rbd/kubernetes/csi-rbd-secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: csi-rbd-secret
  namespace: ceph-csi
stringData:
  userID: kubernetes
  userKey: AQCS6kFg0NRDIBAAorr8r5Oxiz1eYH61VvLVYA==
EOF
</code></pre><p><code>AQCS6kFg0NRDIBAAorr8r5Oxiz1eYH61VvLVYA==</code>&#x53EF;&#x901A;&#x8FC7;&#x5728;<code>ceph</code>&#x670D;&#x52A1;&#x7AEF;&#x6267;&#x884C;<code>ceph auth get client.kubernetes</code>&#x83B7;&#x53D6;</p>
<p>&#x53D1;&#x5E03;</p>
<pre class="language-"><code>kubectl apply -f ceph-csi-3.2.0/deploy/rbd/kubernetes/csi-rbd-secret.yaml
</code></pre><blockquote>
<p>&#x914D;&#x7F6E;&#x6E05;&#x5355;&#x4E2D;&#x7684;<code>namespace</code>&#x6539;&#x6210;<code>ceph-csi</code></p>
</blockquote>
<pre class="language-"><code>sed -i &quot;s/namespace: default/namespace: ceph-csi/g&quot; $(grep -rl &quot;namespace: default&quot; ./ceph-csi-3.2.0/deploy/rbd/kubernetes)
sed -i -e &quot;/^kind: ServiceAccount/{N;N;a\  namespace: ceph-csi  # &#x8F93;&#x5165;&#x5230;&#x8FD9;&#x91CC;&#x7684;&#x65F6;&#x5019;&#x9700;&#x8981;&#x6309;&#x4E00;&#x4E0B;&#x56DE;&#x8F66;&#x952E;&#xFF0C;&#x5728;&#x4E0B;&#x4E00;&#x884C;&#x7EE7;&#x7EED;&#x8F93;&#x5165;
}&quot; $(egrep -rl &quot;^kind: ServiceAccount&quot; ./ceph-csi-3.2.0/deploy/rbd/kubernetes)
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;<code>ServiceAccount</code>&#x548C;<code>RBAC ClusterRole/ClusterRoleBinding</code>&#x8D44;&#x6E90;&#x5BF9;&#x8C61;</p>
</blockquote>
<pre class="language-"><code>kubectl create -f ceph-csi-3.2.0/deploy/rbd/kubernetes/csi-provisioner-rbac.yaml
kubectl create -f ceph-csi-3.2.0/deploy/rbd/kubernetes/csi-nodeplugin-rbac.yaml
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;<code>PodSecurityPolicy</code></p>
</blockquote>
<pre class="language-"><code>kubectl create -f ceph-csi-3.2.0/deploy/rbd/kubernetes/csi-provisioner-psp.yaml
kubectl create -f ceph-csi-3.2.0/deploy/rbd/kubernetes/csi-nodeplugin-psp.yaml
</code></pre><blockquote>
<p>&#x8C03;&#x6574;<code>csi-rbdplugin-provisioner.yaml</code>&#x548C;<code>csi-rbdplugin.yaml</code></p>
</blockquote>
<p>&#x5C06;<code>csi-rbdplugin.yaml</code>&#x4E2D;&#x7684;<code>kms</code>&#x90E8;&#x5206;&#x914D;&#x7F6E;&#x6CE8;&#x91CA;&#x6389;</p>
<pre class="language-"><code># vim ceph-csi-3.2.0/deploy/rbd/kubernetes/csi-rbdplugin.yaml
...
- name: ceph-csi-encryption-kms-config
  mountPath: /etc/ceph-csi-encryption-kms-config/
...
...
- name: ceph-csi-encryption-kms-config
  configMap:
    name: ceph-csi-encryption-kms-config
...
</code></pre><p>&#x5C06;<code>csi-rbdplugin-provisioner.yaml</code>&#x4E2D;&#x7684;<code>kms</code>&#x90E8;&#x5206;&#x914D;&#x7F6E;&#x6CE8;&#x91CA;&#x6389;</p>
<pre class="language-"><code># vim ceph-csi-3.2.0/deploy/rbd/kubernetes/csi-rbdplugin-provisioner.yaml
...
- name: ceph-csi-encryption-kms-config
  mountPath: /etc/ceph-csi-encryption-kms-config/
...
...
- name: ceph-csi-encryption-kms-config
  configMap:
    name: ceph-csi-encryption-kms-config
...
</code></pre><p>&#x5C06;<code>csi-rbdplugin.yaml</code>&#x4E2D;&#x7684;<code>image</code>&#x90E8;&#x5206;&#x8C03;&#x6574;&#x4E3A;&#x53EF;&#x8BBF;&#x95EE;&#x955C;&#x50CF;&#x5730;&#x5740;</p>
<pre class="language-"><code>k8s.gcr.io/sig-storage/csi-node-driver-registrar:v2.0.1
quay.io/cephcsi/cephcsi:v3.2.0
</code></pre><p>&#x5C06;<code>csi-rbdplugin-provisioner.yaml</code>&#x4E2D;&#x7684;<code>image</code>&#x90E8;&#x5206;&#x8C03;&#x6574;&#x4E3A;&#x53EF;&#x8BBF;&#x95EE;&#x955C;&#x50CF;&#x5730;&#x5740;</p>
<pre class="language-"><code>quay.io/cephcsi/cephcsi:v3.2.0
k8s.gcr.io/sig-storage/csi-provisioner:v2.0.4
k8s.gcr.io/sig-storage/csi-snapshotter:v3.0.2
k8s.gcr.io/sig-storage/csi-attacher:v3.0.2
k8s.gcr.io/sig-storage/csi-resizer:v1.0.1
</code></pre><p>&#x53D1;&#x5E03;<code>csi-rbdplugin-provisioner.yaml</code>&#x548C;<code>csi-rbdplugin.yaml</code></p>
<pre class="language-"><code>kubectl -n ceph-csi create -f ceph-csi-3.2.0/deploy/rbd/kubernetes/csi-rbdplugin-provisioner.yaml
kubectl -n ceph-csi create -f ceph-csi-3.2.0/deploy/rbd/kubernetes/csi-rbdplugin.yaml
</code></pre><p>&#x67E5;&#x770B;&#x8FD0;&#x884C;&#x72B6;&#x6001;</p>
<pre class="language-"><code>[root@ceph01 ~]# kubectl get pod -n ceph-csi
NAME                                         READY   STATUS    RESTARTS   AGE
csi-rbdplugin-ddc42                          3/3     Running   0          76s
csi-rbdplugin-fwwfv                          3/3     Running   0          76s
csi-rbdplugin-provisioner-76959bd74d-gwd9k   7/7     Running   0          5h32m
csi-rbdplugin-provisioner-76959bd74d-nb574   7/7     Running   0          5h32m
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;<code>StorageClass</code></p>
</blockquote>
<p><code>b1c2511e-a1a5-4d6d-a4be-0e7f0d6d4294</code>&#x4E3A;<code>ceph</code>&#x96C6;&#x7FA4;<code>ID</code>&#x6CE8;&#x610F;&#x66FF;&#x6362;</p>
<p>&#x751F;&#x6210;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</p>
<pre class="language-"><code>cat &lt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>EOF</span> <span class="token punctuation">&gt;</span></span> ceph-csi-3.2.0/deploy/rbd/kubernetes/storageclass.yaml
---
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: ceph-csi-rbd-sc
provisioner: rbd.csi.ceph.com
parameters:
  clusterID: b1c2511e-a1a5-4d6d-a4be-0e7f0d6d4294
  pool: rbd-k8s-pool
  imageFeatures: layering
  csi.storage.k8s.io/provisioner-secret-name: csi-rbd-secret
  csi.storage.k8s.io/provisioner-secret-namespace: ceph-csi
  csi.storage.k8s.io/controller-expand-secret-name: csi-rbd-secret
  csi.storage.k8s.io/controller-expand-secret-namespace: ceph-csi
  csi.storage.k8s.io/node-stage-secret-name: csi-rbd-secret
  csi.storage.k8s.io/node-stage-secret-namespace: ceph-csi
  csi.storage.k8s.io/fstype: ext4
reclaimPolicy: Delete
allowVolumeExpansion: true
mountOptions:
  - discard
EOF
</code></pre><p>&#x521B;&#x5EFA;</p>
<pre class="language-"><code>kubectl apply -f ceph-csi-3.2.0/deploy/rbd/kubernetes/storageclass.yaml
</code></pre><p>&#x914D;&#x7F6E;&#x4E3A;&#x9ED8;&#x8BA4;<code>storage class</code></p>
<pre class="language-"><code>kubectl patch storageclass ceph-csi-rbd-sc -p &apos;{&quot;metadata&quot;: {&quot;annotations&quot;:{&quot;storageclass.kubernetes.io/is-default-class&quot;:&quot;true&quot;}}}&apos;
</code></pre><p>&#x67E5;&#x770B;<code>storage class</code></p>
<pre class="language-"><code>[root@ceph01 ~]# kubectl get sc
NAME                        PROVISIONER        RECLAIMPOLICY   VOLUMEBINDINGMODE      ALLOWVOLUMEEXPANSION   AGE
ceph-csi-rbd-sc (default)   rbd.csi.ceph.com   Delete          Immediate              true                   117s
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;<code>pvc</code>&#x9A8C;&#x8BC1;&#x53EF;&#x7528;&#x6027;</p>
</blockquote>
<p>&#x751F;&#x6210;&#x914D;&#x7F6E;</p>
<pre class="language-"><code>cat &lt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>EOF</span> <span class="token punctuation">&gt;</span></span> ceph-csi-3.2.0/deploy/rbd/kubernetes/pvc-demo.yaml 
---
kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: ceph-pvc-demo
  namespace: default
spec:
  storageClassName: ceph-csi-rbd-sc
  accessModes:
  - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
EOF
</code></pre><p>&#x521B;&#x5EFA;</p>
<pre class="language-"><code>kubectl apply -f ceph-csi-3.2.0/deploy/rbd/kubernetes/pvc-demo.yaml
</code></pre><p>&#x67E5;&#x770B;</p>
<pre class="language-"><code>[root@ceph01 ~]# kubectl get pvc
NAME            STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS      AGE
ceph-pvc-demo   Bound    pvc-7b7d4d8a-c4f4-40b6-9372-661ece7c385e   1Gi        RWO            ceph-csi-rbd-sc   13s
</code></pre><blockquote>
<p><code>pvc</code>&#x6269;&#x5BB9;</p>
</blockquote>
<p>&#x751F;&#x6210;&#x914D;&#x7F6E;</p>
<pre class="language-"><code>cat &lt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>EOF</span> <span class="token punctuation">&gt;</span></span> ceph-csi-3.2.0/deploy/rbd/kubernetes/nginx-demo.yaml 
apiVersion: v1
kind: Pod
metadata:
  name: testpv
  labels:
    role: web-frontend
spec:
  containers:
  - name: web
    image: nginx
    ports:
      - name: web
        containerPort: 80
    volumeMounts:
      - name: ceph-pvc-demo
        mountPath: &quot;/usr/share/nginx/html&quot;
  volumes:
  - name: ceph-pvc-demo
    persistentVolumeClaim:
      claimName: ceph-pvc-demo
EOF
</code></pre><p>&#x53D1;&#x5E03;</p>
<pre class="language-"><code>kubectl apply -f ceph-csi-3.2.0/deploy/rbd/kubernetes/nginx-demo.yaml
</code></pre><p>&#x67E5;&#x770B;<code>pvc</code></p>
<pre class="language-"><code>[root@ceph01 ~]# kubectl get pvc
NAME            STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS      AGE
ceph-pvc-demo   Bound    pvc-360f8c5b-0f82-4f17-957b-a7eb5cf93f7e   1Gi        RWO            ceph-csi-rbd-sc   2m50s
</code></pre><p>&#x7F16;&#x8F91;&#x4FEE;&#x6539;<code>pvc</code></p>
<pre class="language-"><code>kubectl edit pvc ceph-pvc-demo
</code></pre><p>&#x4FEE;&#x6539;&#x4EE5;&#x4E0B;&#x5185;&#x5BB9;&#xFF0C;<code>storage: 1Gi</code>&#x8C03;&#x6574;&#x4E3A;<code>storage: 10Gi</code></p>
<pre class="language-"><code>...
spec:
  accessModes:
  - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
...
</code></pre><p>&#x91CD;&#x542F;</p>
<pre class="language-"><code>kubectl get pod testpv -o yaml | kubectl replace --force -f -
</code></pre><p>&#x518D;&#x6B21;&#x67E5;&#x770B;<code>pvc</code></p>
<pre class="language-"><code>[root@ceph01 ~]# kubectl get pvc
NAME            STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS      AGE
ceph-pvc-demo   Bound    pvc-360f8c5b-0f82-4f17-957b-a7eb5cf93f7e   10Gi       RWO            ceph-csi-rbd-sc   9m26s
</code></pre><h2 id="k8s&#x63A5;&#x5165;ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;"><a name="k8s&#x63A5;&#x5165;ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;" class="anchor-navigation-ex-anchor" href="#k8s&#x63A5;&#x5165;ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;"><i class="fa fa-link" aria-hidden="true"></i></a>k8s&#x63A5;&#x5165;ceph&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</h2>
<h3 id="ceph&#x670D;&#x52A1;&#x7AEF;_1"><a name="ceph&#x670D;&#x52A1;&#x7AEF;_1" class="anchor-navigation-ex-anchor" href="#ceph&#x670D;&#x52A1;&#x7AEF;_1"><i class="fa fa-link" aria-hidden="true"></i></a>ceph&#x670D;&#x52A1;&#x7AEF;</h3>
<blockquote>
<p>&#x5B89;&#x88C5;<code>mds</code></p>
</blockquote>
<pre class="language-"><code>ceph-deploy mds create ceph01 ceph02 ceph03  
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;<code>cephfs</code>&#x5B58;&#x50A8;&#x6C60;&#x4E0E;&#x5143;&#x6570;&#x636E;&#x6C60;&#xFF0C;&#x7528;&#x4EE5;&#x4E3A;<code>k8s</code>&#x63D0;&#x4F9B;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x670D;&#x52A1;</p>
</blockquote>
<pre class="language-"><code>ceph osd pool create cephfs_data 64
ceph osd pool create cephfs_metadata 64
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</p>
</blockquote>
<pre class="language-"><code>ceph fs new k8s-cephfs cephfs_metadata cephfs_data
</code></pre><blockquote>
<p>&#x5173;&#x8054;&#x5E94;&#x7528;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd pool application enable cephfs_data cephfs
enabled application &apos;cephfs&apos; on pool &apos;cephfs_data&apos;
</code></pre><blockquote>
<p>&#x8BBE;&#x7F6E;&#x914D;&#x989D;</p>
</blockquote>
<pre class="language-"><code>ceph osd pool set-quota cephfs_data max_bytes 100G
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;&#x7528;&#x6237;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 kubernetes]# ceph auth get-or-create client.cephfs mon &apos;allow r&apos; mds &apos;allow r, allow rw path=/&apos; osd &apos;allow rw pool=cephfs_data&apos;
[client.cephfs]
        key = AQCoW0dgQk4qGhAAwayKv70OSyyWB3XpZ1JLYQ==
</code></pre><h3 id="k8s&#x8282;&#x70B9;_1"><a name="k8s&#x8282;&#x70B9;_1" class="anchor-navigation-ex-anchor" href="#k8s&#x8282;&#x70B9;_1"><i class="fa fa-link" aria-hidden="true"></i></a>k8s&#x8282;&#x70B9;</h3>
<blockquote>
<p>&#x4E0B;&#x8F7D;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</p>
</blockquote>
<ul>
<li><a href="https://github.com/ceph/ceph-csi/archive/v3.2.0.zip" target="_blank">ceph-csi-3.2.0.zip</a></li>
</ul>
<blockquote>
<p>&#x4E0A;&#x4F20;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x89E3;&#x538B;</p>
</blockquote>
<pre class="language-"><code>unzip ceph-csi-3.2.0.zip
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#xFF0C;&#x7528;&#x4E8E;&#x7BA1;&#x7406;<code>ceph-csi</code></p>
</blockquote>
<pre class="language-"><code>kubectl create ns ceph-csi
</code></pre><blockquote>
<p>&#x66F4;&#x6539;<code>ceph-csi-3.2.0/deploy/cephfs/kubernetes/csi-config-map.yaml</code></p>
</blockquote>
<p>&#x83B7;&#x53D6;&#x96C6;&#x7FA4;&#x4FE1;&#x606F;(<code>ceph</code>&#x7BA1;&#x7406;&#x8282;&#x70B9;&#x6267;&#x884C;)</p>
<pre class="language-"><code>[root@ceph01 ~]# ceph mon dump
dumped monmap epoch 2
epoch 2
fsid b1c2511e-a1a5-4d6d-a4be-0e7f0d6d4294
last_changed 2021-02-22 14:36:08.199609
created 2021-02-22 14:27:26.357269
min_mon_release 14 (nautilus)
0: [v2:192.168.1.69:3300/0,v1:192.168.1.69:6789/0] mon.ceph01
1: [v2:192.168.1.70:3300/0,v1:192.168.1.70:6789/0] mon.ceph02
2: [v2:192.168.1.71:3300/0,v1:192.168.1.71:6789/0] mon.ceph03
</code></pre><ul>
<li><code>b1c2511e-a1a5-4d6d-a4be-0e7f0d6d4294</code>&#x4E3A;&#x96C6;&#x7FA4;<code>ID</code></li>
<li>&#x76D1;&#x63A7;&#x8282;&#x70B9;&#x5730;&#x5740;&#xFF1A;<code>192.168.1.69:6789,192.168.1.70:6789,192.168.1.71:6789</code></li>
</ul>
<p>&#x66F4;&#x6539;&#x540E;<code>csi-config-map.yaml</code>&#x5185;&#x5BB9;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="language-"><code>vim ceph-csi-3.2.0/deploy/cephfs/kubernetes/csi-config-map.yaml

---
apiVersion: v1
kind: ConfigMap
data:
  config.json: |-
    [
      {
        &quot;clusterID&quot;: &quot;b1c2511e-a1a5-4d6d-a4be-0e7f0d6d4294&quot;,
        &quot;monitors&quot;: [
          &quot;192.168.1.69:6789&quot;,
          &quot;192.168.1.70:6789&quot;,
          &quot;192.168.1.71:6789&quot;
        ]
      }
    ]
metadata:
  name: ceph-csi-config
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;<code>csi-config-map</code></p>
</blockquote>
<pre class="language-"><code>kubectl -n ceph-csi apply -f ceph-csi-3.2.0/deploy/cephfs/kubernetes/csi-config-map.yaml
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;<code>csi-cephfs-secret</code></p>
</blockquote>
<p>&#x521B;&#x5EFA;</p>
<pre class="language-"><code>cat &lt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>EOF</span> <span class="token punctuation">&gt;</span></span> ceph-csi-3.2.0/deploy/cephfs/kubernetes/csi-cephfs-secret.yaml
---
apiVersion: v1
kind: Secret
metadata:
  name: csi-cephfs-secret
  namespace: ceph-csi
stringData:
  # Required for statically provisioned volumes
  userID: cephfs
  userKey: AQCoW0dgQk4qGhAAwayKv70OSyyWB3XpZ1JLYQ==

  # Required for dynamically provisioned volumes
  adminID: admin
  adminKey: AQDkTjNgNObEHBAANGLCF23SLKYmqUd2Nxtbaw==
EOF
</code></pre><p><code>AQCoW0dgQk4qGhAAwayKv70OSyyWB3XpZ1JLYQ====</code>&#x53EF;&#x901A;&#x8FC7;&#x5728;<code>ceph</code>&#x670D;&#x52A1;&#x7AEF;&#x6267;&#x884C;<code>ceph auth get client.cephfs</code>&#x83B7;&#x53D6;</p>
<p>&#x53D1;&#x5E03;</p>
<pre class="language-"><code>kubectl apply -f ceph-csi-3.2.0/deploy/cephfs/kubernetes/csi-cephfs-secret.yaml
</code></pre><blockquote>
<p>&#x914D;&#x7F6E;&#x6E05;&#x5355;&#x4E2D;&#x7684;<code>namespace</code>&#x6539;&#x6210;<code>ceph-csi</code></p>
</blockquote>
<pre class="language-"><code>sed -i &quot;s/namespace: default/namespace: ceph-csi/g&quot; $(grep -rl &quot;namespace: default&quot; ./ceph-csi-3.2.0/deploy/cephfs/kubernetes)
sed -i -e &quot;/^kind: ServiceAccount/{N;N;a\  namespace: ceph-csi  # &#x8F93;&#x5165;&#x5230;&#x8FD9;&#x91CC;&#x7684;&#x65F6;&#x5019;&#x9700;&#x8981;&#x6309;&#x4E00;&#x4E0B;&#x56DE;&#x8F66;&#x952E;&#xFF0C;&#x5728;&#x4E0B;&#x4E00;&#x884C;&#x7EE7;&#x7EED;&#x8F93;&#x5165;
}&quot; $(egrep -rl &quot;^kind: ServiceAccount&quot; ./ceph-csi-3.2.0/deploy/cephfs/kubernetes)
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;<code>ServiceAccount</code>&#x548C;<code>RBAC ClusterRole/ClusterRoleBinding</code>&#x8D44;&#x6E90;&#x5BF9;&#x8C61;</p>
</blockquote>
<pre class="language-"><code>kubectl create -f ceph-csi-3.2.0/deploy/cephfs/kubernetes/csi-provisioner-rbac.yaml
kubectl create -f ceph-csi-3.2.0/deploy/cephfs/kubernetes/csi-nodeplugin-rbac.yaml
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;<code>PodSecurityPolicy</code></p>
</blockquote>
<pre class="language-"><code>kubectl create -f ceph-csi-3.2.0/deploy/cephfs/kubernetes/csi-provisioner-psp.yaml
kubectl create -f ceph-csi-3.2.0/deploy/cephfs/kubernetes/csi-nodeplugin-psp.yaml
</code></pre><blockquote>
<p>&#x8C03;&#x6574;<code>csi-cephfsplugin-provisioner.yaml</code>&#x548C;<code>csi-cephfsplugin.yaml</code></p>
</blockquote>
<p>&#x5C06;<code>csi-cephfsplugin.yaml</code>&#x4E2D;&#x7684;<code>image</code>&#x90E8;&#x5206;&#x8C03;&#x6574;&#x4E3A;&#x53EF;&#x8BBF;&#x95EE;&#x955C;&#x50CF;&#x5730;&#x5740;</p>
<pre class="language-"><code>k8s.gcr.io/sig-storage/csi-node-driver-registrar:v2.0.1
quay.io/cephcsi/cephcsi:v3.2.0
</code></pre><p>&#x5C06;<code>csi-cephfsplugin-provisioner.yaml</code>&#x4E2D;&#x7684;<code>image</code>&#x90E8;&#x5206;&#x8C03;&#x6574;&#x4E3A;&#x53EF;&#x8BBF;&#x95EE;&#x955C;&#x50CF;&#x5730;&#x5740;</p>
<pre class="language-"><code>quay.io/cephcsi/cephcsi:v3.2.0
k8s.gcr.io/sig-storage/csi-provisioner:v2.0.4
k8s.gcr.io/sig-storage/csi-snapshotter:v3.0.2
k8s.gcr.io/sig-storage/csi-attacher:v3.0.2
k8s.gcr.io/sig-storage/csi-resizer:v1.0.1
</code></pre><p>&#x53D1;&#x5E03;<code>csi-cephfsplugin-provisioner.yaml</code>&#x548C;<code>csi-cephfsplugin.yaml</code></p>
<pre class="language-"><code>kubectl -n ceph-csi create -f ceph-csi-3.2.0/deploy/cephfs/kubernetes/csi-cephfsplugin-provisioner.yaml
kubectl -n ceph-csi create -f ceph-csi-3.2.0/deploy/cephfs/kubernetes/csi-cephfsplugin.yaml
</code></pre><p>&#x67E5;&#x770B;&#x8FD0;&#x884C;&#x72B6;&#x6001;</p>
<pre class="language-"><code>kubectl get pod -n ceph-csi
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;<code>StorageClass</code></p>
</blockquote>
<p><code>b1c2511e-a1a5-4d6d-a4be-0e7f0d6d4294</code>&#x4E3A;<code>ceph</code>&#x96C6;&#x7FA4;<code>ID</code>&#x6CE8;&#x610F;&#x66FF;&#x6362;</p>
<p>&#x751F;&#x6210;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</p>
<pre class="language-"><code>cat &lt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>EOF</span> <span class="token punctuation">&gt;</span></span> ceph-csi-3.2.0/deploy/cephfs/kubernetes/storageclass.yaml
---
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: ceph-csi-cephfs-sc
provisioner: cephfs.csi.ceph.com
parameters:
  clusterID: b1c2511e-a1a5-4d6d-a4be-0e7f0d6d4294
  pool: cephfs_data
  fsName: k8s-cephfs
  imageFeatures: layering
  csi.storage.k8s.io/provisioner-secret-name: csi-cephfs-secret
  csi.storage.k8s.io/provisioner-secret-namespace: ceph-csi
  csi.storage.k8s.io/controller-expand-secret-name: csi-cephfs-secret
  csi.storage.k8s.io/controller-expand-secret-namespace: ceph-csi
  csi.storage.k8s.io/node-stage-secret-name: csi-cephfs-secret
  csi.storage.k8s.io/node-stage-secret-namespace: ceph-csi
  csi.storage.k8s.io/fstype: ext4
reclaimPolicy: Delete
allowVolumeExpansion: true
mountOptions:
  - discard
EOF
</code></pre><p>&#x521B;&#x5EFA;</p>
<pre class="language-"><code>kubectl apply -f ceph-csi-3.2.0/deploy/cephfs/kubernetes/storageclass.yaml
</code></pre><p>&#x914D;&#x7F6E;&#x4E3A;&#x9ED8;&#x8BA4;<code>storage class</code>(&#x5DF2;&#x6709;&#x9ED8;&#x8BA4;&#xFF0C;&#x9700;&#x8981;&#x7F16;&#x8F91;&#x66F4;&#x6539;)</p>
<pre class="language-"><code>kubectl patch storageclass ceph-csi-rbd-sc -p &apos;{&quot;metadata&quot;: {&quot;annotations&quot;:{&quot;storageclass.kubernetes.io/is-default-class&quot;:&quot;true&quot;}}}&apos;
</code></pre><p>&#x67E5;&#x770B;<code>storage class</code></p>
<pre class="language-"><code>[root@ceph01 ~]# kubectl get sc
NAME                        PROVISIONER           RECLAIMPOLICY   VOLUMEBINDINGMODE      ALLOWVOLUMEEXPANSION   AGE
ceph-csi-cephfs-sc          cephfs.csi.ceph.com   Delete          Immediate              true                   5s
ceph-csi-rbd-sc (default)   rbd.csi.ceph.com      Delete          Immediate              true                   27h
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;<code>pvc</code>&#x9A8C;&#x8BC1;&#x53EF;&#x7528;&#x6027;</p>
</blockquote>
<p>&#x751F;&#x6210;&#x914D;&#x7F6E;</p>
<pre class="language-"><code>cat &lt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>EOF</span> <span class="token punctuation">&gt;</span></span> ceph-csi-3.2.0/deploy/cephfs/kubernetes/pvc-demo.yaml 
---
kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: cephfs-pvc-demo
  namespace: default
spec:
  storageClassName: ceph-csi-cephfs-sc
  accessModes:
  - ReadWriteMany
  resources:
    requests:
      storage: 1Gi
EOF
</code></pre><p>&#x521B;&#x5EFA;</p>
<pre class="language-"><code>kubectl apply -f ceph-csi-3.2.0/deploy/cephfs/kubernetes/pvc-demo.yaml
</code></pre><p>&#x67E5;&#x770B;</p>
<pre class="language-"><code>[root@ceph01 ~]# kubectl get pvc
NAME                                   STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS         AGE
ceph-pvc-demo                          Bound    pvc-360f8c5b-0f82-4f17-957b-a7eb5cf93f7e   20Gi       RWO            ceph-csi-rbd-sc      28h
cephfs-pvc-demo                        Bound    pvc-9400e0ab-2e44-4ce6-af39-a403441931e5   1Gi        RWX            ceph-csi-cephfs-sc   71s
</code></pre><blockquote>
<p><code>pvc</code>&#x6269;&#x5BB9;</p>
</blockquote>
<p>&#x751F;&#x6210;&#x914D;&#x7F6E;</p>
<pre class="language-"><code>cat &lt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>EOF</span> <span class="token punctuation">&gt;</span></span> ceph-csi-3.2.0/deploy/cephfs/kubernetes/nginx-demo.yaml 
apiVersion: v1
kind: Pod
metadata:
  name: cephfs-testpv
  labels:
    role: web-frontend
spec:
  containers:
  - name: web
    image: nginx
    ports:
      - name: web
        containerPort: 80
    volumeMounts:
      - name: cephfs-pvc-demo
        mountPath: &quot;/usr/share/nginx/html&quot;
  volumes:
  - name: cephfs-pvc-demo
    persistentVolumeClaim:
      claimName: cephfs-pvc-demo
EOF
</code></pre><p>&#x53D1;&#x5E03;</p>
<pre class="language-"><code>kubectl apply -f ceph-csi-3.2.0/deploy/cephfs/kubernetes/nginx-demo.yaml
</code></pre><p>&#x67E5;&#x770B;<code>pvc</code></p>
<pre class="language-"><code>[root@ceph01 ~]# kubectl get pvc cephfs-pvc-demo
NAME              STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS         AGE
cephfs-pvc-demo   Bound    pvc-9400e0ab-2e44-4ce6-af39-a403441931e5   1Gi        RWX            ceph-csi-cephfs-sc   7m2s
</code></pre><p>&#x7F16;&#x8F91;&#x4FEE;&#x6539;<code>pvc</code></p>
<pre class="language-"><code>kubectl edit pvc cephfs-pvc-demo
</code></pre><p>&#x4FEE;&#x6539;&#x4EE5;&#x4E0B;&#x5185;&#x5BB9;&#xFF0C;<code>storage: 1Gi</code>&#x8C03;&#x6574;&#x4E3A;<code>storage: 10Gi</code></p>
<pre class="language-"><code>...
spec:
  accessModes:
  - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
...
</code></pre><p>&#x518D;&#x6B21;&#x67E5;&#x770B;<code>pvc</code></p>
<pre class="language-"><code>[root@ceph01 ~]# kubectl get pvc cephfs-pvc-demo
NAME              STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS         AGE
cephfs-pvc-demo   Bound    pvc-9400e0ab-2e44-4ce6-af39-a403441931e5   10Gi       RWX            ceph-csi-cephfs-sc   9m
</code></pre><p><strong>&#x4E0E;<code>ceph rbd</code>&#x4E0D;&#x540C;&#x7684;&#x662F;&#xFF0C;&#x6269;&#x5BB9;<code>pvc</code>&#x65F6;&#x4E0D;&#x9700;&#x91CD;&#x542F;&#x540E;&#x7AEF;&#x5E94;&#x7528;</strong></p>
<h1 id="ceph&#x8FD0;&#x7EF4;&#x7BA1;&#x7406;"><a name="ceph&#x8FD0;&#x7EF4;&#x7BA1;&#x7406;" class="anchor-navigation-ex-anchor" href="#ceph&#x8FD0;&#x7EF4;&#x7BA1;&#x7406;"><i class="fa fa-link" aria-hidden="true"></i></a>ceph&#x8FD0;&#x7EF4;&#x7BA1;&#x7406;</h1>
<h2 id="&#x670D;&#x52A1;&#x542F;&#x505C;"><a name="&#x670D;&#x52A1;&#x542F;&#x505C;" class="anchor-navigation-ex-anchor" href="#&#x670D;&#x52A1;&#x542F;&#x505C;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x670D;&#x52A1;&#x542F;&#x505C;</h2>
<h3 id="&#x6309;&#x8282;&#x70B9;&#x542F;&#x52A8;&#x6240;&#x6709;ceph&#x670D;&#x52A1;"><a name="&#x6309;&#x8282;&#x70B9;&#x542F;&#x52A8;&#x6240;&#x6709;ceph&#x670D;&#x52A1;" class="anchor-navigation-ex-anchor" href="#&#x6309;&#x8282;&#x70B9;&#x542F;&#x52A8;&#x6240;&#x6709;ceph&#x670D;&#x52A1;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6309;&#x8282;&#x70B9;&#x542F;&#x52A8;&#x6240;&#x6709;ceph&#x670D;&#x52A1;</h3>
<pre class="language-"><code>systemctl start ceph.target
</code></pre><p>&#x6216;</p>
<pre class="language-"><code>sudo systemctl start ceph-osd.target
sudo systemctl start ceph-mon.target
sudo systemctl start ceph-mds.target
</code></pre><h3 id="&#x6309;&#x8282;&#x70B9;&#x505C;&#x6B62;&#x6240;&#x6709;ceph&#x670D;&#x52A1;"><a name="&#x6309;&#x8282;&#x70B9;&#x505C;&#x6B62;&#x6240;&#x6709;ceph&#x670D;&#x52A1;" class="anchor-navigation-ex-anchor" href="#&#x6309;&#x8282;&#x70B9;&#x505C;&#x6B62;&#x6240;&#x6709;ceph&#x670D;&#x52A1;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6309;&#x8282;&#x70B9;&#x505C;&#x6B62;&#x6240;&#x6709;ceph&#x670D;&#x52A1;</h3>
<pre class="language-"><code>systemctl stop ceph\*.service ceph\*.target
</code></pre><p>&#x6216;</p>
<pre class="language-"><code>sudo systemctl stop ceph-mon\*.service ceph-mon.target
sudo systemctl stop ceph-osd\*.service ceph-osd.target
sudo systemctl stop ceph-mds\*.service ceph-mds.target
</code></pre><h3 id="&#x63A7;&#x5236;&#x8282;&#x70B9;&#x7BA1;&#x7406;&#x96C6;&#x7FA4;&#x6240;&#x6709;&#x670D;&#x52A1;"><a name="&#x63A7;&#x5236;&#x8282;&#x70B9;&#x7BA1;&#x7406;&#x96C6;&#x7FA4;&#x6240;&#x6709;&#x670D;&#x52A1;" class="anchor-navigation-ex-anchor" href="#&#x63A7;&#x5236;&#x8282;&#x70B9;&#x7BA1;&#x7406;&#x96C6;&#x7FA4;&#x6240;&#x6709;&#x670D;&#x52A1;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x63A7;&#x5236;&#x8282;&#x70B9;&#x7BA1;&#x7406;&#x96C6;&#x7FA4;&#x6240;&#x6709;&#x670D;&#x52A1;</h3>
<p>&#x542F;</p>
<pre class="language-"><code>sudo systemctl start ceph-osd@{id}
sudo systemctl start ceph-mon@{hostname}
sudo systemctl start ceph-mds@{hostname}
</code></pre><p>&#x505C;</p>
<pre class="language-"><code>sudo systemctl stop ceph-osd@{id}
sudo systemctl stop ceph-mon@{hostname}
sudo systemctl stop ceph-mds@{hostname}
</code></pre><h2 id="pool&#x7BA1;&#x7406;"><a name="pool&#x7BA1;&#x7406;" class="anchor-navigation-ex-anchor" href="#pool&#x7BA1;&#x7406;"><i class="fa fa-link" aria-hidden="true"></i></a>pool&#x7BA1;&#x7406;</h2>
<h3 id="&#x67E5;&#x770B;pool"><a name="&#x67E5;&#x770B;pool" class="anchor-navigation-ex-anchor" href="#&#x67E5;&#x770B;pool"><i class="fa fa-link" aria-hidden="true"></i></a>&#x67E5;&#x770B;<code>pool</code></h3>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd lspools
1 ssd-demo-pool
2 nvme-demo-pool
</code></pre><h3 id="&#x521B;&#x5EFA;&#x4E00;&#x4E2A;pool"><a name="&#x521B;&#x5EFA;&#x4E00;&#x4E2A;pool" class="anchor-navigation-ex-anchor" href="#&#x521B;&#x5EFA;&#x4E00;&#x4E2A;pool"><i class="fa fa-link" aria-hidden="true"></i></a>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;pool</h3>
<p>&#x683C;&#x5F0F;</p>
<pre class="language-"><code>ceph osd pool create {pool-name} {pg-num} [{pgp-num}] [replicated] \
     [crush-rule-name] [expected-num-objects]

&#x6216;

ceph osd pool create {pool-name} {pg-num}  {pgp-num}   erasure \
     [erasure-code-profile] [crush-rule-name] [expected_num_objects]
</code></pre><p><strong>&#x6700;&#x4F73;&#x5B9E;&#x8DF5;</strong></p>
<h3 id="&#x8BBE;&#x7F6E;&#x6C60;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x6570;"><a name="&#x8BBE;&#x7F6E;&#x6C60;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x6570;" class="anchor-navigation-ex-anchor" href="#&#x8BBE;&#x7F6E;&#x6C60;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x6570;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x8BBE;&#x7F6E;&#x6C60;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x6570;</h3>
<pre class="language-"><code>ceph osd pool set {pool-name} pgp_num {pgp_num}
</code></pre><h3 id="&#x83B7;&#x53D6;&#x6C60;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x6570;"><a name="&#x83B7;&#x53D6;&#x6C60;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x6570;" class="anchor-navigation-ex-anchor" href="#&#x83B7;&#x53D6;&#x6C60;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x6570;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x83B7;&#x53D6;&#x6C60;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x6570;</h3>
<pre class="language-"><code>ceph osd pool get {pool-name} pg_num
</code></pre><h3 id="&#x83B7;&#x53D6;&#x96C6;&#x7FA4;&#x7684;pg&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;"><a name="&#x83B7;&#x53D6;&#x96C6;&#x7FA4;&#x7684;pg&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;" class="anchor-navigation-ex-anchor" href="#&#x83B7;&#x53D6;&#x96C6;&#x7FA4;&#x7684;pg&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x83B7;&#x53D6;&#x96C6;&#x7FA4;&#x7684;PG&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;</h3>
<pre class="language-"><code># ceph pg dump [--format {format}]
ceph pg dump -f json
</code></pre><h3 id="&#x5C06;&#x6C60;&#x4E0E;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5173;&#x8054;"><a name="&#x5C06;&#x6C60;&#x4E0E;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5173;&#x8054;" class="anchor-navigation-ex-anchor" href="#&#x5C06;&#x6C60;&#x4E0E;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5173;&#x8054;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5C06;&#x6C60;&#x4E0E;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5173;&#x8054;</h3>
<p>&#x6C60;&#x5728;&#x4F7F;&#x7528;&#x4E4B;&#x524D;&#x9700;&#x8981;&#x4E0E;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x76F8;&#x5173;&#x8054;&#x3002;&#x5C06;&#x4E0E;<code>cepfs</code>&#x4E00;&#x8D77;&#x4F7F;&#x7528;&#x7684;&#x6C60;&#x6216;&#x7531;<code>RGW</code>&#x81EA;&#x52A8;&#x521B;&#x5EFA;&#x7684;&#x6C60;&#x5C06;&#x81EA;&#x52A8;&#x5173;&#x8054;&#x3002;
&#x7528;&#x4E8E;&#x4E0E;<code>RBD</code>&#x4E00;&#x8D77;&#x4F7F;&#x7528;&#x7684;&#x6C60;&#x5E94;&#x8BE5;&#x4F7F;&#x7528;<code>RBD</code>&#x5DE5;&#x5177;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#x3002;</p>
<pre class="language-"><code># ceph osd pool application enable {pool-name} {application-name}(cephfs, rbd, rgw)
[root@ceph01 ~]# ceph osd pool application enable ssd-demo-pool rbd
enabled application &apos;rbd&apos; on pool &apos;ssd-demo-pool&apos;
[root@ceph01 ~]# ceph osd pool application enable nvme-demo-pool cephfs
enabled application &apos;cephfs&apos; on pool &apos;nvme-demo-pool&apos;
</code></pre><h3 id="&#x6C60;&#x914D;&#x989D;"><a name="&#x6C60;&#x914D;&#x989D;" class="anchor-navigation-ex-anchor" href="#&#x6C60;&#x914D;&#x989D;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6C60;&#x914D;&#x989D;</h3>
<p>&#x60A8;&#x53EF;&#x4EE5;&#x4E3A;&#x6BCF;&#x4E2A;&#x6C60;&#x7684;&#x6700;&#x5927;&#x5B57;&#x8282;&#x6570;&#x548C;/&#x6216;&#x6700;&#x5927;&#x5BF9;&#x8C61;&#x6570;&#x8BBE;&#x7F6E;&#x6C60;&#x914D;&#x989D;&#x3002;</p>
<pre class="language-"><code># ceph osd pool set-quota {pool-name} [max_objects {obj-count}] [max_bytes {bytes}]
ceph osd pool set-quota data max_objects 10000
</code></pre><p>&#x8981;&#x5220;&#x9664;&#x914D;&#x989D;&#xFF0C;&#x8BF7;&#x5C06;&#x5176;&#x503C;&#x8BBE;&#x7F6E;&#x4E3A;0</p>
<pre class="language-"><code>ceph osd pool set-quota data max_objects 0
</code></pre><h3 id="&#x5220;&#x9664;&#x6C60;"><a name="&#x5220;&#x9664;&#x6C60;" class="anchor-navigation-ex-anchor" href="#&#x5220;&#x9664;&#x6C60;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5220;&#x9664;&#x6C60;</h3>
<p>&#x8BED;&#x6CD5;&#x683C;&#x5F0F;</p>
<pre class="language-"><code>ceph osd pool delete {pool-name} [{pool-name} --yes-i-really-really-mean-it]
</code></pre><p>&#x4FEE;&#x6539;&#x914D;&#x7F6E;</p>
<pre class="language-"><code>vim /etc/ceph/ceph.conf
</code></pre><p>&#x6DFB;&#x52A0;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="language-"><code>[mon]
mon_allow_pool_delete=true
</code></pre><p>&#x66F4;&#x65B0;</p>
<pre class="language-"><code>cd /etc/ceph
ceph-deploy --overwrite-conf config push ceph01 ceph02 ceph03
</code></pre><p>&#x91CD;&#x542F;</p>
<pre class="language-"><code>systemctl restart ceph-mon.target
</code></pre><p>&#x5220;&#x9664;<code>ddd-pool</code></p>
<pre class="language-"><code>[root@ceph01 ceph]# ceph osd pool delete ddd-pool ddd-pool --yes-i-really-really-mean-it
pool &apos;ddd-pool&apos; removed
</code></pre><h3 id="&#x6C60;&#x91CD;&#x547D;&#x540D;"><a name="&#x6C60;&#x91CD;&#x547D;&#x540D;" class="anchor-navigation-ex-anchor" href="#&#x6C60;&#x91CD;&#x547D;&#x540D;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6C60;&#x91CD;&#x547D;&#x540D;</h3>
<pre class="language-"><code>ceph osd pool rename {current-pool-name} {new-pool-name}
</code></pre><h3 id="&#x663E;&#x793A;&#x6C60;&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;"><a name="&#x663E;&#x793A;&#x6C60;&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;" class="anchor-navigation-ex-anchor" href="#&#x663E;&#x793A;&#x6C60;&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x663E;&#x793A;&#x6C60;&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;</h3>
<pre class="language-"><code>[root@ceph01 ~]# rados df
POOL_NAME        USED OBJECTS CLONES COPIES MISSING_ON_PRIMARY UNFOUND DEGRADED RD_OPS  RD WR_OPS    WR USED COMPR UNDER COMPR
nvme-demo-pool 12 KiB       1      0      3                  0       0        0      0 0 B      1 1 KiB        0 B         0 B
ssd-demo-pool  12 KiB       1      0      3                  0       0        0      0 0 B      1 1 KiB        0 B         0 B

total_objects    2
total_used       30 GiB
total_avail      26 TiB
total_space      26 TiB
</code></pre><p>&#x6C60;<code>io</code></p>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd pool stats ssd-demo-pool
pool ssd-demo-pool id 1
  nothing is going on
</code></pre><h3 id="&#x521B;&#x5EFA;&#x6C60;&#x5FEB;&#x7167;"><a name="&#x521B;&#x5EFA;&#x6C60;&#x5FEB;&#x7167;" class="anchor-navigation-ex-anchor" href="#&#x521B;&#x5EFA;&#x6C60;&#x5FEB;&#x7167;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x521B;&#x5EFA;&#x6C60;&#x5FEB;&#x7167;</h3>
<pre class="language-"><code># ceph osd pool mksnap {pool-name} {snap-name}
[root@ceph01 ~]# ceph osd pool mksnap ssd-demo-pool ssd-demo-pool-snap-20210301
created pool ssd-demo-pool snap ssd-demo-pool-snap-20210301
</code></pre><h3 id="&#x5220;&#x9664;&#x6C60;&#x5FEB;&#x7167;"><a name="&#x5220;&#x9664;&#x6C60;&#x5FEB;&#x7167;" class="anchor-navigation-ex-anchor" href="#&#x5220;&#x9664;&#x6C60;&#x5FEB;&#x7167;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5220;&#x9664;&#x6C60;&#x5FEB;&#x7167;</h3>
<pre class="language-"><code># ceph osd pool rmsnap {pool-name} {snap-name}
[root@ceph01 ~]# ceph osd pool rmsnap ssd-demo-pool ssd-demo-pool-snap-20210301
removed pool ssd-demo-pool snap ssd-demo-pool-snap-20210301
</code></pre><h3 id="&#x6C60;&#x5176;&#x4ED6;&#x914D;&#x7F6E;"><a name="&#x6C60;&#x5176;&#x4ED6;&#x914D;&#x7F6E;" class="anchor-navigation-ex-anchor" href="#&#x6C60;&#x5176;&#x4ED6;&#x914D;&#x7F6E;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6C60;&#x5176;&#x4ED6;&#x914D;&#x7F6E;</h3>
<p>&#x67E5;&#x770B;&#x53EF;&#x914D;&#x7F6E;&#x9879;</p>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd pool -h

 General usage:
 ==============
usage: ceph [-h] [-c CEPHCONF] [-i INPUT_FILE] [-o OUTPUT_FILE]
            [--setuser SETUSER] [--setgroup SETGROUP] [--id CLIENT_ID]
            [--name CLIENT_NAME] [--cluster CLUSTER]
            [--admin-daemon ADMIN_SOCKET] [-s] [-w] [--watch-debug]
            [--watch-info] [--watch-sec] [--watch-warn] [--watch-error]
            [--watch-channel {cluster,audit,*}] [--version] [--verbose]
            [--concise] [-f {json,json-pretty,xml,xml-pretty,plain}]
            [--connect-timeout CLUSTER_TIMEOUT] [--block] [--period PERIOD]

Ceph administration tool

optional arguments:
  -h, --help            request mon help
  -c CEPHCONF, --conf CEPHCONF
                        ceph configuration file
  -i INPUT_FILE, --in-file INPUT_FILE
                        input file, or &quot;-&quot; for stdin
  -o OUTPUT_FILE, --out-file OUTPUT_FILE
                        output file, or &quot;-&quot; for stdout
  --setuser SETUSER     set user file permission
  --setgroup SETGROUP   set group file permission
  --id CLIENT_ID, --user CLIENT_ID
                        client id for authentication
  --name CLIENT_NAME, -n CLIENT_NAME
                        client name for authentication
  --cluster CLUSTER     cluster name
  --admin-daemon ADMIN_SOCKET
                        submit admin-socket commands (&quot;help&quot; for help
  -s, --status          show cluster status
  -w, --watch           watch live cluster changes
  --watch-debug         watch debug events
  --watch-info          watch info events
  --watch-sec           watch security events
  --watch-warn          watch warn events
  --watch-error         watch error events
  --watch-channel {cluster,audit,*}
                        which log channel to follow when using -w/--watch. One
                        of [&apos;cluster&apos;, &apos;audit&apos;, &apos;*&apos;]
  --version, -v         display version
  --verbose             make verbose
  --concise             make less verbose
  -f {json,json-pretty,xml,xml-pretty,plain}, --format {json,json-pretty,xml,xml-pretty,plain}
  --connect-timeout CLUSTER_TIMEOUT
                        set a timeout for connecting to the cluster
  --block               block until completion (scrub and deep-scrub only)
  --period PERIOD, -p PERIOD
                        polling period, default 1.0 second (for polling
                        commands only)

 Local commands:
 ===============

ping <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mon.id</span><span class="token punctuation">&gt;</span></span>           Send simple presence/life test to a mon
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mon.id</span><span class="token punctuation">&gt;</span></span> may be &apos;mon.*&apos; for all mons
daemon {type.id|path} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cmd</span><span class="token punctuation">&gt;</span></span>
                        Same as --admin-daemon, but auto-find admin socket
daemonperf {type.id | path} [stat-pats] [priority] [<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>interval</span><span class="token punctuation">&gt;</span></span>] [<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>count</span><span class="token punctuation">&gt;</span></span>]
daemonperf {type.id | path} list|ls [stat-pats] [priority]
                        Get selected perf stats from daemon/admin socket
                        Optional shell-glob comma-delim match string stat-pats
                        Optional selection priority (can abbreviate name):
                         critical, interesting, useful, noninteresting, debug
                        List shows a table of all available stats
                        Run <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>count</span><span class="token punctuation">&gt;</span></span> times (default forever),
                         once per <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>interval</span><span class="token punctuation">&gt;</span></span> seconds (default 1)


 Monitor commands:
 =================
osd pool application disable <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>app</span><span class="token punctuation">&gt;</span></span> {--yes-i-really-mean-it}   disables use of an application <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>app</span><span class="token punctuation">&gt;</span></span> on pool <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span>
osd pool application enable <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>app</span><span class="token punctuation">&gt;</span></span> {--yes-i-really-mean-it}    enable use of an application <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>app</span><span class="token punctuation">&gt;</span></span> [cephfs,rbd,rgw] on pool <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span>
osd pool application get {<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span>} {<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>app</span><span class="token punctuation">&gt;</span></span>} {<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>key</span><span class="token punctuation">&gt;</span></span>}                    get value of key <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>key</span><span class="token punctuation">&gt;</span></span> of application <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>app</span><span class="token punctuation">&gt;</span></span> on pool <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span>
osd pool application rm <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>app</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>key</span><span class="token punctuation">&gt;</span></span>                           removes application <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>app</span><span class="token punctuation">&gt;</span></span> metadata key <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>key</span><span class="token punctuation">&gt;</span></span> on pool <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span>
osd pool application set <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>app</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>key</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>                  sets application <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>app</span><span class="token punctuation">&gt;</span></span> metadata key <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>key</span><span class="token punctuation">&gt;</span></span> to <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span> on pool <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span>
osd pool autoscale-status                                                report on pool pg_num sizing recommendation and intent
osd pool cancel-force-backfill <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> [<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span>...]                restore normal recovery priority of specified pool <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>who</span><span class="token punctuation">&gt;</span></span>
osd pool cancel-force-recovery <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> [<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span>...]                restore normal recovery priority of specified pool <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>who</span><span class="token punctuation">&gt;</span></span>
osd pool create <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>int[0-]</span><span class="token punctuation">&gt;</span></span> {<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>int[0-]</span><span class="token punctuation">&gt;</span></span>} {replicated|erasure}    create pool
 {<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>erasure_code_profile</span><span class="token punctuation">&gt;</span></span>} {<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span><span class="token punctuation">&gt;</span></span>} {<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>int</span><span class="token punctuation">&gt;</span></span>} {<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>int</span><span class="token punctuation">&gt;</span></span>} {<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>int[0-]</span><span class="token punctuation">&gt;</span></span>} {<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>int[0-</span>
 <span class="token attr-name">]</span><span class="token punctuation">&gt;</span></span>} {<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>float[0.0-1.0]</span><span class="token punctuation">&gt;</span></span>}
osd pool deep-scrub <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> [<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span>...]                           initiate deep-scrub on pool <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>who</span><span class="token punctuation">&gt;</span></span>
osd pool force-backfill <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> [<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span>...]                       force backfill of specified pool <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>who</span><span class="token punctuation">&gt;</span></span> first
osd pool force-recovery <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> [<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span>...]                       force recovery of specified pool <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>who</span><span class="token punctuation">&gt;</span></span> first
osd pool get <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> size|min_size|pg_num|pgp_num|crush_rule|         get pool parameter <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>var</span><span class="token punctuation">&gt;</span></span>
 hashpspool|nodelete|nopgchange|nosizechange|write_fadvise_dontneed|
 noscrub|nodeep-scrub|hit_set_type|hit_set_period|hit_set_count|hit_set_
 fpp|use_gmt_hitset|target_max_objects|target_max_bytes|cache_target_
 dirty_ratio|cache_target_dirty_high_ratio|cache_target_full_ratio|
 cache_min_flush_age|cache_min_evict_age|erasure_code_profile|min_read_
 recency_for_promote|all|min_write_recency_for_promote|fast_read|hit_
 set_grade_decay_rate|hit_set_search_last_n|scrub_min_interval|scrub_
 max_interval|deep_scrub_interval|recovery_priority|recovery_op_
 priority|scrub_priority|compression_mode|compression_algorithm|
 compression_required_ratio|compression_max_blob_size|compression_min_
 blob_size|csum_type|csum_min_block|csum_max_block|allow_ec_overwrites|
 fingerprint_algorithm|pg_autoscale_mode|pg_autoscale_bias|pg_num_min|
 target_size_bytes|target_size_ratio
osd pool get-quota <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span>                                            obtain object or byte limits for pool
osd pool ls {detail}                                                     list pools
osd pool mksnap <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>snap</span><span class="token punctuation">&gt;</span></span>                                        make snapshot <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>snap</span><span class="token punctuation">&gt;</span></span> in <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pool</span><span class="token punctuation">&gt;</span></span>
osd pool rename <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span>                                    rename <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>srcpool</span><span class="token punctuation">&gt;</span></span> to <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>destpool</span><span class="token punctuation">&gt;</span></span>
osd pool repair <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> [<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span>...]                               initiate repair on pool <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>who</span><span class="token punctuation">&gt;</span></span>
osd pool rm <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> {<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span>} {--yes-i-really-really-mean-it} {--  remove pool
 yes-i-really-really-mean-it-not-faking}
osd pool rmsnap <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>snap</span><span class="token punctuation">&gt;</span></span>                                        remove snapshot <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>snap</span><span class="token punctuation">&gt;</span></span> from <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pool</span><span class="token punctuation">&gt;</span></span>
osd pool scrub <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> [<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span>...]                                initiate scrub on pool <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>who</span><span class="token punctuation">&gt;</span></span>
osd pool set <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> size|min_size|pg_num|pgp_num|pgp_num_actual|     set pool parameter <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>var</span><span class="token punctuation">&gt;</span></span> to <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>val</span><span class="token punctuation">&gt;</span></span>
 crush_rule|hashpspool|nodelete|nopgchange|nosizechange|write_fadvise_
 dontneed|noscrub|nodeep-scrub|hit_set_type|hit_set_period|hit_set_
 count|hit_set_fpp|use_gmt_hitset|target_max_bytes|target_max_objects|
 cache_target_dirty_ratio|cache_target_dirty_high_ratio|cache_target_
 full_ratio|cache_min_flush_age|cache_min_evict_age|min_read_recency_
 for_promote|min_write_recency_for_promote|fast_read|hit_set_grade_
 decay_rate|hit_set_search_last_n|scrub_min_interval|scrub_max_interval|
 deep_scrub_interval|recovery_priority|recovery_op_priority|scrub_
 priority|compression_mode|compression_algorithm|compression_required_
 ratio|compression_max_blob_size|compression_min_blob_size|csum_type|
 csum_min_block|csum_max_block|allow_ec_overwrites|fingerprint_
 algorithm|pg_autoscale_mode|pg_autoscale_bias|pg_num_min|target_size_
 bytes|target_size_ratio <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>val</span><span class="token punctuation">&gt;</span></span> {--yes-i-really-mean-it}
osd pool set-quota <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span> max_objects|max_bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>val</span><span class="token punctuation">&gt;</span></span>                set object or byte limit on pool
osd pool stats {<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>poolname</span><span class="token punctuation">&gt;</span></span>}                                              obtain stats from all pools, or from specified pool
</code></pre><h3 id="&#x8BBE;&#x7F6E;&#x5BF9;&#x8C61;&#x526F;&#x672C;&#x6570;"><a name="&#x8BBE;&#x7F6E;&#x5BF9;&#x8C61;&#x526F;&#x672C;&#x6570;" class="anchor-navigation-ex-anchor" href="#&#x8BBE;&#x7F6E;&#x5BF9;&#x8C61;&#x526F;&#x672C;&#x6570;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x8BBE;&#x7F6E;&#x5BF9;&#x8C61;&#x526F;&#x672C;&#x6570;</h3>
<p>&#x9ED8;&#x8BA4;&#x4E3A;3</p>
<pre class="language-"><code>ceph osd pool set {poolname} size {num-replicas}
</code></pre><h3 id="pgautoscalemode"><a name="pgautoscalemode" class="anchor-navigation-ex-anchor" href="#pgautoscalemode"><i class="fa fa-link" aria-hidden="true"></i></a>pg_autoscale_mode</h3>
<p>&#x653E;&#x7F6E;&#x7EC4;&#xFF08;PGs&#xFF09;&#x662F;<code>Ceph</code>&#x5206;&#x53D1;&#x6570;&#x636E;&#x7684;&#x5185;&#x90E8;&#x5B9E;&#x73B0;&#x7EC6;&#x8282;&#x3002;
&#x8FC7;&#x542F;&#x7528;<code>pg autoscaling</code>&#xFF0C;&#x60A8;&#x53EF;&#x4EE5;&#x5141;&#x8BB8;&#x96C6;&#x7FA4;&#x63D0;&#x51FA;&#x5EFA;&#x8BAE;&#x6216;&#x6839;&#x636E;&#x96C6;&#x7FA4;&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x81EA;&#x52A8;&#x8C03;&#x6574;<code>PGs</code>&#x3002;</p>
<p>&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x6C60;&#x90FD;&#x6709;&#x4E00;&#x4E2A;<code>pg_autoscale_mode</code>&#x5C5E;&#x6027;&#xFF0C;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x4E3A;<code>off</code>&#x3001;<code>on</code>&#x6216;<code>warn</code>&#xFF1A;</p>
<ul>
<li>off&#xFF1A;&#x7981;&#x7528;&#x6B64;&#x6C60;&#x7684;&#x81EA;&#x52A8;&#x7F29;&#x653E;&#x3002;&#x7531;&#x7BA1;&#x7406;&#x5458;&#x4E3A;&#x6BCF;&#x4E2A;&#x6C60;&#x9009;&#x62E9;&#x9002;&#x5F53;&#x7684;<code>PG</code>&#x6570;&#x91CF;&#x3002;</li>
<li>on&#xFF1A;&#x542F;&#x7528;&#x7ED9;&#x5B9A;&#x6C60;&#x7684;<code>PG</code>&#x8BA1;&#x6570;&#x7684;&#x81EA;&#x52A8;&#x8C03;&#x6574;&#x3002;</li>
<li>warn&#xFF1A;&#x5F53;<code>PG</code>&#x8BA1;&#x6570;&#x9700;&#x8981;&#x8C03;&#x6574;&#x65F6;&#x53D1;&#x51FA;&#x5065;&#x5EB7;&#x8B66;&#x62A5;&#xFF08;&#x9ED8;&#x8BA4;&#xFF09;</li>
</ul>
<blockquote>
<p>&#x4E3A;&#x6307;&#x5B9A;&#x6C60;&#x8BBE;&#x7F6E;&#x653E;&#x7F6E;&#x7EC4;&#x6570;&#x81EA;&#x52A8;&#x4F38;&#x7F29;</p>
</blockquote>
<pre class="language-"><code># ceph osd pool set <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pool-name</span><span class="token punctuation">&gt;</span></span> pg_autoscale_mode <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mode</span><span class="token punctuation">&gt;</span></span>

[root@ceph01 ~]# ceph osd pool set ssd-demo-pool pg_autoscale_mode on
set pool 1 pg_autoscale_mode to on
</code></pre><blockquote>
<p>&#x8BBE;&#x7F6E;&#x96C6;&#x7FA4;&#x5185;&#x6240;&#x6709;&#x6C60;&#x653E;&#x7F6E;&#x7EC4;&#x6570;&#x81EA;&#x52A8;&#x4F38;&#x7F29;</p>
</blockquote>
<pre class="language-"><code># ceph config set global osd_pool_default_pg_autoscale_mode <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mode</span><span class="token punctuation">&gt;</span></span>

ceph config set global osd_pool_default_pg_autoscale_mode on
</code></pre><p>&#x67E5;&#x770B;&#x96C6;&#x7FA4;&#x5185;&#x653E;&#x7F6E;&#x7EC4;&#x6570;&#x4F38;&#x7F29;&#x7B56;&#x7565;</p>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd pool autoscale-status
POOL             SIZE TARGET SIZE RATE RAW CAPACITY  RATIO TARGET RATIO EFFECTIVE RATIO BIAS PG_NUM NEW PG_NUM AUTOSCALE
nvme-demo-pool     7               3.0       11178G 0.0000                               1.0    256         32 warn
ssd-demo-pool      7               3.0       15202G 0.0000                               1.0     32            on
</code></pre><p>&#x521B;&#x5EFA;<code>ddd-pool</code>&#xFF0C;&#x5E76;&#x67E5;&#x770B;&#x96C6;&#x7FA4;&#x5185;&#x653E;&#x7F6E;&#x7EC4;&#x6570;&#x4F38;&#x7F29;&#x7B56;&#x7565;</p>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd pool create ddd-pool 1 1
pool &apos;ddd-pool&apos; created
[root@ceph01 ~]# ceph osd pool autoscale-status
POOL             SIZE TARGET SIZE RATE RAW CAPACITY  RATIO TARGET RATIO EFFECTIVE RATIO BIAS PG_NUM NEW PG_NUM AUTOSCALE
nvme-demo-pool     7               3.0       26380G 0.0000                               1.0    256         32 warn
ssd-demo-pool      7               3.0       15202G 0.0000                               1.0     32            on
ddd-pool           0               3.0       26380G 0.0000                               1.0      1         32 on
</code></pre><blockquote>
<p>&#x67E5;&#x770B;&#x6C60;&#x4F38;&#x7F29;&#x5EFA;&#x8BAE;</p>
</blockquote>
<pre class="language-"><code>POOL             SIZE TARGET SIZE RATE RAW CAPACITY  RATIO TARGET RATIO EFFECTIVE RATIO BIAS PG_NUM NEW PG_NUM AUTOSCALE
nvme-demo-pool     7               3.0       26380G 0.0000                               1.0    256         32 warn
ssd-demo-pool      7               3.0       15202G 0.0000                               1.0     32            on
ddd-pool           0               3.0       26380G 0.0000                               1.0     32            on
</code></pre><ul>
<li><code>SIZE</code>&#xFF1A;&#x5B58;&#x50A8;&#x5728;&#x6C60;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x91CF;</li>
<li><code>TARGET SIZE</code>&#xFF1A;&#x7BA1;&#x7406;&#x5458;&#x6307;&#x5B9A;&#x7684;&#x4ED6;&#x4EEC;&#x5E0C;&#x671B;&#x6700;&#x7EC8;&#x5B58;&#x50A8;&#x5728;&#x6B64;&#x6C60;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x91CF;</li>
<li><code>RATE</code>&#xFF1A;&#x6C60;&#x7684;&#x4E58;&#x6570;&#xFF0C;&#x7528;&#x4E8E;&#x786E;&#x5B9A;&#x6D88;&#x8017;&#x4E86;&#x591A;&#x5C11;&#x539F;&#x59CB;&#x5B58;&#x50A8;&#x5BB9;&#x91CF;&#x3002;&#x4F8B;&#x5982;&#xFF0C;3&#x526F;&#x672C;&#x6C60;&#x7684;&#x6BD4;&#x7387;&#x4E3A;3.0&#xFF0C;&#x800C;<code>k=4</code>&#xFF0C;<code>m=2</code>&#x64E6;&#x9664;&#x7F16;&#x7801;&#x6C60;&#x7684;&#x6BD4;&#x7387;&#x4E3A;1.5&#x3002;</li>
<li><code>RAW CAPACITY</code>&#xFF1A;&#x8D1F;&#x8D23;&#x5B58;&#x50A8;&#x6B64;&#x6C60;(&#x53EF;&#x80FD;&#x8FD8;&#x6709;&#x5176;&#x4ED6;&#x6C60;)&#x6570;&#x636E;&#x7684;<code>OSD</code>&#x4E0A;&#x7684;&#x88F8;&#x5B58;&#x50A8;&#x5BB9;&#x91CF;&#x7684;&#x603B;&#x548C;&#x3002;</li>
<li><code>RATIO</code>&#xFF1A;&#x5F53;&#x524D;&#x6C60;&#x6B63;&#x5728;&#x6D88;&#x8017;&#x7684;&#x603B;&#x5BB9;&#x91CF;&#x7684;&#x6BD4;&#x7387;(&#x5373;RATIO = size * rate / raw capacity)&#x3002;</li>
<li><code>TARGET RATIO</code>&#xFF1A;&#x7BA1;&#x7406;&#x5458;&#x6307;&#x5B9A;&#x7684;&#x671F;&#x671B;&#x6B64;&#x6C60;&#x6D88;&#x8017;&#x7684;&#x5B58;&#x50A8;&#x7A7A;&#x95F4;&#x76F8;&#x5BF9;&#x4E8E;&#x8BBE;&#x7F6E;&#x4E86;&#x76EE;&#x6807;&#x6BD4;&#x7387;&#x7684;&#x5176;&#x4ED6;&#x6C60;&#x7684;&#x6BD4;&#x7387;&#x3002;&#x5982;&#x679C;&#x540C;&#x65F6;&#x6307;&#x5B9A;&#x4E86;&#x76EE;&#x6807;&#x5927;&#x5C0F;&#x5B57;&#x8282;&#x548C;&#x6BD4;&#x7387;&#xFF0C;&#x5219;&#x8BE5;&#x6BD4;&#x7387;&#x4F18;&#x5148;</li>
<li><code>EFFECTIVE RATIO</code>&#xFF1A;&#x6709;&#x6548;&#x6BD4;&#x7387;&#x662F;&#x901A;&#x8FC7;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#x8C03;&#x6574;&#x540E;&#x7684;&#x76EE;&#x6807;&#x6BD4;&#x7387;&#xFF1A;<ul>
<li>&#x51CF;&#x53BB;&#x8BBE;&#x7F6E;&#x4E86;&#x76EE;&#x6807;&#x5927;&#x5C0F;&#x7684;&#x6C60;&#x9884;&#x671F;&#x4F7F;&#x7528;&#x7684;&#x4EFB;&#x4F55;&#x5BB9;&#x91CF;</li>
<li>&#x5728;&#x8BBE;&#x7F6E;&#x4E86;&#x76EE;&#x6807;&#x6BD4;&#x7387;&#x7684;&#x6C60;&#x4E4B;&#x95F4;&#x89C4;&#x8303;&#x5316;&#x76EE;&#x6807;&#x6BD4;&#x7387;&#xFF0C;&#x4EE5;&#x4FBF;&#x5B83;&#x4EEC;&#x5171;&#x540C;&#x4EE5;&#x7A7A;&#x95F4;&#x7684;&#x5176;&#x4F59;&#x90E8;&#x5206;&#x4E3A;&#x76EE;&#x6807;&#x3002;&#x4F8B;&#x5982;&#xFF0C;4&#x4E2A;&#x6C60;&#x7684;&#x76EE;&#x6807;&#x6536;&#x76CA;&#x7387;&#x4E3A;1.0&#xFF0C;&#x5176;&#x6709;&#x6548;&#x6536;&#x76CA;&#x7387;&#x4E3A;0.25&#x3002;
&#x7CFB;&#x7EDF;&#x4F7F;&#x7528;&#x5B9E;&#x9645;&#x6BD4;&#x7387;&#x548C;&#x6709;&#x6548;&#x6BD4;&#x7387;&#x4E2D;&#x7684;&#x8F83;&#x5927;&#x8005;&#x8FDB;&#x884C;&#x8BA1;&#x7B97;&#x3002;</li>
</ul>
</li>
<li><code>PG_NUM</code>&#xFF1A;&#x6C60;&#x7684;&#x5F53;&#x524D;<code>PG</code>&#x6570;</li>
<li><code>NEW PG_NUM</code>&#xFF1A;&#x6C60;&#x7684;<code>pgu NUM</code>&#x671F;&#x671B;&#x503C;&#x3002;&#x5B83;&#x59CB;&#x7EC8;&#x662F;2&#x7684;&#x5E42;&#xFF0C;&#x5E76;&#x4E14;&#x53EA;&#x6709;&#x5F53;&#x671F;&#x671B;&#x503C;&#x4E0E;&#x5F53;&#x524D;&#x503C;&#x76F8;&#x5DEE;&#x8D85;&#x8FC7;3&#x500D;&#x65F6;&#x624D;&#x4F1A;&#x51FA;&#x73B0;&#x3002;</li>
<li><code>AUTOSCALE</code>&#xFF1A;<code>pool_pg_autosacle</code>&#x6A21;&#x5F0F;&#xFF0C;&#x53EF;&#x4EE5;&#x662F;<code>on</code>&#x3001;<code>off</code>&#x6216;<code>warn</code>&#x3002;</li>
</ul>
<blockquote>
<p>&#x81EA;&#x52A8;&#x7F29;&#x653E;</p>
</blockquote>
<p>&#x5141;&#x8BB8;&#x96C6;&#x7FA4;&#x6839;&#x636E;&#x4F7F;&#x7528;&#x60C5;&#x51B5;&#x81EA;&#x52A8;&#x6269;&#x5C55;<code>PGs</code>&#x662F;&#x6700;&#x7B80;&#x5355;&#x7684;&#x65B9;&#x6CD5;&#x3002;<code>Ceph</code>&#x5C06;&#x67E5;&#x770B;&#x6574;&#x4E2A;&#x7CFB;&#x7EDF;&#x7684;&#x603B;&#x53EF;&#x7528;&#x5B58;&#x50A8;&#x548C;<code>PGs</code>&#x7684;&#x76EE;&#x6807;&#x6570;&#x91CF;&#xFF0C;&#x67E5;&#x770B;&#x6BCF;&#x4E2A;&#x6C60;&#x4E2D;&#x5B58;&#x50A8;&#x4E86;&#x591A;&#x5C11;&#x6570;&#x636E;&#xFF0C;&#x5E76;&#x5C1D;&#x8BD5;&#x76F8;&#x5E94;&#x5730;&#x5206;&#x914D;<code>PGs</code>&#x3002;
&#x7CFB;&#x7EDF;&#x91C7;&#x7528;&#x7684;&#x65B9;&#x6CD5;&#x76F8;&#x5BF9;&#x4FDD;&#x5B88;&#xFF0C;&#x4EC5;&#x5728;&#x5F53;&#x524D;<code>pg</code>(pg_num)&#x7684;&#x6570;&#x91CF;&#x6BD4;&#x5B83;&#x8BA4;&#x4E3A;&#x5E94;&#x8BE5;&#x7684;&#x6570;&#x91CF;&#x5C11;3&#x500D;&#x4EE5;&#x4E0A;&#x65F6;&#x624D;&#x5BF9;&#x6C60;&#x8FDB;&#x884C;&#x66F4;&#x6539;&#x3002;</p>
<p>&#x6BCF;&#x4E2A;<code>OSD</code>&#x7684;<code>pg</code>&#x76EE;&#x6807;&#x6570;&#x57FA;&#x4E8E;<code>mon_target_pg_per_OSD</code>&#x53EF;&#x914D;&#x7F6E;&#xFF08;&#x9ED8;&#x8BA4;&#x503C;&#xFF1A;100&#xFF09;&#xFF0C;&#x53EF;&#x901A;&#x8FC7;&#x4EE5;&#x4E0B;&#x65B9;&#x5F0F;&#x8FDB;&#x884C;&#x8C03;&#x6574;:</p>
<pre class="language-"><code>ceph config set global mon_target_pg_per_OSD 100
</code></pre><h3 id="&#x6307;&#x5B9A;&#x6C60;&#x7684;&#x671F;&#x671B;&#x5927;&#x5C0F;"><a name="&#x6307;&#x5B9A;&#x6C60;&#x7684;&#x671F;&#x671B;&#x5927;&#x5C0F;" class="anchor-navigation-ex-anchor" href="#&#x6307;&#x5B9A;&#x6C60;&#x7684;&#x671F;&#x671B;&#x5927;&#x5C0F;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6307;&#x5B9A;&#x6C60;&#x7684;&#x671F;&#x671B;&#x5927;&#x5C0F;</h3>
<p>&#x5F53;&#x7B2C;&#x4E00;&#x6B21;&#x521B;&#x5EFA;&#x96C6;&#x7FA4;&#x6216;&#x6C60;&#x65F6;&#xFF0C;&#x5B83;&#x5C06;&#x6D88;&#x8017;&#x96C6;&#x7FA4;&#x603B;&#x5BB9;&#x91CF;&#x7684;&#x4E00;&#x5C0F;&#x90E8;&#x5206;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x7CFB;&#x7EDF;&#x770B;&#x6765;&#x4F3C;&#x4E4E;&#x53EA;&#x9700;&#x8981;&#x5C11;&#x91CF;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x3002;
&#x4F46;&#x662F;&#xFF0C;&#x5728;&#x5927;&#x591A;&#x6570;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x96C6;&#x7FA4;&#x7BA1;&#x7406;&#x5458;&#x90FD;&#x5F88;&#x6E05;&#x695A;&#xFF0C;&#x968F;&#x7740;&#x65F6;&#x95F4;&#x7684;&#x63A8;&#x79FB;&#xFF0C;&#x54EA;&#x4E9B;&#x6C60;&#x5C06;&#x6D88;&#x8017;&#x5927;&#x90E8;&#x5206;&#x7CFB;&#x7EDF;&#x5BB9;&#x91CF;&#x3002;
&#x901A;&#x8FC7;&#x5411;<code>Ceph</code>&#x63D0;&#x4F9B;&#x6B64;&#x4FE1;&#x606F;&#xFF0C;&#x53EF;&#x4EE5;&#x4ECE;&#x4E00;&#x5F00;&#x59CB;&#x5C31;&#x4F7F;&#x7528;&#x66F4;&#x5408;&#x9002;&#x6570;&#x91CF;&#x7684;<code>pg</code>&#xFF0C;&#x4ECE;&#x800C;&#x9632;&#x6B62;<code>pg_num</code>&#x7684;&#x540E;&#x7EED;&#x66F4;&#x6539;&#x4EE5;&#x53CA;&#x5728;&#x8FDB;&#x884C;&#x8FD9;&#x4E9B;&#x8C03;&#x6574;&#x65F6;&#x4E0E;&#x79FB;&#x52A8;&#x6570;&#x636E;&#x76F8;&#x5173;&#x7684;&#x5F00;&#x9500;</p>
<p>&#x6C60;&#x7684;&#x76EE;&#x6807;&#x5927;&#x5C0F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#x6307;&#x5B9A;&#xFF1A;&#x8981;&#x4E48;&#x6839;&#x636E;&#x6C60;&#x7684;&#x7EDD;&#x5BF9;&#x5927;&#x5C0F;&#xFF08;&#x5373;&#x5B57;&#x8282;&#xFF09;&#xFF0C;&#x8981;&#x4E48;&#x4F5C;&#x4E3A;&#x76F8;&#x5BF9;&#x4E8E;&#x8BBE;&#x7F6E;&#x4E86;&#x76EE;&#x6807;&#x5927;&#x5C0F;&#x6BD4;&#x7684;&#x5176;&#x4ED6;&#x6C60;&#x7684;&#x6743;&#x91CD;&#x3002;</p>
<p><code>ddd-pool</code>&#x9884;&#x8BA1;&#x4F7F;&#x7528;<code>1G</code>&#x5B58;&#x50A8;&#x7A7A;&#x95F4;</p>
<pre class="language-"><code>ceph osd pool set ddd-pool target_size_bytes 1G
</code></pre><p>&#x76F8;&#x5BF9;&#x4E8E;&#x8BBE;&#x7F6E;&#x4E86;<code>target_size_ratio</code>&#x7684;&#x5176;&#x4ED6;&#x6C60;&#xFF0C;<code>mpool</code>&#x9884;&#x8BA1;&#x5C06;&#x6D88;&#x8017;1.0&#x3002;
&#x5982;&#x679C;<code>mpool</code>&#x662F;&#x96C6;&#x7FA4;&#x4E2D;&#x552F;&#x4E00;&#x7684;&#x6C60;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x9884;&#x8BA1;&#x5C06;&#x4F7F;&#x7528;&#x603B;&#x5BB9;&#x91CF;&#x7684;100%&#x3002;
&#x5982;&#x679C;&#x6709;&#x7B2C;&#x4E8C;&#x4E2A;&#x5E26;&#x6709;<code>target_size_ratio</code>1.0&#x7684;&#x6C60;&#xFF0C;&#x90A3;&#x4E48;&#x4E24;&#x4E2A;&#x6C60;&#x90FD;&#x5E0C;&#x671B;&#x4F7F;&#x7528;50%&#x7684;&#x96C6;&#x7FA4;&#x5BB9;&#x91CF;&#x3002;</p>
<pre class="language-"><code>ceph osd pool set mypool target_size_ratio 1.0
</code></pre><h3 id="&#x653E;&#x7F6E;&#x7EC4;&#x6570;&#x914D;&#x7F6E;"><a name="&#x653E;&#x7F6E;&#x7EC4;&#x6570;&#x914D;&#x7F6E;" class="anchor-navigation-ex-anchor" href="#&#x653E;&#x7F6E;&#x7EC4;&#x6570;&#x914D;&#x7F6E;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x653E;&#x7F6E;&#x7EC4;&#x6570;&#x914D;&#x7F6E;</h3>
<pre class="language-"><code># ceph osd pool create {pool-name} pg_num
</code></pre><p>&#x5FC5;&#x987B;&#x9009;&#x62E9;<code>pg_num</code>&#x7684;&#x503C;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#xFF08;&#x5F53;&#x524D;&#xFF09;&#x65E0;&#x6CD5;&#x81EA;&#x52A8;&#x8BA1;&#x7B97;&#x3002;&#x4EE5;&#x4E0B;&#x662F;&#x4E00;&#x4E9B;&#x5E38;&#x7528;&#x503C;&#xFF1A;</p>
<ul>
<li>&#x5C11;&#x4E8E;<code>5 OSDs</code>&#x8BBE;&#x7F6E;<code>pg_num</code>&#x4E3A;128</li>
<li><code>5-10 OSDs</code>&#x8BBE;&#x7F6E;<code>pg_num</code>&#x4E3A;512</li>
<li><code>10-50 OSDs</code>&#x8BBE;&#x7F6E;<code>pg_num</code>&#x4E3A;1024</li>
<li>&#x5982;&#x679C;&#x60A8;&#x6709;&#x8D85;&#x8FC7;<code>50</code>&#x4E2A;<code>OSD</code>&#xFF0C;&#x5219;&#x9700;&#x8981;&#x4F7F;&#x7528;<a href="https://ceph.com/pgcalc/" target="_blank">pgcalc</a> &#x8BA1;&#x7B97;<code>pg_num</code>&#x503C;</li>
</ul>
<pre class="language-"><code>             (OSDs * 100)
Total PGs =  ------------
              pool size
</code></pre><p>&#x7ED3;&#x679C;&#x5E94;&#x59CB;&#x7EC8;&#x56DB;&#x820D;&#x4E94;&#x5165;&#x5230;&#x6700;&#x63A5;&#x8FD1;&#x7684;&#x4E8C;&#x6B21;&#x65B9;,&#x53EA;&#x6709;2&#x7684;&#x5E42;&#x624D;&#x80FD;&#x5E73;&#x8861;&#x653E;&#x7F6E;&#x7EC4;&#x4E2D;&#x5BF9;&#x8C61;&#x7684;&#x6570;&#x91CF;&#x3002;&#x5176;&#x4ED6;&#x503C;&#x5C06;&#x5BFC;&#x81F4;&#x6570;&#x636E;&#x5728;&#x60A8;&#x7684;<code>OSD</code>&#x4E2D;&#x7684;&#x4E0D;&#x5747;&#x5300;&#x5206;&#x5E03;&#x3002;</p>
<p>&#x4F8B;&#x5982;&#xFF0C;&#x5BF9;&#x4E8E;&#x5177;&#x6709;200&#x4E2A;<code>OSD</code>&#x548C;3&#x4E2A;&#x526F;&#x672C;&#x7684;&#x6C60;&#x5927;&#x5C0F;&#x7684;&#x7FA4;&#x96C6;&#xFF0C;&#x60A8;&#x53EF;&#x4EE5;&#x6309;&#x4EE5;&#x4E0B;&#x65B9;&#x5F0F;&#x4F30;&#x8BA1;<code>PG</code>&#x7684;&#x6570;&#x91CF;&#xFF1A;</p>
<pre class="language-"><code>(200 * 100)
----------- = 6667. &#x6700;&#x63A5;&#x8FD1;&#x8BE5;&#x6570;&#x503C;&#x7684;2&#x7684;&#x5E42;&#x7B49;&#x4E3A;8192
     3
</code></pre><h3 id="&#x653E;&#x7F6E;&#x7EC4;&#x89E3;&#x6790;"><a name="&#x653E;&#x7F6E;&#x7EC4;&#x89E3;&#x6790;" class="anchor-navigation-ex-anchor" href="#&#x653E;&#x7F6E;&#x7EC4;&#x89E3;&#x6790;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x653E;&#x7F6E;&#x7EC4;&#x89E3;&#x6790;</h3>
<p>&#x653E;&#x7F6E;&#x7EC4;&#xFF08;PG&#xFF09;&#x805A;&#x5408;&#x6C60;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x6BCF;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x8DDF;&#x8E2A;&#x5BF9;&#x8C61;&#x653E;&#x7F6E;&#x548C;&#x5BF9;&#x8C61;&#x5143;&#x6570;&#x636E;&#x5728;&#x8BA1;&#x7B97;&#x4E0A;&#x975E;&#x5E38;&#x6602;&#x8D35;&#xFF0C;
&#x5373;&#xFF0C;&#x5177;&#x6709;&#x6570;&#x767E;&#x4E07;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x7CFB;&#x7EDF;&#x65E0;&#x6CD5;&#x5728;&#x6BCF;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x771F;&#x5B9E;&#x5730;&#x8DDF;&#x8E2A;&#x653E;&#x7F6E;&#x3002;</p>
<p><code>Ceph</code>&#x5BA2;&#x6237;&#x7AEF;&#x5C06;&#x8BA1;&#x7B97;&#x5BF9;&#x8C61;&#x5E94;&#x8BE5;&#x5728;&#x54EA;&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#x4E2D;&#x3002;&#x5B83;&#x901A;&#x8FC7;&#x6563;&#x5217;&#x5BF9;&#x8C61;<code>ID</code>&#x5E76;&#x57FA;&#x4E8E;&#x5B9A;&#x4E49;&#x6C60;&#x4E2D;<code>pg</code>&#x7684;&#x6570;&#x91CF;&#x548C;&#x6C60;&#x7684;<code>ID</code>&#x5E94;&#x7528;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#x6765;&#x5B9E;&#x73B0;&#x8FD9;&#x4E00;&#x70B9;</p>
<p>&#x653E;&#x7F6E;&#x7EC4;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#x5185;&#x5BB9;&#x5B58;&#x50A8;&#x5728;&#x4E00;&#x7EC4;<code>OSD</code>&#x4E2D;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5728;&#x5927;&#x5C0F;&#x4E3A;2&#x7684;&#x590D;&#x5236;&#x6C60;&#x4E2D;&#xFF0C;&#x6BCF;&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#x5C06;&#x5728;&#x4E24;&#x4E2A;<code>OSD</code>&#x4E0A;&#x5B58;&#x50A8;&#x5BF9;&#x8C61;.</p>
<p>&#x5982;&#x679C;<code>OSD#2</code>&#x5931;&#x8D25;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x5C06;&#x88AB;&#x5206;&#x914D;&#x5230;&#x653E;&#x7F6E;&#x7EC4;<code>#1</code>&#xFF0C;&#x5E76;&#x5C06;&#x586B;&#x5145;<code>OSD#1</code>&#x4E2D;&#x6240;&#x6709;&#x5BF9;&#x8C61;&#x7684;&#x526F;&#x672C;&#x3002;&#x5982;&#x679C;&#x6C60;&#x5927;&#x5C0F;&#x4ECE;2&#x66F4;&#x6539;&#x4E3A;3&#xFF0C;&#x5219;&#x4F1A;&#x4E3A;&#x653E;&#x7F6E;&#x7EC4;&#x5206;&#x914D;&#x4E00;&#x4E2A;&#x9644;&#x52A0;&#x7684;<code>OSD</code>&#xFF0C;&#x5E76;&#x63A5;&#x6536;&#x653E;&#x7F6E;&#x7EC4;&#x4E2D;&#x6240;&#x6709;&#x5BF9;&#x8C61;&#x7684;&#x526F;&#x672C;&#x3002;</p>
<p>&#x653E;&#x7F6E;&#x7EC4;&#x4E0D;&#x62E5;&#x6709;<code>OSD</code>,&#x5B83;&#x4EEC;&#x4E0E;&#x6765;&#x81EA;&#x540C;&#x4E00;&#x6C60;&#x751A;&#x81F3;&#x5176;&#x4ED6;&#x6C60;&#x7684;&#x5176;&#x4ED6;&#x653E;&#x7F6E;&#x7EC4;&#x5171;&#x4EAB;<code>OSD</code>&#x3002;&#x5982;&#x679C;<code>OSD#2</code>&#x5931;&#x8D25;&#xFF0C;&#x653E;&#x7F6E;&#x7EC4;<code>#2</code>&#x8FD8;&#x5FC5;&#x987B;&#x4F7F;&#x7528;<code>OSD#3</code>&#x8FD8;&#x539F;&#x5BF9;&#x8C61;&#x7684;&#x526F;&#x672C;&#x3002;</p>
<p>&#x5F53;&#x653E;&#x7F6E;&#x7EC4;&#x7684;&#x6570;&#x91CF;&#x589E;&#x52A0;&#x65F6;&#xFF0C;&#x65B0;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x5C06;&#x88AB;&#x5206;&#x914D;<code>OSD</code>&#x3002;<code>&#x6324;&#x538B;</code>&#x529F;&#x80FD;&#x7684;&#x7ED3;&#x679C;&#x4E5F;&#x5C06;&#x66F4;&#x6539;&#xFF0C;&#x4EE5;&#x524D;&#x653E;&#x7F6E;&#x7EC4;&#x4E2D;&#x7684;&#x67D0;&#x4E9B;&#x5BF9;&#x8C61;&#x5C06;&#x590D;&#x5236;&#x5230;&#x65B0;&#x653E;&#x7F6E;&#x7EC4;&#x4E2D;&#xFF0C;&#x5E76;&#x4ECE;&#x65E7;&#x653E;&#x7F6E;&#x7EC4;&#x4E2D;&#x5220;&#x9664;&#x3002;</p>
<h3 id="&#x653E;&#x7F6E;&#x7EC4;&#x6743;&#x8861;"><a name="&#x653E;&#x7F6E;&#x7EC4;&#x6743;&#x8861;" class="anchor-navigation-ex-anchor" href="#&#x653E;&#x7F6E;&#x7EC4;&#x6743;&#x8861;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x653E;&#x7F6E;&#x7EC4;&#x6743;&#x8861;</h3>
<p>&#x6570;&#x636E;&#x6301;&#x4E45;&#x6027;&#x548C;&#x6240;&#x6709;<code>OSD</code>&#x4E4B;&#x95F4;&#x7684;&#x5747;&#x5300;&#x5206;&#x5E03;&#x9700;&#x8981;&#x66F4;&#x591A;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#xFF0C;&#x4F46;&#x662F;&#x5B83;&#x4EEC;&#x7684;&#x6570;&#x91CF;&#x5E94;&#x8BE5;&#x51CF;&#x5C11;&#x5230;&#x6700;&#x5C0F;&#x4EE5;&#x8282;&#x7701;<code>CPU</code>&#x548C;&#x5185;&#x5B58;&#x3002;</p>
<blockquote>
<p>&#x6570;&#x636E;&#x6301;&#x4E45;&#x6027;</p>
</blockquote>
<p>&#x5355;&#x4E2A;<code>OSD</code>&#x6545;&#x969C;&#x540E;&#xFF0C;&#x6570;&#x636E;&#x4E22;&#x5931;&#x7684;&#x98CE;&#x9669;&#x4F1A;&#x589E;&#x5927;&#xFF0C;&#x76F4;&#x5230;&#x5176;&#x4E2D;&#x5305;&#x542B;&#x7684;&#x6570;&#x636E;&#x88AB;&#x5B8C;&#x5168;&#x6062;&#x590D;&#x3002;&#x8BA9;&#x6211;&#x4EEC;&#x60F3;&#x8C61;&#x4E00;&#x4E2A;&#x573A;&#x666F;&#xFF0C;&#x5728;&#x5355;&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#x4E2D;&#x5BFC;&#x81F4;&#x6C38;&#x4E45;&#x7684;&#x6570;&#x636E;&#x4E22;&#x5931;:</p>
<ul>
<li><code>OSD</code>&#x6545;&#x969C;&#xFF08;&#x53EF;&#x770B;&#x4F5C;&#x78C1;&#x76D8;&#x6545;&#x969C;&#xFF09;&#xFF0C;&#x5305;&#x542B;&#x5BF9;&#x8C61;&#x7684;&#x6240;&#x6709;&#x526F;&#x672C;&#x4E22;&#x5931;&#x3002;&#x5BF9;&#x4E8E;&#x653E;&#x7F6E;&#x7EC4;&#x5185;&#x7684;&#x6240;&#x6709;&#x5BF9;&#x8C61;&#xFF0C;&#x526F;&#x672C;&#x7684;&#x6570;&#x91CF;&#x7A81;&#x7136;&#x4ECE;3&#x4E2A;&#x4E0B;&#x964D;&#x5230;2&#x4E2A;&#x3002;</li>
<li><code>Ceph</code>&#x901A;&#x8FC7;&#x9009;&#x62E9;&#x4E00;&#x4E2A;&#x65B0;&#x7684;<code>OSD</code>&#x6765;&#x91CD;&#x65B0;&#x521B;&#x5EFA;&#x6240;&#x6709;&#x5BF9;&#x8C61;&#x7684;&#x7B2C;&#x4E09;&#x4E2A;&#x526F;&#x672C;&#xFF0C;&#x4ECE;&#x800C;&#x5F00;&#x59CB;&#x6062;&#x590D;&#x6B64;&#x653E;&#x7F6E;&#x7EC4;&#x3002;</li>
<li>&#x540C;&#x4E00;&#x653E;&#x7F6E;&#x7EC4;&#x4E2D;&#x7684;&#x53E6;&#x4E00;&#x4E2A;<code>OSD</code>&#x5728;&#x65B0;<code>OSD</code>&#x5B8C;&#x5168;&#x586B;&#x5145;&#x7B2C;&#x4E09;&#x4E2A;&#x62F7;&#x8D1D;&#x4E4B;&#x524D;&#x5931;&#x8D25;&#x3002;&#x4E00;&#x4E9B;&#x5BF9;&#x8C61;&#x5C06;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5E78;&#x5B58;&#x7684;&#x526F;&#x672C;&#x3002;</li>
<li><code>Ceph</code>&#x4F1A;&#x9009;&#x62E9;&#x53E6;&#x4E00;&#x4E2A;<code>OSD</code>&#xFF0C;&#x5E76;&#x7EE7;&#x7EED;&#x590D;&#x5236;&#x5BF9;&#x8C61;&#xFF0C;&#x4EE5;&#x6062;&#x590D;&#x6240;&#x9700;&#x7684;&#x526F;&#x672C;&#x6570;&#x91CF;&#x3002;</li>
<li>&#x540C;&#x4E00;&#x653E;&#x7F6E;&#x7EC4;&#x4E2D;&#x7684;&#x7B2C;&#x4E09;&#x4E2A;<code>OSD</code>&#x5728;&#x6062;&#x590D;&#x5B8C;&#x6210;&#x4E4B;&#x524D;&#x5931;&#x8D25;&#x3002;&#x5982;&#x679C;&#x6B64;<code>OSD</code>&#x5305;&#x542B;&#x5BF9;&#x8C61;&#x7684;&#x552F;&#x4E00;&#x5269;&#x4F59;&#x526F;&#x672C;&#xFF0C;&#x5219;&#x5B83;&#x5C06;&#x6C38;&#x4E45;&#x4E22;&#x5931;&#x3002;  </li>
</ul>
<p>&#x5728;&#x4E00;&#x4E2A;&#x5305;&#x542B;10&#x4E2A;<code>OSD</code>&#x3001;&#x5728;3&#x4E2A;&#x590D;&#x5236;&#x6C60;&#x4E2D;&#x6709;512&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#x7684;&#x96C6;&#x7FA4;&#x4E2D;&#xFF0C;<code>CRUSH</code>&#x5C06;&#x7ED9;&#x6BCF;&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#x4E09;&#x4E2A;<code>OSD</code>&#x3002;
&#x6700;&#x7EC8;&#xFF0C;&#x6BCF;&#x4E2A;<code>OSD</code>&#x5C06;&#x6258;&#x7BA1;(512 * 3)/ 10 ~= 150&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#x3002;
&#x56E0;&#x6B64;&#xFF0C;&#x5F53;&#x7B2C;&#x4E00;&#x4E2A;<code>OSD</code>&#x5931;&#x8D25;&#x65F6;&#xFF0C;&#x4E0A;&#x8FF0;&#x573A;&#x666F;&#x5C06;&#x540C;&#x65F6;&#x542F;&#x52A8;&#x6240;&#x6709;150&#x4E2A;&#x5B89;&#x7F6E;&#x7EC4;&#x7684;&#x6062;&#x590D;&#x3002;</p>
<p>&#x6B63;&#x5728;&#x6062;&#x590D;&#x7684;150&#x4E2A;&#x5B89;&#x7F6E;&#x7EC4;&#x53EF;&#x80FD;&#x5747;&#x5300;&#x5730;&#x5206;&#x5E03;&#x5728;&#x5269;&#x4F59;&#x7684;9&#x4E2A;<code>OSDs</code>&#x4E0A;&#x3002;
&#x56E0;&#x6B64;&#xFF0C;&#x6BCF;&#x4E2A;&#x5269;&#x4F59;&#x7684;<code>OSD</code>&#x90FD;&#x53EF;&#x80FD;&#x5411;&#x5176;&#x4ED6;&#x6240;&#x6709;<code>OSD</code>&#x53D1;&#x9001;&#x5BF9;&#x8C61;&#x526F;&#x672C;&#xFF0C;&#x5E76;&#x63A5;&#x6536;&#x4E00;&#x4E9B;&#x65B0;&#x5BF9;&#x8C61;&#x6765;&#x5B58;&#x50A8;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x6210;&#x4E3A;&#x4E86;&#x65B0;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x7684;&#x4E00;&#x90E8;&#x5206;&#x3002;</p>
<p>&#x5B8C;&#x6210;&#x6B64;&#x6062;&#x590D;&#x6240;&#x9700;&#x7684;&#x65F6;&#x95F4;&#x5B8C;&#x5168;&#x53D6;&#x51B3;&#x4E8E;<code>Ceph</code>&#x96C6;&#x7FA4;&#x7684;&#x4F53;&#x7CFB;&#x7ED3;&#x6784;&#x3002;&#x5047;&#x8BBE;&#x6BCF;&#x4E2A;<code>OSD</code>&#x7531;&#x4E00;&#x53F0;&#x673A;&#x5668;&#x4E0A;&#x7684;1<code>TB</code> <code>SSD</code>&#x6258;&#x7BA1;&#xFF0C;
&#x6240;&#x6709;&#x8FD9;&#x4E9B;<code>OSD</code>&#x90FD;&#x8FDE;&#x63A5;&#x5230;<code>10Gb/s</code>&#x4EA4;&#x6362;&#x673A;&#xFF0C;&#x5355;&#x4E2A;<code>OSD</code>&#x7684;&#x6062;&#x590D;&#x5728;M&#x5206;&#x949F;&#x5185;&#x5B8C;&#x6210;&#x3002;
&#x5982;&#x679C;&#x6BCF;&#x53F0;&#x673A;&#x5668;&#x6709;&#x4E24;&#x4E2A;<code>OSD</code>&#x3001;&#x6CA1;&#x6709;<code>SSD</code>&#x3001;<code>1Gb/s</code>&#x4EA4;&#x6362;&#x673A;&#xFF0C;&#x5B83;&#x81F3;&#x5C11;&#x4F1A;&#x6162;&#x4E00;&#x4E2A;&#x6570;&#x91CF;&#x7EA7;&#x3002;</p>
<p>&#x5728;&#x8FD9;&#x79CD;&#x5927;&#x5C0F;&#x7684;&#x96C6;&#x7FA4;&#x4E2D;&#xFF0C;&#x653E;&#x7F6E;&#x7EC4;&#x7684;&#x6570;&#x91CF;&#x5BF9;&#x6570;&#x636E;&#x6301;f&#x4E45;&#x6027;&#x51E0;&#x4E4E;&#x6CA1;&#x6709;&#x5F71;&#x54CD;&#x3002;&#x5B83;&#x53EF;&#x80FD;&#x662F;128&#x6216;8192&#xFF0C;&#x6062;&#x590D;&#x4E0D;&#x4F1A;&#x6162;&#x6216;&#x5FEB;&#x3002;</p>
<p>&#x4F46;&#x662F;&#xFF0C;&#x5C06;&#x540C;&#x4E00;&#x4E2A;<code>Ceph</code>&#x96C6;&#x7FA4;&#x589E;&#x52A0;&#x5230;20&#x4E2A;<code>OSD</code>&#x800C;&#x4E0D;&#x662F;10&#x4E2A;<code>OSD</code>&#x53EF;&#x80FD;&#x4F1A;&#x52A0;&#x5FEB;&#x6062;&#x590D;&#x901F;&#x5EA6;&#xFF0C;&#x4ECE;&#x800C;&#x663E;&#x8457;&#x63D0;&#x9AD8;&#x6570;&#x636E;&#x6301;&#x4E45;&#x6027;&#x3002;
&#x6BCF;&#x4E2A;<code>OSD</code>&#x73B0;&#x5728;&#x53EA;&#x53C2;&#x4E0E;~75&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x5728;&#x53EA;&#x6709;10&#x4E2A;<code>OSD</code>&#x65F6;&#x53C2;&#x4E0E;~150&#x4E2A;&#xFF0C;&#x800C;&#x4E14;&#x4ECD;&#x7136;&#x9700;&#x8981;&#x5269;&#x4E0B;&#x7684;19&#x4E2A;<code>OSD</code>&#x6267;&#x884C;&#x76F8;&#x540C;&#x6570;&#x91CF;&#x7684;&#x5BF9;&#x8C61;&#x526F;&#x672C;&#x624D;&#x80FD;&#x6062;&#x590D;&#x3002;
&#x4F46;&#x662F;&#xFF0C;&#x4EE5;&#x524D;10&#x4E2A;<code>OSD</code>&#x6BCF;&#x4E2A;&#x5FC5;&#x987B;&#x590D;&#x5236;&#x5927;&#x7EA6;<code>100GB</code>&#xFF0C;&#x73B0;&#x5728;&#x5B83;&#x4EEC;&#x6BCF;&#x4E2A;&#x5FC5;&#x987B;&#x590D;&#x5236;<code>50GB</code>&#x3002;
&#x5982;&#x679C;&#x7F51;&#x7EDC;&#x662F;&#x74F6;&#x9888;&#xFF0C;&#x90A3;&#x4E48;&#x6062;&#x590D;&#x7684;&#x901F;&#x5EA6;&#x5C06;&#x662F;&#x73B0;&#x5728;&#x7684;&#x4E24;&#x500D;&#x3002;&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x5F53;<code>OSDs</code>&#x7684;&#x6570;&#x91CF;&#x589E;&#x52A0;&#x65F6;&#xFF0C;&#x6062;&#x590D;&#x901F;&#x5EA6;&#x4F1A;&#x66F4;&#x5FEB;&#x3002;</p>
<p>&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x96C6;&#x7FA4;&#x589E;&#x957F;&#x5230;40&#x4E2A;<code>OSD</code>&#xFF0C;&#x90A3;&#x4E48;&#x6BCF;&#x4E2A;<code>OSD</code>&#x53EA;&#x80FD;&#x627F;&#x8F7D;35&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#x3002;
&#x5982;&#x679C;<code>OSD</code>&#x6545;&#x969C;&#xFF0C;&#x9664;&#x975E;&#x5B83;&#x88AB;&#x53E6;&#x4E00;&#x4E2A;&#x74F6;&#x9888;&#x963B;&#x585E;&#xFF0C;&#x5426;&#x5219;&#x6062;&#x590D;&#x5C06;&#x7EE7;&#x7EED;&#x52A0;&#x5FEB;&#x3002;
&#x4F46;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x96C6;&#x7FA4;&#x589E;&#x957F;&#x5230;200&#x4E2A;<code>OSD</code>&#xFF0C;&#x6BCF;&#x4E2A;<code>OSD</code>&#x53EA;&#x80FD;&#x627F;&#x8F7D;~7&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#x3002;
&#x5982;&#x679C;&#x4E00;&#x4E2A;<code>OSD</code>&#x6545;&#x969C;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x8FD9;&#x4E9B;&#x653E;&#x7F6E;&#x7EC4;&#x4E2D;&#x6700;&#x591A;21&#x4E2A;<code>OSD</code>&#xFF08;7*3&#xFF09;&#x4E4B;&#x95F4;&#x4F1A;&#x53D1;&#x751F;&#x6062;&#x590D;&#xFF1A;&#x6062;&#x590D;&#x6240;&#x9700;&#x7684;&#x65F6;&#x95F4;&#x5C06;&#x6BD4;&#x6709;40&#x4E2A;<code>OSD</code>&#x65F6;&#x7684;&#x96C6;&#x7FA4;&#x957F;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x653E;&#x7F6E;&#x7EC4;&#x7684;&#x6570;&#x91CF;&#x5E94;&#x8BE5;&#x589E;&#x52A0;&#x3002;</p>
<p>&#x65E0;&#x8BBA;&#x6062;&#x590D;&#x65F6;&#x95F4;&#x6709;&#x591A;&#x77ED;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;<code>OSD</code>&#x90FD;&#x6709;&#x53EF;&#x80FD;&#x5728;&#x6062;&#x590D;&#x8FC7;&#x7A0B;&#x4E2D;&#x5931;&#x8D25;&#x3002;
&#x5728;&#x4E0A;&#x8FF0;10&#x4E2A;<code>osd</code>&#x96C6;&#x7FA4;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x5176;&#x4E2D;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x5931;&#x8D25;&#xFF0C;&#x90A3;&#x4E48;~17&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#xFF08;&#x5373;~150/9&#x4E2A;&#x6B63;&#x5728;&#x6062;&#x590D;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#xFF09;&#x5C06;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5E78;&#x5B58;&#x526F;&#x672C;&#x3002;
&#x5982;&#x679C;&#x5269;&#x4F59;&#x7684;8&#x4E2A;<code>OSD</code>&#x4E2D;&#x7684;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x5931;&#x8D25;&#xFF0C;&#x90A3;&#x4E48;&#x4E24;&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#x7684;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5F88;&#x53EF;&#x80FD;&#x4F1A;&#x4E22;&#x5931;&#xFF08;&#x5373;&#x5927;&#x7EA6;17/8&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#xFF0C;&#x53EA;&#x6062;&#x590D;&#x4E86;&#x5269;&#x4F59;&#x7684;&#x4E00;&#x4E2A;&#x526F;&#x672C;&#xFF09;&#x3002;</p>
<p>&#x5F53;&#x7FA4;&#x96C6;&#x7684;&#x5927;&#x5C0F;&#x589E;&#x52A0;&#x5230;20&#x4E2A;<code>osd</code>&#x65F6;&#xFF0C;&#x7531;&#x4E8E;&#x4E22;&#x5931;3&#x4E2A;<code>osd</code>&#x800C;&#x635F;&#x574F;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x7684;&#x6570;&#x91CF;&#x4F1A;&#x4E0B;&#x964D;&#x3002;
&#x4E22;&#x5931;&#x7684;&#x7B2C;&#x4E8C;&#x4E2A;<code>OSD</code>&#x5C06;&#x964D;&#x7EA7;~4&#xFF08;&#x5373;&#x6062;&#x590D;~75/19&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#xFF09;&#xFF0C;&#x800C;&#x4E0D;&#x662F;~17&#xFF0C;&#x5E76;&#x4E14;&#x4E22;&#x5931;&#x7684;&#x7B2C;&#x4E09;&#x4E2A;<code>OSD</code>&#x53EA;&#x6709;&#x5728;&#x5305;&#x542B;&#x5E78;&#x5B58;&#x526F;&#x672C;&#x7684;&#x56DB;&#x4E2A;<code>OSD</code>&#x4E4B;&#x4E00;&#x65F6;&#x624D;&#x4F1A;&#x4E22;&#x5931;&#x6570;&#x636E;&#x3002;
&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x6062;&#x590D;&#x65F6;&#x95F4;&#x8303;&#x56F4;&#x5185;&#x4E22;&#x5931;&#x4E00;&#x4E2A;<code>OSD</code>&#x7684;&#x6982;&#x7387;&#x4E3A;0.0001%&#xFF0C;&#x5219;&#x5728;&#x5177;&#x6709;10&#x4E2A;<code>OSD</code>&#x7684;&#x96C6;&#x7FA4;&#x4E2D;&#xFF0C;&#x4E22;&#x5931;&#x7684;&#x6982;&#x7387;&#x4ECE;17&#xD7;10&#xD7;0.0001%&#x53D8;&#x4E3A;&#x5177;&#x6709;20&#x4E2A;<code>OSD</code>&#x7684;&#x96C6;&#x7FA4;&#x4E2D;&#x7684;4&#xD7;20&#xD7;0.0001%</p>
<p><strong>&#x7B80;&#x800C;&#x8A00;&#x4E4B;&#xFF0C;&#x66F4;&#x591A;&#x7684;<code>osd</code>&#x610F;&#x5473;&#x7740;&#x66F4;&#x5FEB;&#x7684;&#x6062;&#x590D;&#x548C;&#x66F4;&#x4F4E;&#x7684;&#x5BFC;&#x81F4;&#x6C38;&#x4E45;&#x6027;&#x4E22;&#x5931;&#x653E;&#x7F6E;&#x7EC4;&#x7684;&#x7EA7;&#x8054;&#x6545;&#x969C;&#x98CE;&#x9669;&#x3002;&#x5C31;&#x6570;&#x636E;&#x6301;&#x4E45;&#x6027;&#x800C;&#x8A00;&#xFF0C;512&#x6216;4096&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#x5728;&#x5C11;&#x4E8E;50&#x4E2A;<code>osd</code>&#x7684;&#x96C6;&#x7FA4;&#x4E2D;&#x5927;&#x81F4;&#x76F8;&#x5F53;&#x3002;</strong></p>
<blockquote>
<p>&#x6C60;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#x5206;&#x5E03;</p>
</blockquote>
<p>&#x7406;&#x60F3;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5BF9;&#x8C61;&#x5747;&#x5300;&#x5206;&#x5E03;&#x5728;&#x6BCF;&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#x4E2D;&#x3002;&#x7531;&#x4E8E;<code>CRUSH</code>&#x8BA1;&#x7B97;&#x6BCF;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#xFF0C;
&#x4F46;&#x5B9E;&#x9645;&#x4E0A;&#x4E0D;&#x77E5;&#x9053;&#x8BE5;&#x653E;&#x7F6E;&#x7EC4;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;<code>OSD</code>&#x4E2D;&#x5B58;&#x50A8;&#x4E86;&#x591A;&#x5C11;&#x6570;&#x636E;&#xFF0C;&#x56E0;&#x6B64;&#x653E;&#x7F6E;&#x7EC4;&#x7684;&#x6570;&#x91CF;&#x4E0E;<code>OSD</code>&#x7684;&#x6570;&#x91CF;&#x4E4B;&#x95F4;&#x7684;&#x6BD4;&#x7387;&#x53EF;&#x80FD;&#x4F1A;&#x663E;&#x8457;&#x5F71;&#x54CD;&#x6570;&#x636E;&#x7684;&#x5206;&#x5E03;&#x3002;</p>
<p>&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x4E00;&#x4E2A;&#x4E09;&#x526F;&#x672C;&#x6C60;&#x4E2D;&#x6709;&#x5341;&#x4E2A;<code>OSD</code>&#x7684;&#x5355;&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#xFF0C;&#x90A3;&#x4E48;&#x53EA;&#x4F1A;&#x4F7F;&#x7528;&#x4E09;&#x4E2A;<code>OSD</code>&#xFF0C;&#x56E0;&#x4E3A;<code>CRUSH</code>&#x6CA1;&#x6709;&#x5176;&#x4ED6;&#x9009;&#x62E9;&#x3002;
&#x5F53;&#x6709;&#x66F4;&#x591A;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x53EF;&#x7528;&#x65F6;&#xFF0C;&#x5BF9;&#x8C61;&#x66F4;&#x53EF;&#x80FD;&#x5747;&#x5300;&#x5730;&#x5206;&#x5E03;&#x5728;&#x5176;&#x4E2D;&#x3002;<code>CRUSH</code>&#x8FD8;&#x5C3D;&#x4E00;&#x5207;&#x52AA;&#x529B;&#x5C06;<code>osd</code>&#x5747;&#x5300;&#x5730;&#x5206;&#x5E03;&#x5728;&#x6240;&#x6709;&#x73B0;&#x6709;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x4E2D;&#x3002;</p>
<p>&#x4E0D;&#x5747;&#x5300;&#x7684;&#x6570;&#x636E;&#x5206;&#x5E03;&#x53EF;&#x80FD;&#x662F;&#x7531;osd&#x548C;&#x653E;&#x7F6E;&#x7EC4;&#x4E4B;&#x95F4;&#x7684;&#x6BD4;&#x7387;&#x4EE5;&#x5916;&#x7684;&#x56E0;&#x7D20;&#x9020;&#x6210;&#x7684;&#x3002;
&#x7531;&#x4E8E;&#x6324;&#x538B;&#x4E0D;&#x8003;&#x8651;&#x5BF9;&#x8C61;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x4E00;&#x4E9B;&#x975E;&#x5E38;&#x5927;&#x7684;&#x5BF9;&#x8C61;&#x53EF;&#x80FD;&#x4F1A;&#x9020;&#x6210;&#x4E0D;&#x5E73;&#x8861;&#x3002;
&#x5047;&#x8BBE;100&#x4E07;&#x4E2A;4K&#x5BF9;&#x8C61;&#xFF08;&#x603B;&#x5171;4GB&#xFF09;&#x5747;&#x5300;&#x5206;&#x5E03;&#x5728;10&#x4E2A;<code>OSD</code>&#x4E0A;&#x7684;1024&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#x4E2D;&#x3002;&#x4ED6;&#x4EEC;&#x5C06;&#x5728;&#x6BCF;&#x4E2A;<code>OSD</code>&#x4E0A;&#x4F7F;&#x7528;<code>4GB/10=400MB</code>&#x3002;
&#x5982;&#x679C;&#x5C06;&#x4E00;&#x4E2A;<code>400MB</code>&#x5BF9;&#x8C61;&#x6DFB;&#x52A0;&#x5230;&#x6C60;&#x4E2D;&#xFF0C;&#x5219;&#x652F;&#x6301;&#x653E;&#x7F6E;&#x8BE5;&#x5BF9;&#x8C61;&#x7684;&#x653E;&#x7F6E;&#x7EC4;&#x7684;&#x4E09;&#x4E2A;<code>OSD</code>&#x5C06;&#x88AB;<code>400MB+400MB=800MB</code>&#x586B;&#x5145;&#xFF0C;&#x800C;&#x5176;&#x4ED6;&#x4E03;&#x4E2A;<code>OSD</code>&#x5C06;&#x4EC5;&#x88AB;<code>400MB</code>&#x5360;&#x7528;&#x3002;</p>
<blockquote>
<p>&#x5185;&#x5B58;&#x3001;CPU&#x548C;&#x7F51;&#x7EDC;&#x4F7F;&#x7528;&#x60C5;&#x51B5;</p>
</blockquote>
<p>&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x653E;&#x7F6E;&#x7EC4;&#xFF0C;<code>osd</code>&#x548C;<code>mon</code>&#x59CB;&#x7EC8;&#x9700;&#x8981;&#x5185;&#x5B58;&#x3001;&#x7F51;&#x7EDC;&#x548C;<code>CPU</code>&#xFF0C;&#x751A;&#x81F3;&#x5728;&#x6062;&#x590D;&#x671F;&#x95F4;&#x9700;&#x8981;&#x66F4;&#x591A;&#x3002;&#x901A;&#x8FC7;&#x5728;&#x653E;&#x7F6E;&#x7EC4;&#x4E2D;&#x805A;&#x96C6;&#x5BF9;&#x8C61;&#x6765;&#x5171;&#x4EAB;&#x6B64;&#x5F00;&#x9500;&#x662F;&#x5B83;&#x4EEC;&#x5B58;&#x5728;&#x7684;&#x4E3B;&#x8981;&#x539F;&#x56E0;&#x4E4B;&#x4E00;&#x3002;</p>
<p>&#x6700;&#x5C0F;&#x5316;&#x653E;&#x7F6E;&#x7EC4;&#x7684;&#x6570;&#x91CF;&#x53EF;&#x4EE5;&#x8282;&#x7701;&#x5927;&#x91CF;&#x8D44;&#x6E90;&#x3002;</p>
<h2 id="rbd&#x7BA1;&#x7406;"><a name="rbd&#x7BA1;&#x7406;" class="anchor-navigation-ex-anchor" href="#rbd&#x7BA1;&#x7406;"><i class="fa fa-link" aria-hidden="true"></i></a>rbd&#x7BA1;&#x7406;</h2>
<h3 id="&#x521B;&#x5EFA;"><a name="&#x521B;&#x5EFA;" class="anchor-navigation-ex-anchor" href="#&#x521B;&#x5EFA;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x521B;&#x5EFA;</h3>
<blockquote>
<p>&#x521B;&#x5EFA;&#x6C60;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd pool create rbd-demo-pool 64 64
pool &apos;rbd-demo-pool&apos; created
</code></pre><blockquote>
<p>&#x8BBE;&#x7F6E;&#x914D;&#x989D;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd pool set-quota rbd-demo-pool max_bytes 1G
set-quota max_bytes = 1073741824 for pool rbd-demo-pool
</code></pre><blockquote>
<p>&#x5173;&#x8054;<code>rbd</code>&#x5E94;&#x7528;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd pool application enable rbd-demo-pool rbd
enabled application &apos;rbd&apos; on pool &apos;rbd-demo-pool&apos;
</code></pre><blockquote>
<p>&#x521D;&#x59CB;&#x5316;</p>
</blockquote>
<pre class="language-"><code>rbd pool init rbd-demo-pool
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;rbd&#x7528;&#x6237;</p>
</blockquote>
<p>&#x8BED;&#x6CD5;&#x683C;&#x5F0F;</p>
<pre class="language-"><code>ceph auth get-or-create client.{ID} mon &apos;profile rbd&apos; osd &apos;profile {profile name} [pool={pool-name}][, profile ...]&apos; mgr &apos;profile rbd [pool={pool-name}]&apos;
</code></pre><p>&#x521B;&#x5EFA;ID&#x4E3A;<code>qemu</code>&#x3001;&#x5BF9;<code>rbd-demo-pool</code>&#x6C60;&#x6709;&#x8BFB;&#x5199;&#x6743;&#x9650;&#x7684;&#x7528;&#x6237;</p>
<pre class="language-"><code>ceph auth get-or-create client.qemu mon &apos;profile rbd&apos; osd &apos;profile rbd pool=rbd-demo-pool&apos; mgr &apos;profile rbd pool=rbd-demo-pool&apos; -o /etc/ceph/ceph.client.qemu.keyring
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;rbd&#x6620;&#x50CF;</p>
</blockquote>
<p>&#x5728;&#x5C06;&#x5757;&#x8BBE;&#x5907;&#x6DFB;&#x52A0;&#x5230;&#x8282;&#x70B9;&#x4E4B;&#x524D;&#xFF0C;&#x5FC5;&#x987B;&#x5148;&#x5728;<code>Ceph</code>&#x5B58;&#x50A8;&#x96C6;&#x7FA4;&#x4E2D;&#x4E3A;&#x5176;&#x521B;&#x5EFA;&#x6620;&#x50CF;&#x3002;&#x8981;&#x521B;&#x5EFA;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;&#xFF0C;&#x8BF7;&#x6267;&#x884C;&#x4EE5;&#x4E0B;&#x64CD;&#x4F5C;&#xFF1A;</p>
<pre class="language-"><code># rbd create --size {megabytes} {pool-name}/{image-name}
rbd create --size 1G rbd-demo-pool/rbd-demo-image
</code></pre><h3 id="&#x67E5;&#x770B;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;"><a name="&#x67E5;&#x770B;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;" class="anchor-navigation-ex-anchor" href="#&#x67E5;&#x770B;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x67E5;&#x770B;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;</h3>
<blockquote>
<p>&#x67E5;&#x770B;&#x6C60;&#x5185;&#x6620;&#x50CF;</p>
</blockquote>
<pre class="language-"><code># rbd ls {poolname}
[root@ceph01 ~]# rbd ls rbd-demo-pool
rbd-demo-image
</code></pre><blockquote>
<p>&#x67E5;&#x770B;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;&#x4FE1;&#x606F;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# rbd info rbd-demo-pool/rbd-demo-image
rbd image &apos;rbd-demo-image&apos;:
        size 1 GiB in 256 objects
        order 22 (4 MiB objects)
        snapshot_count: 0
        id: d3ef49824934
        block_name_prefix: rbd_data.d3ef49824934
        format: 2
        features: layering, exclusive-lock, object-map, fast-diff, deep-flatten
        op_features:
        flags:
        create_timestamp: Mon Mar  1 15:48:05 2021
        access_timestamp: Mon Mar  1 15:48:05 2021
        modify_timestamp: Mon Mar  1 15:48:05 2021
</code></pre><h3 id="&#x8C03;&#x6574;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;&#x7684;&#x5927;&#x5C0F;"><a name="&#x8C03;&#x6574;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;&#x7684;&#x5927;&#x5C0F;" class="anchor-navigation-ex-anchor" href="#&#x8C03;&#x6574;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;&#x7684;&#x5927;&#x5C0F;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x8C03;&#x6574;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;&#x7684;&#x5927;&#x5C0F;</h3>
<h4 id="&#x7F29;&#x5BB9;"><a name="&#x7F29;&#x5BB9;" class="anchor-navigation-ex-anchor" href="#&#x7F29;&#x5BB9;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x7F29;&#x5BB9;</h4>
<blockquote>
<p>&#x6536;&#x7F29;&#x5927;&#x5C0F;&#x4E3A;<code>256M</code></p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# rbd resize --size 256M rbd-demo-pool/rbd-demo-image --allow-shrink
Resizing image: 100% complete...done.
</code></pre><blockquote>
<p>&#x67E5;&#x770B;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;&#x4FE1;&#x606F;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# rbd info rbd-demo-pool/rbd-demo-image
rbd image &apos;rbd-demo-image&apos;:
        size 256 MiB in 64 objects
        order 22 (4 MiB objects)
        snapshot_count: 0
        id: d3ef49824934
        block_name_prefix: rbd_data.d3ef49824934
        format: 2
        features: layering, exclusive-lock, object-map, fast-diff, deep-flatten
        op_features:
        flags:
        create_timestamp: Mon Mar  1 15:48:05 2021
        access_timestamp: Mon Mar  1 15:48:05 2021
        modify_timestamp: Mon Mar  1 15:48:05 2021
</code></pre><h4 id="&#x6269;&#x5BB9;"><a name="&#x6269;&#x5BB9;" class="anchor-navigation-ex-anchor" href="#&#x6269;&#x5BB9;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6269;&#x5BB9;</h4>
<p><strong>&#x6269;&#x5BB9;&#x5927;&#x5C0F;&#x4E0A;&#x9650;&#x4E3A;&#x6C60;&#x914D;&#x989D;&#x5927;&#x5C0F;</strong></p>
<blockquote>
<p>&#x6269;&#x5BB9;&#x5927;&#x5C0F;&#x81F3;<code>1G</code></p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# rbd resize --size 1G rbd-demo-pool/rbd-demo-image --allow-shrink
Resizing image: 100% complete...done.
</code></pre><blockquote>
<p>&#x67E5;&#x770B;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;&#x4FE1;&#x606F;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# rbd info rbd-demo-pool/rbd-demo-image
rbd image &apos;rbd-demo-image&apos;:
        size 1 GiB in 256 objects
        order 22 (4 MiB objects)
        snapshot_count: 0
        id: d3ef49824934
        block_name_prefix: rbd_data.d3ef49824934
        format: 2
        features: layering, exclusive-lock, object-map, fast-diff, deep-flatten
        op_features:
        flags:
        create_timestamp: Mon Mar  1 15:48:05 2021
        access_timestamp: Mon Mar  1 15:48:05 2021
        modify_timestamp: Mon Mar  1 15:48:05 2021
</code></pre><h3 id="&#x5220;&#x9664;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;"><a name="&#x5220;&#x9664;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;" class="anchor-navigation-ex-anchor" href="#&#x5220;&#x9664;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5220;&#x9664;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x50CF;</h3>
<pre class="language-"><code># rbd rm {pool-name}/{image-name}
[root@ceph01 ~]# rbd rm rbd-demo-pool/rbd-demo-image
Removing image: 100% complete...done.
</code></pre><h3 id="&#x6302;&#x8F7D;&#x5757;&#x8BBE;&#x5907;"><a name="&#x6302;&#x8F7D;&#x5757;&#x8BBE;&#x5907;" class="anchor-navigation-ex-anchor" href="#&#x6302;&#x8F7D;&#x5757;&#x8BBE;&#x5907;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6302;&#x8F7D;&#x5757;&#x8BBE;&#x5907;</h3>
<blockquote>
<p>&#x5220;&#x9664;&#x539F;&#x6709;yum&#x6E90;repo&#x6587;&#x4EF6;</p>
</blockquote>
<pre class="language-"><code>rm -f /etc/yum.repos.d/*.repo
</code></pre><blockquote>
<p>&#x521B;&#x5EFA;yum&#x6E90;&#x6587;&#x4EF6;&#xFF08;&#x5BA2;&#x6237;&#x7AEF;&#xFF09;</p>
</blockquote>
<p><strong>online</strong></p>
<pre class="language-"><code>curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo
curl -o /etc/yum.repos.d/epel-7.repo http://mirrors.aliyun.com/repo/epel-7.repo
</code></pre><p><strong>offline</strong></p>
<p>&#x4E0B;&#x8F7D;&#x4EE5;&#x4E0B;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x81F3;<code>/etc/yum.repos.d/</code></p>
<ul>
<li><a href="http://mirrors.aliyun.com/repo/Centos-7.repo" target="_blank">Centos-7.repo</a></li>
<li><a href="http://mirrors.aliyun.com/repo/epel-7.repo" target="_blank">epel-7.repo</a></li>
</ul>
<blockquote>
<p>&#x914D;&#x7F6E;<code>ceph</code>&#x955C;&#x50CF;&#x6E90;&#x4ED3;&#x5E93;</p>
</blockquote>
<pre class="language-"><code>cat &gt; /etc/yum.repos.d/ceph.repo &lt;&lt;EOF
[Ceph]
name=Ceph \$basearch
baseurl=https://mirrors.aliyun.com/ceph/rpm-nautilus/el7/\$basearch
enabled=1
gpgcheck=1
gpgkey=https://mirrors.aliyun.com/ceph/keys/release.asc

[Ceph-noarch]
name=Ceph noarch
baseurl=https://mirrors.aliyun.com/ceph/rpm-nautilus/el7/noarch
enabled=1
gpgcheck=1
gpgkey=https://mirrors.aliyun.com/ceph/keys/release.asc

[Ceph-source]
name=Ceph SRPMS
baseurl=https://mirrors.aliyun.com/ceph/rpm-nautilus/el7/SRPMS
enabled=1
gpgcheck=1
gpgkey=https://mirrors.aliyun.com/ceph/keys/release.asc
EOF
</code></pre><blockquote>
<p>&#x914D;&#x7F6E;<code>yum</code>&#x4EE3;&#x7406;</p>
</blockquote>
<p><strong>&#x9002;&#x7528;&#x4E8E;&#x4E3B;&#x673A;&#x901A;&#x8FC7;&#x4EE3;&#x7406;&#x8BBF;&#x95EE;&#x4E92;&#x8054;&#x7F51;&#x573A;&#x666F;</strong></p>
<p>&#x4EE5;&#x4E0B;&#x53D8;&#x91CF;&#x6CE8;&#x610F;&#x66FF;&#x6362;</p>
<ul>
<li>username: &#x4EE3;&#x7406;&#x7528;&#x6237;&#x540D;</li>
<li>password: &#x4EE3;&#x7406;&#x7528;&#x6237;&#x5BC6;&#x7801;</li>
<li>proxy_host: &#x4EE3;&#x7406;IP&#x5730;&#x5740;</li>
<li>proxy_port: &#x4EE3;&#x7406;&#x7AEF;&#x53E3;</li>
</ul>
<pre class="language-"><code>echo &quot;proxy=http://username:password@proxy_host:proxy_port&quot; &gt;&gt; /etc/yum.conf
</code></pre><blockquote>
<p>&#x5B89;&#x88C5;<code>ceph-common</code></p>
</blockquote>
<pre class="language-"><code>yum install -y ceph-common
</code></pre><blockquote>
<p>&#x62F7;&#x8D1D;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</p>
</blockquote>
<pre class="language-"><code>mkdir -p /etc/ceph
</code></pre><p>&#x5BA2;&#x6237;&#x7AEF;&#x521B;&#x5EFA;&#x6302;&#x8F7D;&#x76EE;&#x5F55;</p>
<pre class="language-"><code>mkdir -p /ceph
chmod 777 /ceph
</code></pre><p>&#x4ECE;&#x670D;&#x52A1;&#x7AEF;<code>scp</code>&#x4EE5;&#x4E0B;&#x6587;&#x4EF6;&#x81F3;&#x5BA2;&#x6237;&#x7AEF;<code>/etc/ceph</code>&#x4E0B;</p>
<ul>
<li><code>/etc/ceph/ceph.client.qemu.keyring</code></li>
<li><code>/etc/ceph/ceph.conf</code></li>
</ul>
<pre class="language-"><code>scp /etc/ceph/{ceph.conf,ceph.client.admin.keyring} ip:/etc/ceph/
</code></pre><blockquote>
<p>&#x6620;&#x5C04;&#x5757;&#x8BBE;&#x5907;</p>
</blockquote>
<pre class="language-"><code>[root@localhost ~]# rbd map rbd-demo-pool/rbd-demo-image --name client.qemu
/dev/rbd0
[root@localhost ~]# echo &quot;rbd-demo-pool/rbd-demo-image id=qemu,keyring=/etc/ceph/ceph.client.qemu.keyring&quot; &gt;&gt; /etc/ceph/rbdmap
</code></pre><blockquote>
<p>&#x683C;&#x5F0F;&#x5316;&#x5757;&#x8BBE;&#x5907;</p>
</blockquote>
<pre class="language-"><code> mkfs.ext4 -q /dev/rbd0
</code></pre><blockquote>
<p>&#x6302;&#x8F7D;&#x4F7F;&#x7528;</p>
</blockquote>
<pre class="language-"><code>mount /dev/rbd0 /ceph
</code></pre><blockquote>
<p>&#x67E5;&#x770B;&#x6302;&#x8F7D;</p>
</blockquote>
<pre class="language-"><code>lsblk
</code></pre><blockquote>
<p>&#x67E5;&#x770B;&#x5757;&#x8BBE;&#x5907;&#x6620;&#x5C04;</p>
</blockquote>
<pre class="language-"><code>[root@localhost ~]# rbd device list
id pool          namespace image          snap device
0  rbd-demo-pool           rbd-demo-image -    /dev/rbd0
</code></pre><blockquote>
<p>&#x4FEE;&#x6539;<code>fstab</code>&#xFF0C;&#x8BBE;&#x7F6E;&#x5F00;&#x673A;&#x6302;&#x8F7D;</p>
</blockquote>
<pre class="language-"><code>echo &quot;/dev/rbd0 /ceph ext4 defaults,noatime,_netdev 0 0&quot; &gt;&gt; /etc/fstab
</code></pre><blockquote>
<p>&#x914D;&#x7F6E;&#x5F00;&#x673A;&#x81EA;&#x542F;&#x52A8;</p>
</blockquote>
<pre class="language-"><code>vim /etc/init.d/rbdmap

#!/bin/bash
#chkconfig: 2345 80 60
#description: start/stop rbdmap
### BEGIN INIT INFO
# Provides:          rbdmap
# Required-Start:    $network
# Required-Stop:     $network
# Default-Start:     2 3 4 5
# Default-Stop:      0 1 6
# Short-Description: Ceph RBD Mapping
# Description:       Ceph RBD Mapping
### END INIT INFO

DESC=&quot;RBD Mapping&quot;
RBDMAPFILE=&quot;/etc/ceph/rbdmap&quot;

. /lib/lsb/init-functions
#. /etc/redhat-lsb/lsb_log_message&#xFF0C;&#x52A0;&#x5165;&#x6B64;&#x884C;&#x540E;&#x4E0D;&#x6B63;&#x957F;
do_map() {
    if [ ! -f &quot;$RBDMAPFILE&quot; ]; then
        echo &quot;$DESC : No $RBDMAPFILE found.&quot;
        exit 0
    fi

    echo &quot;Starting $DESC&quot;
    # Read /etc/rbdtab to create non-existant mapping
    newrbd=
    RET=0
    while read DEV PARAMS; do
        case &quot;$DEV&quot; in
          &quot;&quot;|\#*)
            continue
            ;;
          */*)
            ;;
          *)
            DEV=rbd/$DEV
            ;;
        esac
        OIFS=$IFS
        IFS=&apos;,&apos;
        for PARAM in ${PARAMS[@]}; do
            CMDPARAMS=&quot;$CMDPARAMS --$(echo $PARAM | tr &apos;=&apos; &apos; &apos;)&quot;
        done
        IFS=$OIFS
        if [ ! -b /dev/rbd/$DEV ]; then
            echo $DEV
            rbd map $DEV $CMDPARAMS
            [ $? -ne &quot;0&quot; ] &amp;&amp; RET=1
            newrbd=&quot;yes&quot;
        fi
    done &lt; $RBDMAPFILE
    echo $RET

    # Mount new rbd
    if [ &quot;$newrbd&quot; ]; then
                echo &quot;Mounting all filesystems&quot;
        mount -a
        echo $?
    fi
}

do_unmap() {
    echo &quot;Stopping $DESC&quot;
    RET=0
    # Unmap all rbd device
    for DEV in /dev/rbd[0-9]*; do
        echo $DEV
        # Umount before unmap
        MNTDEP=$(findmnt --mtab --source $DEV --output TARGET | sed 1,1d | sort -r)
        for MNT in $MNTDEP; do
            umount $MNT || sleep 1 &amp;&amp; umount -l $DEV
        done
        rbd unmap $DEV
        [ $? -ne &quot;0&quot; ] &amp;&amp; RET=1
    done
    echo $RET
}


case &quot;$1&quot; in
  start)
    do_map
    ;;

  stop)
    do_unmap
    ;;

  reload)
    do_map
    ;;

  status)
    rbd showmapped
    ;;

  *)
    echo &quot;Usage: rbdmap {start|stop|reload|status}&quot;
    exit 1
    ;;
esac

exit 0
</code></pre><p>&#x8D4B;&#x6743;</p>
<pre class="language-"><code>yum install redhat-lsb -y
chmod +x /etc/init.d/rbdmap
service rbdmap start 
chkconfig rbdmap on
</code></pre><h2 id="&#x5378;&#x8F7D;"><a name="&#x5378;&#x8F7D;" class="anchor-navigation-ex-anchor" href="#&#x5378;&#x8F7D;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5378;&#x8F7D;</h2>
<h3 id="&#x5220;&#x9664;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;"><a name="&#x5220;&#x9664;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;" class="anchor-navigation-ex-anchor" href="#&#x5220;&#x9664;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5220;&#x9664;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</h3>
<blockquote>
<p>&#x5220;&#x9664;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</p>
</blockquote>
<p>&#x67E5;&#x770B;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</p>
<pre class="language-"><code>[root@ceph01 ~]# ceph fs ls
name: k8s-cephfs, metadata pool: cephfs_metadata, data pools: [cephfs_data ]
</code></pre><p>&#x5220;&#x9664;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</p>
<pre class="language-"><code>[root@ceph01 ~]# ceph fs fail k8s-cephfs
k8s-cephfs marked not joinable; MDS cannot join the cluster. All MDS ranks marked failed.
[root@ceph01 ~]#     ceph fs rm k8s-cephfs --yes-i-really-mean-it
</code></pre><h3 id="&#x5220;&#x9664;&#x6C60;_1"><a name="&#x5220;&#x9664;&#x6C60;_1" class="anchor-navigation-ex-anchor" href="#&#x5220;&#x9664;&#x6C60;_1"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5220;&#x9664;&#x6C60;</h3>
<blockquote>
<p>&#x67E5;&#x770B;&#x6C60;</p>
</blockquote>
<pre class="language-"><code>[root@ceph01 ~]# ceph osd pool ls
ssd-demo-pool
nvme-demo-pool
rbd-demo-pool
rbd-k8s-pool
cephfs_data
cephfs_metadata
</code></pre><blockquote>
<p>&#x5220;&#x9664;&#x6C60;</p>
</blockquote>
<pre class="language-"><code>ceph osd pool delete ssd-demo-pool ssd-demo-pool --yes-i-really-really-mean-it
ceph osd pool delete nvme-demo-pool nvme-demo-pool --yes-i-really-really-mean-it
ceph osd pool delete rbd-demo-pool rbd-demo-pool --yes-i-really-really-mean-it
ceph osd pool delete rbd-k8s-pool rbd-k8s-pool --yes-i-really-really-mean-it
ceph osd pool delete cephfs_data cephfs_data --yes-i-really-really-mean-it
ceph osd pool delete cephfs_metadata cephfs_metadata --yes-i-really-really-mean-it
</code></pre><h3 id="&#x5220;&#x9664;osd"><a name="&#x5220;&#x9664;osd" class="anchor-navigation-ex-anchor" href="#&#x5220;&#x9664;osd"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5220;&#x9664;OSD</h3>
<blockquote>
<p><code>ceph</code>&#x7BA1;&#x7406;&#x8282;&#x70B9;&#x6267;&#x884C;</p>
</blockquote>
<pre class="language-"><code>#!/bin/bash
osd_list=`ceph osd ls`
for var in $osd_list;
do
    ceph osd crush rm osd.$var
    ceph auth del osd.$var
done

ceph osd down all
ceph osd out all
ceph osd rm all
</code></pre><blockquote>
<p>&#x6240;&#x6709;<code>ceph osd</code>&#x8282;&#x70B9;&#x6267;&#x884C;</p>
</blockquote>
<pre class="language-"><code>for i in `ls /var/lib/ceph/osd/`;
do
    umount /var/lib/ceph/osd/$i
done
</code></pre><p>&#x5BF9;&#x4E8E;<code>umount: /var/lib/ceph/osd/ceph-*&#xFF1A;&#x76EE;&#x6807;&#x5FD9;&#x3002;</code>&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x6267;&#x884C;&#x4EE5;&#x4E0B;&#x64CD;&#x4F5C;</p>
<pre class="language-"><code>[root@node2 ~]# fuser -mv  /var/lib/ceph/osd/ceph-1
                     &#x7528;&#x6237;     &#x8FDB;&#x7A0B;&#x53F7; &#x6743;&#x9650;   &#x547D;&#x4EE4;
/var/lib/ceph/osd/ceph-1:
                     root     kernel mount /var/lib/ceph/osd/ceph-1
                     ceph       5979 F.... ceph-osd
[root@node2 ~]# kill -9 5979

[root@node2 ~]# fuser -mv  /var/lib/ceph/osd/ceph-1
                     &#x7528;&#x6237;     &#x8FDB;&#x7A0B;&#x53F7; &#x6743;&#x9650;   &#x547D;&#x4EE4;
/var/lib/ceph/osd/ceph-1:
                     root     kernel mount /var/lib/ceph/osd/ceph-1

[root@node2 ~]# umount /var/lib/ceph/osd/ceph-1
</code></pre><p>&#x624B;&#x52A8;&#x64E6;&#x9664;&#x76D8;&#x4E0A;&#x6570;&#x636E;(&#x6240;&#x6709;&#x6570;&#x636E;&#x8282;&#x70B9;)</p>
<pre class="language-"><code># &#x4ECE;DM&#x4E2D;&#x79FB;&#x9664;&#x786C;&#x76D8;&#x5BF9;&#x5E94;&#x7684;&#x7F16;&#x7801;
dmsetup remove_all
# &#x683C;&#x5F0F;&#x5316;&#x5206;&#x533A;
yum install gdisk -y
sgdisk -z /dev/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>?</span><span class="token punctuation">&gt;</span></span>
</code></pre><p><code>ceph</code>&#x7BA1;&#x7406;&#x8282;&#x70B9;&#x6267;&#x884C;</p>
<pre class="language-"><code>ceph-deploy disk zap <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>node-hostname</span><span class="token punctuation">&gt;</span></span> /dev/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>?</span><span class="token punctuation">&gt;</span></span>
</code></pre><h3 id="&#x5378;&#x8F7D;&#x7EC4;&#x4EF6;&#x5E76;&#x6E05;&#x7A7A;&#x76EE;&#x5F55;"><a name="&#x5378;&#x8F7D;&#x7EC4;&#x4EF6;&#x5E76;&#x6E05;&#x7A7A;&#x76EE;&#x5F55;" class="anchor-navigation-ex-anchor" href="#&#x5378;&#x8F7D;&#x7EC4;&#x4EF6;&#x5E76;&#x6E05;&#x7A7A;&#x76EE;&#x5F55;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5378;&#x8F7D;&#x7EC4;&#x4EF6;&#x5E76;&#x6E05;&#x7A7A;&#x76EE;&#x5F55;</h3>
<pre class="language-"><code>ceph-deploy purge ceph01 ceph02 ceph03

ceph-deploy purgedata ceph01 ceph02 ceph03

ceph-deploy forgetkeys
</code></pre><h2 id="&#x53C2;&#x8003;&#x6587;&#x732E;"><a name="&#x53C2;&#x8003;&#x6587;&#x732E;" class="anchor-navigation-ex-anchor" href="#&#x53C2;&#x8003;&#x6587;&#x732E;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x53C2;&#x8003;&#x6587;&#x732E;</h2>
<ul>
<li><a href="https://www.cnblogs.com/cainiao-chuanqi/p/12204944.html" target="_blank">SAN&#x548C;NAS&#x4E4B;&#x95F4;&#x7684;&#x57FA;&#x672C;&#x533A;&#x522B;</a></li>
<li><a href="https://github.com/ceph/ceph-csi" target="_blank">ceph-csi</a></li>
</ul>
<footer class="page-footer"><span class="copyright">Copyright &#xA9; ren_jw 2021 all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">&#x672C;&#x4E66;&#x53D1;&#x5E03;&#x65F6;&#x95F4;&#xFF1A;
2021-08-20 23:01:55
</span></footer>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
                <a href="../raid/" class="navigation navigation-next navigation-unique" aria-label="Next page: raid">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"ceph","level":"1.2.3.1","depth":3,"next":{"title":"raid","level":"1.2.3.2","depth":3,"path":"1.Linux基础/存储/raid/README.md","ref":"1.Linux基础/存储/raid/README.md","articles":[]},"previous":{"title":"存储","level":"1.2.3","depth":2,"ref":"","articles":[{"title":"ceph","level":"1.2.3.1","depth":3,"path":"1.Linux基础/存储/ceph/README.md","ref":"1.Linux基础/存储/ceph/README.md","articles":[]},{"title":"raid","level":"1.2.3.2","depth":3,"path":"1.Linux基础/存储/raid/README.md","ref":"1.Linux基础/存储/raid/README.md","articles":[]},{"title":"fastdfs","level":"1.2.3.3","depth":3,"path":"1.Linux基础/存储/fastdfs.md","ref":"1.Linux基础/存储/fastdfs.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["code","back-to-top-button","-search","-lunr","search-pro","github","splitter","expandable-chapters","tbfed-pagefooter","-sharing","expandable-chapters","chapter-fold","theme-comscore","sharing-plus","prism","emphasize","advanced-emoji","-highlight","styles-less","multipart","ancre-navigation"],"ignores":["_book","node_modules","style","docs"],"root":".","styles":{"website":"styles/website.css","ebook":"styles/ebook.css","pdf":"styles/pdf.css","mobi":"styles/mobi.css","epub":"styles/epub.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"Copyright © ren_jw 2021","modify_label":"本书发布时间：","modify_format":"YYYY-MM-DD HH:mm:ss"},"chapter-fold":{},"prism":{"css":["prismjs/themes/prism-solarizedlight.css"],"lang":{"flow":"typescript"}},"emphasize":{},"github":{"url":"https://github.com/lijiam"},"styles-less":{},"splitter":{},"search-pro":{},"sharing-plus":{"qq":false,"all":["facebook","google","twitter","instapaper","linkedin","pocket","stumbleupon"],"douban":false,"facebook":true,"weibo":false,"instapaper":false,"whatsapp":false,"hatenaBookmark":false,"twitter":true,"messenger":false,"line":false,"vk":false,"pocket":true,"google":false,"viber":false,"stumbleupon":false,"qzone":false,"linkedin":false},"multipart":{},"code":{"copyButtons":true},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-comscore":{},"back-to-top-button":{},"ancre-navigation":{"associatedWithSummary":true,"float":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showLevel":true},"advanced-emoji":{"embedEmojis":false},"sharing":{"facebook":true,"twitter":true,"weibo":true,"qq":true,"all":["douban","google","qzone","linkedin"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"expandable-chapters":{}},"theme":"default","author":"wei liang","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"page-toc-button":{"maxTocDepth":2,"minTocSize":2},"variables":{},"title":"工作笔记","language":"zh-hans","output.name":"site","gitbook":"3.2.3","description":""},"file":{"path":"1.Linux基础/存储/ceph/README.md","mtime":"2021-08-20T15:01:55.957Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-08-20T15:49:45.406Z"},"basePath":"../../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../../gitbook/gitbook.js"></script>
    <script src="../../../gitbook/theme.js"></script>
    
        
        <script src="../../../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-chapter-fold/chapter-fold.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-sharing-plus/buttons.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-theme-comscore/test.js"></script>
        
    

    </body>
</html>

